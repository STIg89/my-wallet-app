import{g as Jn,c as cr,b as se,d as w_,w as Gl,e as Wl,f as Ac,h as fo,i as E_,a as Jl,I as _i,A as x_,U as I_,j as Q,k as S_,l as ac,m as P_,_ as O_,P as A_,V as zh,n as C_,D as T_,C as R_,Z as Uh,$ as $_,o as N_,p as co,q as D_,s as Yl,u as Dr,y as F_,v as j_,X as an,x as Dt,z as er,B as vi,E as ar,F as L_,G as cn,H as Xl,J as M_,K as q_,L as z_,M as Zl,N as U_,O as Ql,Y as ef,Q as hn,R as cc,S as so,T as ln,W as B_,a0 as oo,a1 as H_,a2 as k_,a3 as V_,a4 as K_,a5 as G_,a6 as Va,a7 as Bh,a8 as W_,a9 as J_,aa as Y_,ab as Hh,ac as X_,ad as Z_,ae as Q_,af as e1,ag as t1,ah as r1,ai as i1,aj as ao,ak as tf,al as Ka,am as n1,an as s1}from"./index-038e7f6c.js";import{e as Or,N as Cc}from"./events-ae390d1f.js";var po={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var uc=function(a,r){return uc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])},uc(a,r)};function o1(a,r){uc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var hc=function(){return hc=Object.assign||function(r){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},hc.apply(this,arguments)};function a1(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(t[n[o]]=a[n[o]]);return t}function c1(a,r,t,n){var o=arguments.length,c=o<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(o<3?l(c):o>3?l(r,t,c):l(r,t))||c);return o>3&&c&&Object.defineProperty(r,t,c),c}function u1(a,r){return function(t,n){r(t,n,a)}}function h1(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function l1(a,r,t,n){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(q){l(q)}}function b(O){try{y(n.throw(O))}catch(q){l(q)}}function y(O){O.done?c(O.value):o(O.value).then(p,b)}y((n=n.apply(a,r||[])).next())})}function f1(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return b([y,O])}}function b(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(c=y[0]&2?o.return:y[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,y[1])).done)return c;switch(o=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,o=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],o=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function p1(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function d1(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function lc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function rf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),o,c=[],l;try{for(;(r===void 0||r-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(p){l={error:p}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function g1(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(rf(arguments[r]));return a}function y1(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),o=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,o++)n[o]=c[l];return n}function kn(a){return this instanceof kn?(this.v=a,this):new kn(a)}function v1(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(C){n[C]&&(o[C]=function(z){return new Promise(function(F,K){c.push([C,z,F,K])>1||p(C,z)})})}function p(C,z){try{b(n[C](z))}catch(F){q(c[0][3],F)}}function b(C){C.value instanceof kn?Promise.resolve(C.value.v).then(y,O):q(c[0][2],C)}function y(C){p("next",C)}function O(C){p("throw",C)}function q(C,z){C(z),c.shift(),c.length&&p(c[0][0],c[0][1])}}function _1(a){var r,t;return r={},n("next"),n("throw",function(o){throw o}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(o,c){r[o]=a[o]?function(l){return(t=!t)?{value:kn(a[o](l)),done:o==="return"}:c?c(l):l}:c}}function m1(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof lc=="function"?lc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,b){l=a[c](l),o(p,b,l.done,l.value)})}}function o(c,l,p,b){Promise.resolve(b).then(function(y){c({value:y,done:p})},l)}}function b1(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function w1(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function E1(a){return a&&a.__esModule?a:{default:a}}function x1(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function I1(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const S1=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return hc},__asyncDelegator:_1,__asyncGenerator:v1,__asyncValues:m1,__await:kn,__awaiter:l1,__classPrivateFieldGet:x1,__classPrivateFieldSet:I1,__createBinding:p1,__decorate:c1,__exportStar:d1,__extends:o1,__generator:f1,__importDefault:E1,__importStar:w1,__makeTemplateObject:b1,__metadata:h1,__param:u1,__read:rf,__rest:a1,__spread:g1,__spreadArrays:y1,__values:lc},Symbol.toStringTag,{value:"Module"})),nf=Jn(S1);var Yn={};Object.defineProperty(Yn,"__esModule",{value:!0});function P1(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return JSON.parse(a)}catch{return a}}Yn.safeJsonParse=P1;function O1(a){return typeof a=="string"?a:JSON.stringify(a,(r,t)=>typeof t>"u"?null:t)}Yn.safeJsonStringify=O1;var $n={exports:{}},kh;function A1(){return kh||(kh=1,function(){let a;function r(){}a=r,a.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},a.prototype.setItem=function(t,n){this[t]=String(n)},a.prototype.removeItem=function(t){delete this[t]},a.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},a.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof cr<"u"&&cr.localStorage?$n.exports=cr.localStorage:typeof window<"u"&&window.localStorage?$n.exports=window.localStorage:$n.exports=new r}()),$n.exports}var Ga={},Nn={},Vh;function C1(){if(Vh)return Nn;Vh=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.IKeyValueStorage=void 0;class a{}return Nn.IKeyValueStorage=a,Nn}var Dn={},Kh;function T1(){if(Kh)return Dn;Kh=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.parseEntry=void 0;const a=Yn;function r(t){var n;return[t[0],a.safeJsonParse((n=t[1])!==null&&n!==void 0?n:"")]}return Dn.parseEntry=r,Dn}var Gh;function R1(){return Gh||(Gh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=nf;r.__exportStar(C1(),a),r.__exportStar(T1(),a)}(Ga)),Ga}Object.defineProperty(po,"__esModule",{value:!0});po.KeyValueStorage=void 0;const un=nf,Wh=Yn,$1=un.__importDefault(A1()),N1=R1();class sf{constructor(){this.localStorage=$1.default}getKeys(){return un.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return un.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(N1.parseEntry)})}getItem(r){return un.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(r);if(t!==null)return Wh.safeJsonParse(t)})}setItem(r,t){return un.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(r,Wh.safeJsonStringify(t))})}removeItem(r){return un.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(r)})}}po.KeyValueStorage=sf;var D1=po.default=sf,fn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var fc=function(a,r){return fc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])},fc(a,r)};function F1(a,r){fc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var pc=function(){return pc=Object.assign||function(r){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},pc.apply(this,arguments)};function j1(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(t[n[o]]=a[n[o]]);return t}function L1(a,r,t,n){var o=arguments.length,c=o<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(o<3?l(c):o>3?l(r,t,c):l(r,t))||c);return o>3&&c&&Object.defineProperty(r,t,c),c}function M1(a,r){return function(t,n){r(t,n,a)}}function q1(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function z1(a,r,t,n){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(q){l(q)}}function b(O){try{y(n.throw(O))}catch(q){l(q)}}function y(O){O.done?c(O.value):o(O.value).then(p,b)}y((n=n.apply(a,r||[])).next())})}function U1(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return b([y,O])}}function b(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(c=y[0]&2?o.return:y[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,y[1])).done)return c;switch(o=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,o=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],o=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function B1(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function H1(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function dc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function of(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),o,c=[],l;try{for(;(r===void 0||r-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(p){l={error:p}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function k1(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(of(arguments[r]));return a}function V1(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),o=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,o++)n[o]=c[l];return n}function Vn(a){return this instanceof Vn?(this.v=a,this):new Vn(a)}function K1(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(C){n[C]&&(o[C]=function(z){return new Promise(function(F,K){c.push([C,z,F,K])>1||p(C,z)})})}function p(C,z){try{b(n[C](z))}catch(F){q(c[0][3],F)}}function b(C){C.value instanceof Vn?Promise.resolve(C.value.v).then(y,O):q(c[0][2],C)}function y(C){p("next",C)}function O(C){p("throw",C)}function q(C,z){C(z),c.shift(),c.length&&p(c[0][0],c[0][1])}}function G1(a){var r,t;return r={},n("next"),n("throw",function(o){throw o}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(o,c){r[o]=a[o]?function(l){return(t=!t)?{value:Vn(a[o](l)),done:o==="return"}:c?c(l):l}:c}}function W1(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof dc=="function"?dc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,b){l=a[c](l),o(p,b,l.done,l.value)})}}function o(c,l,p,b){Promise.resolve(b).then(function(y){c({value:y,done:p})},l)}}function J1(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function Y1(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function X1(a){return a&&a.__esModule?a:{default:a}}function Z1(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Q1(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const em=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return pc},__asyncDelegator:G1,__asyncGenerator:K1,__asyncValues:W1,__await:Vn,__awaiter:z1,__classPrivateFieldGet:Z1,__classPrivateFieldSet:Q1,__createBinding:B1,__decorate:L1,__exportStar:H1,__extends:F1,__generator:U1,__importDefault:X1,__importStar:Y1,__makeTemplateObject:J1,__metadata:q1,__param:M1,__read:of,__rest:j1,__spread:k1,__spreadArrays:V1,__values:dc},Symbol.toStringTag,{value:"Module"})),go=Jn(em);var Fn={},Wa={},jn={};let Mi=class{};const tm=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Mi},Symbol.toStringTag,{value:"Module"})),rm=Jn(tm);var Jh;function im(){if(Jh)return jn;Jh=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.IHeartBeat=void 0;const a=rm;class r extends a.IEvents{constructor(n){super()}}return jn.IHeartBeat=r,jn}var Yh;function af(){return Yh||(Yh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),go.__exportStar(im(),a)}(Wa)),Wa}var Ja={},ji={},Xh;function nm(){if(Xh)return ji;Xh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.HEARTBEAT_EVENTS=ji.HEARTBEAT_INTERVAL=void 0;const a=se;return ji.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,ji.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ji}var Zh;function cf(){return Zh||(Zh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),go.__exportStar(nm(),a)}(Ja)),Ja}var Qh;function sm(){if(Qh)return Fn;Qh=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.HeartBeat=void 0;const a=go,r=Or,t=se,n=af(),o=cf();class c extends n.IHeartBeat{constructor(p){super(p),this.events=new r.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(p==null?void 0:p.interval)||o.HEARTBEAT_INTERVAL}static init(p){return a.__awaiter(this,void 0,void 0,function*(){const b=new c(p);return yield b.init(),b})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,b){this.events.on(p,b)}once(p,b){this.events.once(p,b)}off(p,b){this.events.off(p,b)}removeListener(p,b){this.events.removeListener(p,b)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Fn.HeartBeat=c,Fn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=go;r.__exportStar(sm(),a),r.__exportStar(af(),a),r.__exportStar(cf(),a)})(fn);var Te={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gc=function(a,r){return gc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])},gc(a,r)};function om(a,r){gc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var yc=function(){return yc=Object.assign||function(r){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},yc.apply(this,arguments)};function am(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(t[n[o]]=a[n[o]]);return t}function cm(a,r,t,n){var o=arguments.length,c=o<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(o<3?l(c):o>3?l(r,t,c):l(r,t))||c);return o>3&&c&&Object.defineProperty(r,t,c),c}function um(a,r){return function(t,n){r(t,n,a)}}function hm(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function lm(a,r,t,n){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(q){l(q)}}function b(O){try{y(n.throw(O))}catch(q){l(q)}}function y(O){O.done?c(O.value):o(O.value).then(p,b)}y((n=n.apply(a,r||[])).next())})}function fm(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return b([y,O])}}function b(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(c=y[0]&2?o.return:y[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,y[1])).done)return c;switch(o=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,o=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],o=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function pm(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function dm(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function vc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function uf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),o,c=[],l;try{for(;(r===void 0||r-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(p){l={error:p}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function gm(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(uf(arguments[r]));return a}function ym(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),o=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,o++)n[o]=c[l];return n}function Kn(a){return this instanceof Kn?(this.v=a,this):new Kn(a)}function vm(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(C){n[C]&&(o[C]=function(z){return new Promise(function(F,K){c.push([C,z,F,K])>1||p(C,z)})})}function p(C,z){try{b(n[C](z))}catch(F){q(c[0][3],F)}}function b(C){C.value instanceof Kn?Promise.resolve(C.value.v).then(y,O):q(c[0][2],C)}function y(C){p("next",C)}function O(C){p("throw",C)}function q(C,z){C(z),c.shift(),c.length&&p(c[0][0],c[0][1])}}function _m(a){var r,t;return r={},n("next"),n("throw",function(o){throw o}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(o,c){r[o]=a[o]?function(l){return(t=!t)?{value:Kn(a[o](l)),done:o==="return"}:c?c(l):l}:c}}function mm(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof vc=="function"?vc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,b){l=a[c](l),o(p,b,l.done,l.value)})}}function o(c,l,p,b){Promise.resolve(b).then(function(y){c({value:y,done:p})},l)}}function bm(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function wm(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function Em(a){return a&&a.__esModule?a:{default:a}}function xm(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Im(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const Sm=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return yc},__asyncDelegator:_m,__asyncGenerator:vm,__asyncValues:mm,__await:Kn,__awaiter:lm,__classPrivateFieldGet:xm,__classPrivateFieldSet:Im,__createBinding:pm,__decorate:cm,__exportStar:dm,__extends:om,__generator:fm,__importDefault:Em,__importStar:wm,__makeTemplateObject:bm,__metadata:hm,__param:um,__read:uf,__rest:am,__spread:gm,__spreadArrays:ym,__values:vc},Symbol.toStringTag,{value:"Module"})),Pm=Jn(Sm);var Ya,el;function Om(){if(el)return Ya;el=1;function a(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Ya=r;function r(t,n,o){var c=o&&o.stringify||a,l=1;if(typeof t=="object"&&t!==null){var p=n.length+l;if(p===1)return t;var b=new Array(p);b[0]=c(t);for(var y=1;y<p;y++)b[y]=c(n[y]);return b.join(" ")}if(typeof t!="string")return t;var O=n.length;if(O===0)return t;for(var q="",C=1-l,z=-1,F=t&&t.length||0,K=0;K<F;){if(t.charCodeAt(K)===37&&K+1<F){switch(z=z>-1?z:0,t.charCodeAt(K+1)){case 100:case 102:if(C>=O||n[C]==null)break;z<K&&(q+=t.slice(z,K)),q+=Number(n[C]),z=K+2,K++;break;case 105:if(C>=O||n[C]==null)break;z<K&&(q+=t.slice(z,K)),q+=Math.floor(Number(n[C])),z=K+2,K++;break;case 79:case 111:case 106:if(C>=O||n[C]===void 0)break;z<K&&(q+=t.slice(z,K));var ie=typeof n[C];if(ie==="string"){q+="'"+n[C]+"'",z=K+2,K++;break}if(ie==="function"){q+=n[C].name||"<anonymous>",z=K+2,K++;break}q+=c(n[C]),z=K+2,K++;break;case 115:if(C>=O)break;z<K&&(q+=t.slice(z,K)),q+=String(n[C]),z=K+2,K++;break;case 37:z<K&&(q+=t.slice(z,K)),q+="%",z=K+2,K++,C--;break}++C}++K}return z===-1?t:(z<F&&(q+=t.slice(z)),q)}return Ya}var Xa,tl;function Am(){if(tl)return Xa;tl=1;const a=Om();Xa=o;const r=le().console||{},t={mapHttpRequest:F,mapHttpResponse:F,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:F,res:F,err:C};function n(N,U){return Array.isArray(N)?N.filter(function(ye){return ye!=="!stdSerializers.err"}):N===!0?Object.keys(U):!1}function o(N){N=N||{},N.browser=N.browser||{};const U=N.browser.transmit;if(U&&typeof U.send!="function")throw Error("pino: transmit option must have a send function");const W=N.browser.write||r;N.browser.write&&(N.browser.asObject=!0);const ye=N.serializers||{},re=n(N.browser.serialize,ye);let ue=N.browser.serialize;Array.isArray(N.browser.serialize)&&N.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Re=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),N.enabled===!1&&(N.level="silent");const ze=N.level||"info",_=Object.create(W);_.log||(_.log=ie),Object.defineProperty(_,"levelVal",{get:X}),Object.defineProperty(_,"level",{get:ce,set:V});const x={transmit:U,serialize:re,asObject:N.browser.asObject,levels:Re,timestamp:z(N)};_.levels=o.levels,_.level=ze,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=ie,_.serializers=ye,_._serialize=re,_._stdErrSerialize=ue,_.child=B,U&&(_._logEvent=q());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function V(k){if(k!=="silent"&&!this.levels.values[k])throw Error("unknown level "+k);this._level=k,c(x,_,"error","log"),c(x,_,"fatal","error"),c(x,_,"warn","error"),c(x,_,"info","log"),c(x,_,"debug","log"),c(x,_,"trace","log")}function B(k,G){if(!k)throw new Error("missing bindings for child Pino");G=G||{},re&&k.serializers&&(G.serializers=k.serializers);const Je=G.serializers;if(re&&Je){var He=Object.assign({},ye,Je),jr=N.browser.serialize===!0?Object.keys(He):re;delete k.serializers,b([k],jr,He,this._stdErrSerialize)}function xe(It){this._childLevel=(It._childLevel|0)+1,this.error=y(It,k,"error"),this.fatal=y(It,k,"fatal"),this.warn=y(It,k,"warn"),this.info=y(It,k,"info"),this.debug=y(It,k,"debug"),this.trace=y(It,k,"trace"),He&&(this.serializers=He,this._serialize=jr),U&&(this._logEvent=q([].concat(It._logEvent.bindings,k)))}return xe.prototype=this,new xe(this)}return _}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:Ee,epochTime:ge,unixTime:pe,isoTime:he});function c(N,U,W,ye){const re=Object.getPrototypeOf(U);U[W]=U.levelVal>U.levels.values[W]?ie:re[W]?re[W]:r[W]||r[ye]||ie,l(N,U,W)}function l(N,U,W){!N.transmit&&U[W]===ie||(U[W]=function(ye){return function(){const ue=N.timestamp(),Re=new Array(arguments.length),ze=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var _=0;_<Re.length;_++)Re[_]=arguments[_];if(N.serialize&&!N.asObject&&b(Re,this._serialize,this.serializers,this._stdErrSerialize),N.asObject?ye.call(ze,p(this,W,Re,ue)):ye.apply(ze,Re),N.transmit){const x=N.transmit.level||U.level,X=o.levels.values[x],ce=o.levels.values[W];if(ce<X)return;O(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:x,transmitValue:o.levels.values[N.transmit.level||U.level],send:N.transmit.send,val:U.levelVal},Re)}}}(U[W]))}function p(N,U,W,ye){N._serialize&&b(W,N._serialize,N.serializers,N._stdErrSerialize);const re=W.slice();let ue=re[0];const Re={};ye&&(Re.time=ye),Re.level=o.levels.values[U];let ze=(N._childLevel|0)+1;if(ze<1&&(ze=1),ue!==null&&typeof ue=="object"){for(;ze--&&typeof re[0]=="object";)Object.assign(Re,re.shift());ue=re.length?a(re.shift(),re):void 0}else typeof ue=="string"&&(ue=a(re.shift(),re));return ue!==void 0&&(Re.msg=ue),Re}function b(N,U,W,ye){for(const re in N)if(ye&&N[re]instanceof Error)N[re]=o.stdSerializers.err(N[re]);else if(typeof N[re]=="object"&&!Array.isArray(N[re]))for(const ue in N[re])U&&U.indexOf(ue)>-1&&ue in W&&(N[re][ue]=W[ue](N[re][ue]))}function y(N,U,W){return function(){const ye=new Array(1+arguments.length);ye[0]=U;for(var re=1;re<ye.length;re++)ye[re]=arguments[re-1];return N[W].apply(this,ye)}}function O(N,U,W){const ye=U.send,re=U.ts,ue=U.methodLevel,Re=U.methodValue,ze=U.val,_=N._logEvent.bindings;b(W,N._serialize||Object.keys(N.serializers),N.serializers,N._stdErrSerialize===void 0?!0:N._stdErrSerialize),N._logEvent.ts=re,N._logEvent.messages=W.filter(function(x){return _.indexOf(x)===-1}),N._logEvent.level.label=ue,N._logEvent.level.value=Re,ye(ue,N._logEvent,ze),N._logEvent=q(_)}function q(N){return{ts:0,messages:[],bindings:N||[],level:{label:"",value:0}}}function C(N){const U={type:N.constructor.name,msg:N.message,stack:N.stack};for(const W in N)U[W]===void 0&&(U[W]=N[W]);return U}function z(N){return typeof N.timestamp=="function"?N.timestamp:N.timestamp===!1?Ee:ge}function F(){return{}}function K(N){return N}function ie(){}function Ee(){return!1}function ge(){return Date.now()}function pe(){return Math.round(Date.now()/1e3)}function he(){return new Date(Date.now()).toISOString()}function le(){function N(U){return typeof U<"u"&&U}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return N(self)||N(window)||N(this)||{}}}return Xa}var Li={},rl;function hf(){return rl||(rl=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.PINO_CUSTOM_CONTEXT_KEY=Li.PINO_LOGGER_DEFAULTS=void 0,Li.PINO_LOGGER_DEFAULTS={level:"info"},Li.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Li}var Qt={},il;function Cm(){if(il)return Qt;il=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.generateChildLogger=Qt.formatChildLoggerContext=Qt.getLoggerContext=Qt.setBrowserLoggerContext=Qt.getBrowserLoggerContext=Qt.getDefaultLoggerOptions=void 0;const a=hf();function r(p){return Object.assign(Object.assign({},p),{level:(p==null?void 0:p.level)||a.PINO_LOGGER_DEFAULTS.level})}Qt.getDefaultLoggerOptions=r;function t(p,b=a.PINO_CUSTOM_CONTEXT_KEY){return p[b]||""}Qt.getBrowserLoggerContext=t;function n(p,b,y=a.PINO_CUSTOM_CONTEXT_KEY){return p[y]=b,p}Qt.setBrowserLoggerContext=n;function o(p,b=a.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof p.bindings>"u"?y=t(p,b):y=p.bindings().context||"",y}Qt.getLoggerContext=o;function c(p,b,y=a.PINO_CUSTOM_CONTEXT_KEY){const O=o(p,y);return O.trim()?`${O}/${b}`:b}Qt.formatChildLoggerContext=c;function l(p,b,y=a.PINO_CUSTOM_CONTEXT_KEY){const O=c(p,b,y),q=p.child({context:O});return n(q,O,y)}return Qt.generateChildLogger=l,Qt}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const r=Pm,t=r.__importDefault(Am());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return t.default}}),r.__exportStar(hf(),a),r.__exportStar(Cm(),a)})(Te);class Tm extends Mi{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}class Rm extends Mi{constructor(r,t){super(),this.core=r,this.logger=t,this.records=new Map}}class $m{constructor(r,t){this.logger=r,this.core=t}}let Nm=class extends Mi{constructor(r,t){super(),this.relayer=r,this.logger=t}},Dm=class extends Mi{constructor(r){super()}},Fm=class{constructor(r,t,n,o){this.core=r,this.logger=t,this.name=n}};class jm extends Mi{constructor(r,t){super(),this.relayer=r,this.logger=t}}let Lm=class extends Mi{constructor(r,t){super(),this.core=r,this.logger=t}},Mm=class{constructor(r,t){this.projectId=r,this.logger=t}},qm=class{constructor(r){this.opts=r,this.protocol="wc",this.version=2}},zm=class{constructor(r){this.client=r}};const Um=a=>JSON.stringify(a,(r,t)=>typeof t=="bigint"?t.toString()+"n":t),Bm=a=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=a.replace(r,'$1"$2n"$3');return JSON.parse(t,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Tc(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return Bm(a)}catch{return a}}function Gn(a){return typeof a=="string"?a:Um(a)||""}var Rc={},lf={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=w_,t=Gl;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function p(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},p.prototype.update=function(b,y){if(y===void 0&&(y=b.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var O=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=b[O++],y--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(O=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,b,O,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=b[O++],y--;return this},p.prototype.finish=function(b){if(!this._finished){var y=this._bytesHashed,O=this._bufferLength,q=y/536870912|0,C=y<<3,z=y%128<112?128:256;this._buffer[O]=128;for(var F=O+1;F<z-8;F++)this._buffer[F]=0;r.writeUint32BE(q,this._buffer,z-8),r.writeUint32BE(C,this._buffer,z-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,z),this._finished=!0}for(var F=0;F<this.digestLength/8;F++)r.writeUint32BE(this._stateHi[F],b,F*8),r.writeUint32BE(this._stateLo[F],b,F*8+4);return this},p.prototype.digest=function(){var b=new Uint8Array(this.digestLength);return this.finish(b),b},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(b){return this._stateHi.set(b.stateHi),this._stateLo.set(b.stateLo),this._bufferLength=b.bufferLength,b.buffer&&this._buffer.set(b.buffer),this._bytesHashed=b.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(b){t.wipe(b.stateHi),t.wipe(b.stateLo),b.buffer&&t.wipe(b.buffer),b.bufferLength=0,b.bytesHashed=0},p}();a.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(p,b,y,O,q,C,z){for(var F=y[0],K=y[1],ie=y[2],Ee=y[3],ge=y[4],pe=y[5],he=y[6],le=y[7],N=O[0],U=O[1],W=O[2],ye=O[3],re=O[4],ue=O[5],Re=O[6],ze=O[7],_,x,X,ce,V,B,k,G;z>=128;){for(var Je=0;Je<16;Je++){var He=8*Je+C;p[Je]=r.readUint32BE(q,He),b[Je]=r.readUint32BE(q,He+4)}for(var Je=0;Je<80;Je++){var jr=F,xe=K,It=ie,$=Ee,R=ge,A=pe,h=he,E=le,ee=N,fe=U,be=W,$e=ye,De=re,Pe=ue,St=Re,_t=ze;if(_=le,x=ze,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=(ge>>>14|re<<32-14)^(ge>>>18|re<<32-18)^(re>>>41-32|ge<<32-(41-32)),x=(re>>>14|ge<<32-14)^(re>>>18|ge<<32-18)^(ge>>>41-32|re<<32-(41-32)),V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,_=ge&pe^~ge&he,x=re&ue^~re&Re,V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,_=o[Je*2],x=o[Je*2+1],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,_=p[Je%16],x=b[Je%16],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,X=k&65535|G<<16,ce=V&65535|B<<16,_=X,x=ce,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=(F>>>28|N<<32-28)^(N>>>34-32|F<<32-(34-32))^(N>>>39-32|F<<32-(39-32)),x=(N>>>28|F<<32-28)^(F>>>34-32|N<<32-(34-32))^(F>>>39-32|N<<32-(39-32)),V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,_=F&K^F&ie^K&ie,x=N&U^N&W^U&W,V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,E=k&65535|G<<16,_t=V&65535|B<<16,_=$,x=$e,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=X,x=ce,V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,$=k&65535|G<<16,$e=V&65535|B<<16,K=jr,ie=xe,Ee=It,ge=$,pe=R,he=A,le=h,F=E,U=ee,W=fe,ye=be,re=$e,ue=De,Re=Pe,ze=St,N=_t,Je%16===15)for(var He=0;He<16;He++)_=p[He],x=b[He],V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=p[(He+9)%16],x=b[(He+9)%16],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,X=p[(He+1)%16],ce=b[(He+1)%16],_=(X>>>1|ce<<32-1)^(X>>>8|ce<<32-8)^X>>>7,x=(ce>>>1|X<<32-1)^(ce>>>8|X<<32-8)^(ce>>>7|X<<32-7),V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,X=p[(He+14)%16],ce=b[(He+14)%16],_=(X>>>19|ce<<32-19)^(ce>>>61-32|X<<32-(61-32))^X>>>6,x=(ce>>>19|X<<32-19)^(X>>>61-32|ce<<32-(61-32))^(ce>>>6|X<<32-6),V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,p[He]=k&65535|G<<16,b[He]=V&65535|B<<16}_=F,x=N,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[0],x=O[0],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[0]=F=k&65535|G<<16,O[0]=N=V&65535|B<<16,_=K,x=U,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[1],x=O[1],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[1]=K=k&65535|G<<16,O[1]=U=V&65535|B<<16,_=ie,x=W,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[2],x=O[2],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[2]=ie=k&65535|G<<16,O[2]=W=V&65535|B<<16,_=Ee,x=ye,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[3],x=O[3],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[3]=Ee=k&65535|G<<16,O[3]=ye=V&65535|B<<16,_=ge,x=re,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[4],x=O[4],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[4]=ge=k&65535|G<<16,O[4]=re=V&65535|B<<16,_=pe,x=ue,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[5],x=O[5],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[5]=pe=k&65535|G<<16,O[5]=ue=V&65535|B<<16,_=he,x=Re,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[6],x=O[6],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[6]=he=k&65535|G<<16,O[6]=Re=V&65535|B<<16,_=le,x=ze,V=x&65535,B=x>>>16,k=_&65535,G=_>>>16,_=y[7],x=O[7],V+=x&65535,B+=x>>>16,k+=_&65535,G+=_>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,y[7]=le=k&65535|G<<16,O[7]=ze=V&65535|B<<16,C+=128,z-=128}return C}function l(p){var b=new n;b.update(p);var y=b.digest();return b.clean(),y}a.hash=l})(lf);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const r=Wl,t=lf,n=Gl;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o($){const R=new Float64Array(16);if($)for(let A=0;A<$.length;A++)R[A]=$[A];return R}const c=new Uint8Array(32);c[0]=9;const l=o(),p=o([1]),b=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),O=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),q=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function z($,R){for(let A=0;A<16;A++)$[A]=R[A]|0}function F($){let R=1;for(let A=0;A<16;A++){let h=$[A]+R+65535;R=Math.floor(h/65536),$[A]=h-R*65536}$[0]+=R-1+37*(R-1)}function K($,R,A){const h=~(A-1);for(let E=0;E<16;E++){const ee=h&($[E]^R[E]);$[E]^=ee,R[E]^=ee}}function ie($,R){const A=o(),h=o();for(let E=0;E<16;E++)h[E]=R[E];F(h),F(h),F(h);for(let E=0;E<2;E++){A[0]=h[0]-65517;for(let fe=1;fe<15;fe++)A[fe]=h[fe]-65535-(A[fe-1]>>16&1),A[fe-1]&=65535;A[15]=h[15]-32767-(A[14]>>16&1);const ee=A[15]>>16&1;A[14]&=65535,K(h,A,1-ee)}for(let E=0;E<16;E++)$[2*E]=h[E]&255,$[2*E+1]=h[E]>>8}function Ee($,R){let A=0;for(let h=0;h<32;h++)A|=$[h]^R[h];return(1&A-1>>>8)-1}function ge($,R){const A=new Uint8Array(32),h=new Uint8Array(32);return ie(A,$),ie(h,R),Ee(A,h)}function pe($){const R=new Uint8Array(32);return ie(R,$),R[0]&1}function he($,R){for(let A=0;A<16;A++)$[A]=R[2*A]+(R[2*A+1]<<8);$[15]&=32767}function le($,R,A){for(let h=0;h<16;h++)$[h]=R[h]+A[h]}function N($,R,A){for(let h=0;h<16;h++)$[h]=R[h]-A[h]}function U($,R,A){let h,E,ee=0,fe=0,be=0,$e=0,De=0,Pe=0,St=0,_t=0,st=0,je=0,Xe=0,Ze=0,ot=0,Ue=0,Qe=0,Ne=0,ke=0,ut=0,Me=0,Pt=0,Ft=0,Ut=0,Bt=0,Mt=0,Gt=0,tr=0,Lr=0,Wt=0,Vr=0,oi=0,Ei=0,ht=A[0],rt=A[1],lt=A[2],ft=A[3],at=A[4],it=A[5],Ot=A[6],At=A[7],pt=A[8],Ct=A[9],dt=A[10],mt=A[11],gt=A[12],Ye=A[13],Tt=A[14],Rt=A[15];h=R[0],ee+=h*ht,fe+=h*rt,be+=h*lt,$e+=h*ft,De+=h*at,Pe+=h*it,St+=h*Ot,_t+=h*At,st+=h*pt,je+=h*Ct,Xe+=h*dt,Ze+=h*mt,ot+=h*gt,Ue+=h*Ye,Qe+=h*Tt,Ne+=h*Rt,h=R[1],fe+=h*ht,be+=h*rt,$e+=h*lt,De+=h*ft,Pe+=h*at,St+=h*it,_t+=h*Ot,st+=h*At,je+=h*pt,Xe+=h*Ct,Ze+=h*dt,ot+=h*mt,Ue+=h*gt,Qe+=h*Ye,Ne+=h*Tt,ke+=h*Rt,h=R[2],be+=h*ht,$e+=h*rt,De+=h*lt,Pe+=h*ft,St+=h*at,_t+=h*it,st+=h*Ot,je+=h*At,Xe+=h*pt,Ze+=h*Ct,ot+=h*dt,Ue+=h*mt,Qe+=h*gt,Ne+=h*Ye,ke+=h*Tt,ut+=h*Rt,h=R[3],$e+=h*ht,De+=h*rt,Pe+=h*lt,St+=h*ft,_t+=h*at,st+=h*it,je+=h*Ot,Xe+=h*At,Ze+=h*pt,ot+=h*Ct,Ue+=h*dt,Qe+=h*mt,Ne+=h*gt,ke+=h*Ye,ut+=h*Tt,Me+=h*Rt,h=R[4],De+=h*ht,Pe+=h*rt,St+=h*lt,_t+=h*ft,st+=h*at,je+=h*it,Xe+=h*Ot,Ze+=h*At,ot+=h*pt,Ue+=h*Ct,Qe+=h*dt,Ne+=h*mt,ke+=h*gt,ut+=h*Ye,Me+=h*Tt,Pt+=h*Rt,h=R[5],Pe+=h*ht,St+=h*rt,_t+=h*lt,st+=h*ft,je+=h*at,Xe+=h*it,Ze+=h*Ot,ot+=h*At,Ue+=h*pt,Qe+=h*Ct,Ne+=h*dt,ke+=h*mt,ut+=h*gt,Me+=h*Ye,Pt+=h*Tt,Ft+=h*Rt,h=R[6],St+=h*ht,_t+=h*rt,st+=h*lt,je+=h*ft,Xe+=h*at,Ze+=h*it,ot+=h*Ot,Ue+=h*At,Qe+=h*pt,Ne+=h*Ct,ke+=h*dt,ut+=h*mt,Me+=h*gt,Pt+=h*Ye,Ft+=h*Tt,Ut+=h*Rt,h=R[7],_t+=h*ht,st+=h*rt,je+=h*lt,Xe+=h*ft,Ze+=h*at,ot+=h*it,Ue+=h*Ot,Qe+=h*At,Ne+=h*pt,ke+=h*Ct,ut+=h*dt,Me+=h*mt,Pt+=h*gt,Ft+=h*Ye,Ut+=h*Tt,Bt+=h*Rt,h=R[8],st+=h*ht,je+=h*rt,Xe+=h*lt,Ze+=h*ft,ot+=h*at,Ue+=h*it,Qe+=h*Ot,Ne+=h*At,ke+=h*pt,ut+=h*Ct,Me+=h*dt,Pt+=h*mt,Ft+=h*gt,Ut+=h*Ye,Bt+=h*Tt,Mt+=h*Rt,h=R[9],je+=h*ht,Xe+=h*rt,Ze+=h*lt,ot+=h*ft,Ue+=h*at,Qe+=h*it,Ne+=h*Ot,ke+=h*At,ut+=h*pt,Me+=h*Ct,Pt+=h*dt,Ft+=h*mt,Ut+=h*gt,Bt+=h*Ye,Mt+=h*Tt,Gt+=h*Rt,h=R[10],Xe+=h*ht,Ze+=h*rt,ot+=h*lt,Ue+=h*ft,Qe+=h*at,Ne+=h*it,ke+=h*Ot,ut+=h*At,Me+=h*pt,Pt+=h*Ct,Ft+=h*dt,Ut+=h*mt,Bt+=h*gt,Mt+=h*Ye,Gt+=h*Tt,tr+=h*Rt,h=R[11],Ze+=h*ht,ot+=h*rt,Ue+=h*lt,Qe+=h*ft,Ne+=h*at,ke+=h*it,ut+=h*Ot,Me+=h*At,Pt+=h*pt,Ft+=h*Ct,Ut+=h*dt,Bt+=h*mt,Mt+=h*gt,Gt+=h*Ye,tr+=h*Tt,Lr+=h*Rt,h=R[12],ot+=h*ht,Ue+=h*rt,Qe+=h*lt,Ne+=h*ft,ke+=h*at,ut+=h*it,Me+=h*Ot,Pt+=h*At,Ft+=h*pt,Ut+=h*Ct,Bt+=h*dt,Mt+=h*mt,Gt+=h*gt,tr+=h*Ye,Lr+=h*Tt,Wt+=h*Rt,h=R[13],Ue+=h*ht,Qe+=h*rt,Ne+=h*lt,ke+=h*ft,ut+=h*at,Me+=h*it,Pt+=h*Ot,Ft+=h*At,Ut+=h*pt,Bt+=h*Ct,Mt+=h*dt,Gt+=h*mt,tr+=h*gt,Lr+=h*Ye,Wt+=h*Tt,Vr+=h*Rt,h=R[14],Qe+=h*ht,Ne+=h*rt,ke+=h*lt,ut+=h*ft,Me+=h*at,Pt+=h*it,Ft+=h*Ot,Ut+=h*At,Bt+=h*pt,Mt+=h*Ct,Gt+=h*dt,tr+=h*mt,Lr+=h*gt,Wt+=h*Ye,Vr+=h*Tt,oi+=h*Rt,h=R[15],Ne+=h*ht,ke+=h*rt,ut+=h*lt,Me+=h*ft,Pt+=h*at,Ft+=h*it,Ut+=h*Ot,Bt+=h*At,Mt+=h*pt,Gt+=h*Ct,tr+=h*dt,Lr+=h*mt,Wt+=h*gt,Vr+=h*Ye,oi+=h*Tt,Ei+=h*Rt,ee+=38*ke,fe+=38*ut,be+=38*Me,$e+=38*Pt,De+=38*Ft,Pe+=38*Ut,St+=38*Bt,_t+=38*Mt,st+=38*Gt,je+=38*tr,Xe+=38*Lr,Ze+=38*Wt,ot+=38*Vr,Ue+=38*oi,Qe+=38*Ei,E=1,h=ee+E+65535,E=Math.floor(h/65536),ee=h-E*65536,h=fe+E+65535,E=Math.floor(h/65536),fe=h-E*65536,h=be+E+65535,E=Math.floor(h/65536),be=h-E*65536,h=$e+E+65535,E=Math.floor(h/65536),$e=h-E*65536,h=De+E+65535,E=Math.floor(h/65536),De=h-E*65536,h=Pe+E+65535,E=Math.floor(h/65536),Pe=h-E*65536,h=St+E+65535,E=Math.floor(h/65536),St=h-E*65536,h=_t+E+65535,E=Math.floor(h/65536),_t=h-E*65536,h=st+E+65535,E=Math.floor(h/65536),st=h-E*65536,h=je+E+65535,E=Math.floor(h/65536),je=h-E*65536,h=Xe+E+65535,E=Math.floor(h/65536),Xe=h-E*65536,h=Ze+E+65535,E=Math.floor(h/65536),Ze=h-E*65536,h=ot+E+65535,E=Math.floor(h/65536),ot=h-E*65536,h=Ue+E+65535,E=Math.floor(h/65536),Ue=h-E*65536,h=Qe+E+65535,E=Math.floor(h/65536),Qe=h-E*65536,h=Ne+E+65535,E=Math.floor(h/65536),Ne=h-E*65536,ee+=E-1+37*(E-1),E=1,h=ee+E+65535,E=Math.floor(h/65536),ee=h-E*65536,h=fe+E+65535,E=Math.floor(h/65536),fe=h-E*65536,h=be+E+65535,E=Math.floor(h/65536),be=h-E*65536,h=$e+E+65535,E=Math.floor(h/65536),$e=h-E*65536,h=De+E+65535,E=Math.floor(h/65536),De=h-E*65536,h=Pe+E+65535,E=Math.floor(h/65536),Pe=h-E*65536,h=St+E+65535,E=Math.floor(h/65536),St=h-E*65536,h=_t+E+65535,E=Math.floor(h/65536),_t=h-E*65536,h=st+E+65535,E=Math.floor(h/65536),st=h-E*65536,h=je+E+65535,E=Math.floor(h/65536),je=h-E*65536,h=Xe+E+65535,E=Math.floor(h/65536),Xe=h-E*65536,h=Ze+E+65535,E=Math.floor(h/65536),Ze=h-E*65536,h=ot+E+65535,E=Math.floor(h/65536),ot=h-E*65536,h=Ue+E+65535,E=Math.floor(h/65536),Ue=h-E*65536,h=Qe+E+65535,E=Math.floor(h/65536),Qe=h-E*65536,h=Ne+E+65535,E=Math.floor(h/65536),Ne=h-E*65536,ee+=E-1+37*(E-1),$[0]=ee,$[1]=fe,$[2]=be,$[3]=$e,$[4]=De,$[5]=Pe,$[6]=St,$[7]=_t,$[8]=st,$[9]=je,$[10]=Xe,$[11]=Ze,$[12]=ot,$[13]=Ue,$[14]=Qe,$[15]=Ne}function W($,R){U($,R,R)}function ye($,R){const A=o();let h;for(h=0;h<16;h++)A[h]=R[h];for(h=253;h>=0;h--)W(A,A),h!==2&&h!==4&&U(A,A,R);for(h=0;h<16;h++)$[h]=A[h]}function re($,R){const A=o();let h;for(h=0;h<16;h++)A[h]=R[h];for(h=250;h>=0;h--)W(A,A),h!==1&&U(A,A,R);for(h=0;h<16;h++)$[h]=A[h]}function ue($,R){const A=o(),h=o(),E=o(),ee=o(),fe=o(),be=o(),$e=o(),De=o(),Pe=o();N(A,$[1],$[0]),N(Pe,R[1],R[0]),U(A,A,Pe),le(h,$[0],$[1]),le(Pe,R[0],R[1]),U(h,h,Pe),U(E,$[3],R[3]),U(E,E,y),U(ee,$[2],R[2]),le(ee,ee,ee),N(fe,h,A),N(be,ee,E),le($e,ee,E),le(De,h,A),U($[0],fe,be),U($[1],De,$e),U($[2],$e,be),U($[3],fe,De)}function Re($,R,A){for(let h=0;h<4;h++)K($[h],R[h],A)}function ze($,R){const A=o(),h=o(),E=o();ye(E,R[2]),U(A,R[0],E),U(h,R[1],E),ie($,h),$[31]^=pe(A)<<7}function _($,R,A){z($[0],l),z($[1],p),z($[2],p),z($[3],l);for(let h=255;h>=0;--h){const E=A[h/8|0]>>(h&7)&1;Re($,R,E),ue(R,$),ue($,$),Re($,R,E)}}function x($,R){const A=[o(),o(),o(),o()];z(A[0],O),z(A[1],q),z(A[2],p),U(A[3],O,q),_($,A,R)}function X($){if($.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const R=(0,t.hash)($);R[0]&=248,R[31]&=127,R[31]|=64;const A=new Uint8Array(32),h=[o(),o(),o(),o()];x(h,R),ze(A,h);const E=new Uint8Array(64);return E.set($),E.set(A,32),{publicKey:A,secretKey:E}}a.generateKeyPairFromSeed=X;function ce($){const R=(0,r.randomBytes)(32,$),A=X(R);return(0,n.wipe)(R),A}a.generateKeyPair=ce;function V($){if($.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array($.subarray(32))}a.extractPublicKeyFromSecretKey=V;const B=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k($,R){let A,h,E,ee;for(h=63;h>=32;--h){for(A=0,E=h-32,ee=h-12;E<ee;++E)R[E]+=A-16*R[h]*B[E-(h-32)],A=Math.floor((R[E]+128)/256),R[E]-=A*256;R[E]+=A,R[h]=0}for(A=0,E=0;E<32;E++)R[E]+=A-(R[31]>>4)*B[E],A=R[E]>>8,R[E]&=255;for(E=0;E<32;E++)R[E]-=A*B[E];for(h=0;h<32;h++)R[h+1]+=R[h]>>8,$[h]=R[h]&255}function G($){const R=new Float64Array(64);for(let A=0;A<64;A++)R[A]=$[A];for(let A=0;A<64;A++)$[A]=0;k($,R)}function Je($,R){const A=new Float64Array(64),h=[o(),o(),o(),o()],E=(0,t.hash)($.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const ee=new Uint8Array(64);ee.set(E.subarray(32),32);const fe=new t.SHA512;fe.update(ee.subarray(32)),fe.update(R);const be=fe.digest();fe.clean(),G(be),x(h,be),ze(ee,h),fe.reset(),fe.update(ee.subarray(0,32)),fe.update($.subarray(32)),fe.update(R);const $e=fe.digest();G($e);for(let De=0;De<32;De++)A[De]=be[De];for(let De=0;De<32;De++)for(let Pe=0;Pe<32;Pe++)A[De+Pe]+=$e[De]*E[Pe];return k(ee.subarray(32),A),ee}a.sign=Je;function He($,R){const A=o(),h=o(),E=o(),ee=o(),fe=o(),be=o(),$e=o();return z($[2],p),he($[1],R),W(E,$[1]),U(ee,E,b),N(E,E,$[2]),le(ee,$[2],ee),W(fe,ee),W(be,fe),U($e,be,fe),U(A,$e,E),U(A,A,ee),re(A,A),U(A,A,E),U(A,A,ee),U(A,A,ee),U($[0],A,ee),W(h,$[0]),U(h,h,ee),ge(h,E)&&U($[0],$[0],C),W(h,$[0]),U(h,h,ee),ge(h,E)?-1:(pe($[0])===R[31]>>7&&N($[0],l,$[0]),U($[3],$[0],$[1]),0)}function jr($,R,A){const h=new Uint8Array(32),E=[o(),o(),o(),o()],ee=[o(),o(),o(),o()];if(A.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(He(ee,$))return!1;const fe=new t.SHA512;fe.update(A.subarray(0,32)),fe.update($),fe.update(R);const be=fe.digest();return G(be),_(E,ee,be),x(ee,A.subarray(32)),ue(E,ee),ze(h,E),!Ee(A,h)}a.verify=jr;function xe($){let R=[o(),o(),o(),o()];if(He(R,$))throw new Error("Ed25519: invalid public key");let A=o(),h=o(),E=R[1];le(A,p,E),N(h,p,E),ye(h,h),U(A,A,h);let ee=new Uint8Array(32);return ie(ee,A),ee}a.convertPublicKeyToX25519=xe;function It($){const R=(0,t.hash)($.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const A=new Uint8Array(R.subarray(0,32));return(0,n.wipe)(R),A}a.convertSecretKeyToX25519=It})(Rc);const Hm="EdDSA",km="JWT",ff=".",pf="base64url",Vm="utf8",Km="utf8",Gm=":",Wm="did",Jm="key",nl="base58btc",Ym="z",Xm="K36",Zm=32;function uo(a){return fo(Ac(Gn(a),Vm),pf)}function df(a){const r=Ac(Xm,nl),t=Ym+fo(E_([r,a]),nl);return[Wm,Jm,t].join(Gm)}function Qm(a){return fo(a,pf)}function eb(a){return Ac([uo(a.header),uo(a.payload)].join(ff),Km)}function tb(a){return[uo(a.header),uo(a.payload),Qm(a.signature)].join(ff)}function sl(a=Wl.randomBytes(Zm)){return Rc.generateKeyPairFromSeed(a)}async function rb(a,r,t,n,o=se.fromMiliseconds(Date.now())){const c={alg:Hm,typ:km},l=df(n.publicKey),p=o+t,b={iss:l,sub:a,aud:r,iat:o,exp:p},y=eb({header:c,payload:b}),O=Rc.sign(n.secretKey,y);return tb({header:c,payload:b,signature:O})}const ib="PARSE_ERROR",nb="INVALID_REQUEST",sb="METHOD_NOT_FOUND",ob="INVALID_PARAMS",gf="INTERNAL_ERROR",$c="SERVER_ERROR",ab=[-32700,-32600,-32601,-32602,-32603],Hn={[ib]:{code:-32700,message:"Parse error"},[nb]:{code:-32600,message:"Invalid Request"},[sb]:{code:-32601,message:"Method not found"},[ob]:{code:-32602,message:"Invalid params"},[gf]:{code:-32603,message:"Internal error"},[$c]:{code:-32e3,message:"Server error"}},yf=$c;function cb(a){return ab.includes(a)}function ol(a){return Object.keys(Hn).includes(a)?Hn[a]:Hn[yf]}function ub(a){const r=Object.values(Hn).find(t=>t.code===a);return r||Hn[yf]}function vf(a,r,t){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${r}`):a}var _f={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _c=function(a,r){return _c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])},_c(a,r)};function hb(a,r){_c(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var mc=function(){return mc=Object.assign||function(r){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},mc.apply(this,arguments)};function lb(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(t[n[o]]=a[n[o]]);return t}function fb(a,r,t,n){var o=arguments.length,c=o<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var p=a.length-1;p>=0;p--)(l=a[p])&&(c=(o<3?l(c):o>3?l(r,t,c):l(r,t))||c);return o>3&&c&&Object.defineProperty(r,t,c),c}function pb(a,r){return function(t,n){r(t,n,a)}}function db(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function gb(a,r,t,n){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(O){try{y(n.next(O))}catch(q){l(q)}}function b(O){try{y(n.throw(O))}catch(q){l(q)}}function y(O){O.done?c(O.value):o(O.value).then(p,b)}y((n=n.apply(a,r||[])).next())})}function yb(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(y){return function(O){return b([y,O])}}function b(y){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(c=y[0]&2?o.return:y[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,y[1])).done)return c;switch(o=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,o=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=r.call(a,t)}catch(O){y=[6,O],o=0}finally{n=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function vb(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function _b(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function bc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function mf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),o,c=[],l;try{for(;(r===void 0||r-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(p){l={error:p}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(l)throw l.error}}return c}function mb(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(mf(arguments[r]));return a}function bb(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),o=0,r=0;r<t;r++)for(var c=arguments[r],l=0,p=c.length;l<p;l++,o++)n[o]=c[l];return n}function Wn(a){return this instanceof Wn?(this.v=a,this):new Wn(a)}function wb(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(C){n[C]&&(o[C]=function(z){return new Promise(function(F,K){c.push([C,z,F,K])>1||p(C,z)})})}function p(C,z){try{b(n[C](z))}catch(F){q(c[0][3],F)}}function b(C){C.value instanceof Wn?Promise.resolve(C.value.v).then(y,O):q(c[0][2],C)}function y(C){p("next",C)}function O(C){p("throw",C)}function q(C,z){C(z),c.shift(),c.length&&p(c[0][0],c[0][1])}}function Eb(a){var r,t;return r={},n("next"),n("throw",function(o){throw o}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(o,c){r[o]=a[o]?function(l){return(t=!t)?{value:Wn(a[o](l)),done:o==="return"}:c?c(l):l}:c}}function xb(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof bc=="function"?bc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(l){return new Promise(function(p,b){l=a[c](l),o(p,b,l.done,l.value)})}}function o(c,l,p,b){Promise.resolve(b).then(function(y){c({value:y,done:p})},l)}}function Ib(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function Sb(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function Pb(a){return a&&a.__esModule?a:{default:a}}function Ob(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Ab(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const Cb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return mc},__asyncDelegator:Eb,__asyncGenerator:wb,__asyncValues:xb,__await:Wn,__awaiter:gb,__classPrivateFieldGet:Ob,__classPrivateFieldSet:Ab,__createBinding:vb,__decorate:fb,__exportStar:_b,__extends:hb,__generator:yb,__importDefault:Pb,__importStar:Sb,__makeTemplateObject:Ib,__metadata:db,__param:pb,__read:mf,__rest:lb,__spread:mb,__spreadArrays:bb,__values:bc},Symbol.toStringTag,{value:"Module"})),Tb=Jn(Cb);var ii={},al;function Rb(){if(al)return ii;al=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.isBrowserCryptoAvailable=ii.getSubtleCrypto=ii.getBrowerCrypto=void 0;function a(){return(cr===null||cr===void 0?void 0:cr.crypto)||(cr===null||cr===void 0?void 0:cr.msCrypto)||{}}ii.getBrowerCrypto=a;function r(){const n=a();return n.subtle||n.webkitSubtle}ii.getSubtleCrypto=r;function t(){return!!a()&&!!r()}return ii.isBrowserCryptoAvailable=t,ii}var ni={},cl;function $b(){if(cl)return ni;cl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowser=ni.isNode=ni.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ni.isReactNative=a;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ni.isNode=r;function t(){return!a()&&!r()}return ni.isBrowser=t,ni}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Tb;r.__exportStar(Rb(),a),r.__exportStar($b(),a)})(_f);function bf(a=3){const r=Date.now()*Math.pow(10,a),t=Math.floor(Math.random()*Math.pow(10,a));return r+t}function Nc(a=6){return BigInt(bf(a))}function yo(a,r,t){return{id:t||bf(),jsonrpc:"2.0",method:a,params:r}}function Dc(a,r){return{id:a,jsonrpc:"2.0",result:r}}function vo(a,r,t){return{id:a,jsonrpc:"2.0",error:Nb(r,t)}}function Nb(a,r){return typeof a>"u"?ol(gf):(typeof a=="string"&&(a=Object.assign(Object.assign({},ol($c)),{message:a})),typeof r<"u"&&(a.data=r),cb(a.code)&&(a=ub(a.code)),a)}class Db{}class Fb extends Db{constructor(){super()}}class jb extends Fb{constructor(r){super()}}const Lb="^https?:",Mb="^wss?:";function qb(a){const r=a.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function wf(a,r){const t=qb(a);return typeof t>"u"?!1:new RegExp(r).test(t)}function ul(a){return wf(a,Lb)}function hl(a){return wf(a,Mb)}function zb(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Ef(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Fc(a){return Ef(a)&&"method"in a}function _o(a){return Ef(a)&&(si(a)||Fr(a))}function si(a){return"result"in a}function Fr(a){return"error"in a}class bi extends jb{constructor(r){super(r),this.events=new Or.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async request(r,t){return this.requestStrict(yo(r.method,r.params||[],r.id||Nc().toString()),t)}async requestStrict(r,t){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${r.id}`,c=>{Fr(c)?o(c.error):n(c.result)});try{await this.connection.send(r,t)}catch(c){o(c)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),_o(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Ub=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Bb=()=>typeof window<"u",ll=a=>a.split("?")[0],fl=10,Hb=Ub();class kb{constructor(r){if(this.url=r,this.events=new Or.EventEmitter,this.registering=!1,!hl(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);this.url=r}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){return new Promise((r,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),r()},this.socket.close()})}async send(r,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Gn(r))}catch(n){this.onError(r.id,n)}}register(r=this.url){if(!hl(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=r,this.registering=!0,new Promise((t,n)=>{const o=_f.isReactNative()?void 0:{rejectUnauthorized:!zb(r)},c=new Hb(r,[],o);Bb()?c.onerror=l=>{const p=l;n(this.emitError(p.error))}:c.on("error",l=>{n(this.emitError(l))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(r){r.onmessage=t=>this.onPayload(t),r.onclose=t=>this.onClose(t),this.socket=r,this.registering=!1,this.events.emit("open")}onClose(r){this.socket=void 0,this.registering=!1,this.events.emit("close",r)}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?Tc(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),o=n.message||n.toString(),c=vo(r,o);this.events.emit("payload",c)}parseError(r,t=this.url){return vf(r,ll(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>fl&&this.events.setMaxListeners(fl)}emitError(r){const t=this.parseError(new Error((r==null?void 0:r.message)||`WebSocket connection failed for host: ${ll(this.url)}`));return this.events.emit("register_error",t),t}}var ho={exports:{}};ho.exports;(function(a,r){var t=200,n="__lodash_hash_undefined__",o=1,c=2,l=9007199254740991,p="[object Arguments]",b="[object Array]",y="[object AsyncFunction]",O="[object Boolean]",q="[object Date]",C="[object Error]",z="[object Function]",F="[object GeneratorFunction]",K="[object Map]",ie="[object Number]",Ee="[object Null]",ge="[object Object]",pe="[object Promise]",he="[object Proxy]",le="[object RegExp]",N="[object Set]",U="[object String]",W="[object Symbol]",ye="[object Undefined]",re="[object WeakMap]",ue="[object ArrayBuffer]",Re="[object DataView]",ze="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",V="[object Uint8Array]",B="[object Uint8ClampedArray]",k="[object Uint16Array]",G="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,jr=/^(?:0|[1-9]\d*)$/,xe={};xe[ze]=xe[_]=xe[x]=xe[X]=xe[ce]=xe[V]=xe[B]=xe[k]=xe[G]=!0,xe[p]=xe[b]=xe[ue]=xe[O]=xe[Re]=xe[q]=xe[C]=xe[z]=xe[K]=xe[ie]=xe[ge]=xe[le]=xe[N]=xe[U]=xe[re]=!1;var It=typeof cr=="object"&&cr&&cr.Object===Object&&cr,$=typeof self=="object"&&self&&self.Object===Object&&self,R=It||$||Function("return this")(),A=r&&!r.nodeType&&r,h=A&&!0&&a&&!a.nodeType&&a,E=h&&h.exports===A,ee=E&&It.process,fe=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),be=fe&&fe.isTypedArray;function $e(v,I){for(var M=-1,Y=v==null?0:v.length,Ke=0,ve=[];++M<Y;){var et=v[M];I(et,M,v)&&(ve[Ke++]=et)}return ve}function De(v,I){for(var M=-1,Y=I.length,Ke=v.length;++M<Y;)v[Ke+M]=I[M];return v}function Pe(v,I){for(var M=-1,Y=v==null?0:v.length;++M<Y;)if(I(v[M],M,v))return!0;return!1}function St(v,I){for(var M=-1,Y=Array(v);++M<v;)Y[M]=I(M);return Y}function _t(v){return function(I){return v(I)}}function st(v,I){return v.has(I)}function je(v,I){return v==null?void 0:v[I]}function Xe(v){var I=-1,M=Array(v.size);return v.forEach(function(Y,Ke){M[++I]=[Ke,Y]}),M}function Ze(v,I){return function(M){return v(I(M))}}function ot(v){var I=-1,M=Array(v.size);return v.forEach(function(Y){M[++I]=Y}),M}var Ue=Array.prototype,Qe=Function.prototype,Ne=Object.prototype,ke=R["__core-js_shared__"],ut=Qe.toString,Me=Ne.hasOwnProperty,Pt=function(){var v=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Ft=Ne.toString,Ut=RegExp("^"+ut.call(Me).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bt=E?R.Buffer:void 0,Mt=R.Symbol,Gt=R.Uint8Array,tr=Ne.propertyIsEnumerable,Lr=Ue.splice,Wt=Mt?Mt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,oi=Bt?Bt.isBuffer:void 0,Ei=Ze(Object.keys,Object),ht=ur(R,"DataView"),rt=ur(R,"Map"),lt=ur(R,"Promise"),ft=ur(R,"Set"),at=ur(R,"WeakMap"),it=ur(Object,"create"),Ot=Gr(ht),At=Gr(rt),pt=Gr(lt),Ct=Gr(ft),dt=Gr(at),mt=Mt?Mt.prototype:void 0,gt=mt?mt.valueOf:void 0;function Ye(v){var I=-1,M=v==null?0:v.length;for(this.clear();++I<M;){var Y=v[I];this.set(Y[0],Y[1])}}function Tt(){this.__data__=it?it(null):{},this.size=0}function Rt(v){var I=this.has(v)&&delete this.__data__[v];return this.size-=I?1:0,I}function wo(v){var I=this.__data__;if(it){var M=I[v];return M===n?void 0:M}return Me.call(I,v)?I[v]:void 0}function Eo(v){var I=this.__data__;return it?I[v]!==void 0:Me.call(I,v)}function xo(v,I){var M=this.__data__;return this.size+=this.has(v)?0:1,M[v]=it&&I===void 0?n:I,this}Ye.prototype.clear=Tt,Ye.prototype.delete=Rt,Ye.prototype.get=wo,Ye.prototype.has=Eo,Ye.prototype.set=xo;function gr(v){var I=-1,M=v==null?0:v.length;for(this.clear();++I<M;){var Y=v[I];this.set(Y[0],Y[1])}}function Io(){this.__data__=[],this.size=0}function So(v){var I=this.__data__,M=xi(I,v);if(M<0)return!1;var Y=I.length-1;return M==Y?I.pop():Lr.call(I,M,1),--this.size,!0}function Po(v){var I=this.__data__,M=xi(I,v);return M<0?void 0:I[M][1]}function Oo(v){return xi(this.__data__,v)>-1}function Ao(v,I){var M=this.__data__,Y=xi(M,v);return Y<0?(++this.size,M.push([v,I])):M[Y][1]=I,this}gr.prototype.clear=Io,gr.prototype.delete=So,gr.prototype.get=Po,gr.prototype.has=Oo,gr.prototype.set=Ao;function Kr(v){var I=-1,M=v==null?0:v.length;for(this.clear();++I<M;){var Y=v[I];this.set(Y[0],Y[1])}}function zi(){this.size=0,this.__data__={hash:new Ye,map:new(rt||gr),string:new Ye}}function Co(v){var I=ai(this,v).delete(v);return this.size-=I?1:0,I}function Ui(v){return ai(this,v).get(v)}function To(v){return ai(this,v).has(v)}function Ro(v,I){var M=ai(this,v),Y=M.size;return M.set(v,I),this.size+=M.size==Y?0:1,this}Kr.prototype.clear=zi,Kr.prototype.delete=Co,Kr.prototype.get=Ui,Kr.prototype.has=To,Kr.prototype.set=Ro;function Bi(v){var I=-1,M=v==null?0:v.length;for(this.__data__=new Kr;++I<M;)this.add(v[I])}function Zn(v){return this.__data__.set(v,n),this}function Qn(v){return this.__data__.has(v)}Bi.prototype.add=Bi.prototype.push=Zn,Bi.prototype.has=Qn;function Ar(v){var I=this.__data__=new gr(v);this.size=I.size}function $o(){this.__data__=new gr,this.size=0}function No(v){var I=this.__data__,M=I.delete(v);return this.size=I.size,M}function Do(v){return this.__data__.get(v)}function Fo(v){return this.__data__.has(v)}function es(v,I){var M=this.__data__;if(M instanceof gr){var Y=M.__data__;if(!rt||Y.length<t-1)return Y.push([v,I]),this.size=++M.size,this;M=this.__data__=new Kr(Y)}return M.set(v,I),this.size=M.size,this}Ar.prototype.clear=$o,Ar.prototype.delete=No,Ar.prototype.get=Do,Ar.prototype.has=Fo,Ar.prototype.set=es;function ts(v,I){var M=Vi(v),Y=!M&&ps(v),Ke=!M&&!Y&&gn(v),ve=!M&&!Y&&!Ke&&ys(v),et=M||Y||Ke||ve,$t=et?St(v.length,String):[],Ae=$t.length;for(var Ge in v)(I||Me.call(v,Ge))&&!(et&&(Ge=="length"||Ke&&(Ge=="offset"||Ge=="parent")||ve&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||cs(Ge,Ae)))&&$t.push(Ge);return $t}function xi(v,I){for(var M=v.length;M--;)if(fs(v[M][0],I))return M;return-1}function pn(v,I,M){var Y=I(v);return Vi(v)?Y:De(Y,M(v))}function Ii(v){return v==null?v===void 0?ye:Ee:Wt&&Wt in Object(v)?os(v):Mo(v)}function dn(v){return Pi(v)&&Ii(v)==p}function Si(v,I,M,Y,Ke){return v===I?!0:v==null||I==null||!Pi(v)&&!Pi(I)?v!==v&&I!==I:rs(v,I,M,Y,Si,Ke)}function rs(v,I,M,Y,Ke,ve){var et=Vi(v),$t=Vi(I),Ae=et?b:Mr(v),Ge=$t?b:Mr(I);Ae=Ae==p?ge:Ae,Ge=Ge==p?ge:Ge;var bt=Ae==ge,rr=Ge==ge,Nt=Ae==Ge;if(Nt&&gn(v)){if(!gn(I))return!1;et=!0,bt=!1}if(Nt&&!bt)return ve||(ve=new Ar),et||ys(v)?Hi(v,I,M,Y,Ke,ve):Lo(v,I,Ae,M,Y,Ke,ve);if(!(M&o)){var tt=bt&&Me.call(v,"__wrapped__"),Jt=rr&&Me.call(I,"__wrapped__");if(tt||Jt){var Cr=tt?v.value():v,yr=Jt?I.value():I;return ve||(ve=new Ar),Ke(Cr,yr,M,Y,ve)}}return Nt?(ve||(ve=new Ar),ss(v,I,M,Y,Ke,ve)):!1}function jo(v){if(!gs(v)||hs(v))return!1;var I=Ki(v)?Ut:He;return I.test(Gr(v))}function is(v){return Pi(v)&&ds(v.length)&&!!xe[Ii(v)]}function ns(v){if(!ls(v))return Ei(v);var I=[];for(var M in Object(v))Me.call(v,M)&&M!="constructor"&&I.push(M);return I}function Hi(v,I,M,Y,Ke,ve){var et=M&o,$t=v.length,Ae=I.length;if($t!=Ae&&!(et&&Ae>$t))return!1;var Ge=ve.get(v);if(Ge&&ve.get(I))return Ge==I;var bt=-1,rr=!0,Nt=M&c?new Bi:void 0;for(ve.set(v,I),ve.set(I,v);++bt<$t;){var tt=v[bt],Jt=I[bt];if(Y)var Cr=et?Y(Jt,tt,bt,I,v,ve):Y(tt,Jt,bt,v,I,ve);if(Cr!==void 0){if(Cr)continue;rr=!1;break}if(Nt){if(!Pe(I,function(yr,qr){if(!st(Nt,qr)&&(tt===yr||Ke(tt,yr,M,Y,ve)))return Nt.push(qr)})){rr=!1;break}}else if(!(tt===Jt||Ke(tt,Jt,M,Y,ve))){rr=!1;break}}return ve.delete(v),ve.delete(I),rr}function Lo(v,I,M,Y,Ke,ve,et){switch(M){case Re:if(v.byteLength!=I.byteLength||v.byteOffset!=I.byteOffset)return!1;v=v.buffer,I=I.buffer;case ue:return!(v.byteLength!=I.byteLength||!ve(new Gt(v),new Gt(I)));case O:case q:case ie:return fs(+v,+I);case C:return v.name==I.name&&v.message==I.message;case le:case U:return v==I+"";case K:var $t=Xe;case N:var Ae=Y&o;if($t||($t=ot),v.size!=I.size&&!Ae)return!1;var Ge=et.get(v);if(Ge)return Ge==I;Y|=c,et.set(v,I);var bt=Hi($t(v),$t(I),Y,Ke,ve,et);return et.delete(v),bt;case W:if(gt)return gt.call(v)==gt.call(I)}return!1}function ss(v,I,M,Y,Ke,ve){var et=M&o,$t=ki(v),Ae=$t.length,Ge=ki(I),bt=Ge.length;if(Ae!=bt&&!et)return!1;for(var rr=Ae;rr--;){var Nt=$t[rr];if(!(et?Nt in I:Me.call(I,Nt)))return!1}var tt=ve.get(v);if(tt&&ve.get(I))return tt==I;var Jt=!0;ve.set(v,I),ve.set(I,v);for(var Cr=et;++rr<Ae;){Nt=$t[rr];var yr=v[Nt],qr=I[Nt];if(Y)var yn=et?Y(qr,yr,Nt,I,v,ve):Y(yr,qr,Nt,v,I,ve);if(!(yn===void 0?yr===qr||Ke(yr,qr,M,Y,ve):yn)){Jt=!1;break}Cr||(Cr=Nt=="constructor")}if(Jt&&!Cr){var Oi=v.constructor,qt=I.constructor;Oi!=qt&&"constructor"in v&&"constructor"in I&&!(typeof Oi=="function"&&Oi instanceof Oi&&typeof qt=="function"&&qt instanceof qt)&&(Jt=!1)}return ve.delete(v),ve.delete(I),Jt}function ki(v){return pn(v,Uo,as)}function ai(v,I){var M=v.__data__;return us(I)?M[typeof I=="string"?"string":"hash"]:M.map}function ur(v,I){var M=je(v,I);return jo(M)?M:void 0}function os(v){var I=Me.call(v,Wt),M=v[Wt];try{v[Wt]=void 0;var Y=!0}catch{}var Ke=Ft.call(v);return Y&&(I?v[Wt]=M:delete v[Wt]),Ke}var as=Vr?function(v){return v==null?[]:(v=Object(v),$e(Vr(v),function(I){return tr.call(v,I)}))}:Ve,Mr=Ii;(ht&&Mr(new ht(new ArrayBuffer(1)))!=Re||rt&&Mr(new rt)!=K||lt&&Mr(lt.resolve())!=pe||ft&&Mr(new ft)!=N||at&&Mr(new at)!=re)&&(Mr=function(v){var I=Ii(v),M=I==ge?v.constructor:void 0,Y=M?Gr(M):"";if(Y)switch(Y){case Ot:return Re;case At:return K;case pt:return pe;case Ct:return N;case dt:return re}return I});function cs(v,I){return I=I??l,!!I&&(typeof v=="number"||jr.test(v))&&v>-1&&v%1==0&&v<I}function us(v){var I=typeof v;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?v!=="__proto__":v===null}function hs(v){return!!Pt&&Pt in v}function ls(v){var I=v&&v.constructor,M=typeof I=="function"&&I.prototype||Ne;return v===M}function Mo(v){return Ft.call(v)}function Gr(v){if(v!=null){try{return ut.call(v)}catch{}try{return v+""}catch{}}return""}function fs(v,I){return v===I||v!==v&&I!==I}var ps=dn(function(){return arguments}())?dn:function(v){return Pi(v)&&Me.call(v,"callee")&&!tr.call(v,"callee")},Vi=Array.isArray;function qo(v){return v!=null&&ds(v.length)&&!Ki(v)}var gn=oi||Be;function zo(v,I){return Si(v,I)}function Ki(v){if(!gs(v))return!1;var I=Ii(v);return I==z||I==F||I==y||I==he}function ds(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=l}function gs(v){var I=typeof v;return v!=null&&(I=="object"||I=="function")}function Pi(v){return v!=null&&typeof v=="object"}var ys=be?_t(be):is;function Uo(v){return qo(v)?ts(v):ns(v)}function Ve(){return[]}function Be(){return!1}a.exports=zo})(ho,ho.exports);var Vb=ho.exports;const Kb=Jl(Vb);function Gb(a,r){if(a.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<a.length;o++){var c=a.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var p=a.length,b=a.charAt(0),y=Math.log(p)/Math.log(256),O=Math.log(256)/Math.log(p);function q(F){if(F instanceof Uint8Array||(ArrayBuffer.isView(F)?F=new Uint8Array(F.buffer,F.byteOffset,F.byteLength):Array.isArray(F)&&(F=Uint8Array.from(F))),!(F instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(F.length===0)return"";for(var K=0,ie=0,Ee=0,ge=F.length;Ee!==ge&&F[Ee]===0;)Ee++,K++;for(var pe=(ge-Ee)*O+1>>>0,he=new Uint8Array(pe);Ee!==ge;){for(var le=F[Ee],N=0,U=pe-1;(le!==0||N<ie)&&U!==-1;U--,N++)le+=256*he[U]>>>0,he[U]=le%p>>>0,le=le/p>>>0;if(le!==0)throw new Error("Non-zero carry");ie=N,Ee++}for(var W=pe-ie;W!==pe&&he[W]===0;)W++;for(var ye=b.repeat(K);W<pe;++W)ye+=a.charAt(he[W]);return ye}function C(F){if(typeof F!="string")throw new TypeError("Expected String");if(F.length===0)return new Uint8Array;var K=0;if(F[K]!==" "){for(var ie=0,Ee=0;F[K]===b;)ie++,K++;for(var ge=(F.length-K)*y+1>>>0,pe=new Uint8Array(ge);F[K];){var he=t[F.charCodeAt(K)];if(he===255)return;for(var le=0,N=ge-1;(he!==0||le<Ee)&&N!==-1;N--,le++)he+=p*pe[N]>>>0,pe[N]=he%256>>>0,he=he/256>>>0;if(he!==0)throw new Error("Non-zero carry");Ee=le,K++}if(F[K]!==" "){for(var U=ge-Ee;U!==ge&&pe[U]===0;)U++;for(var W=new Uint8Array(ie+(ge-U)),ye=ie;U!==ge;)W[ye++]=pe[U++];return W}}}function z(F){var K=C(F);if(K)return K;throw new Error(`Non-${r} character`)}return{encode:q,decodeUnsafe:C,decode:z}}var Wb=Gb,Jb=Wb;const xf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},Yb=a=>new TextEncoder().encode(a),Xb=a=>new TextDecoder().decode(a);class Zb{constructor(r,t,n){this.name=r,this.prefix=t,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class Qb{constructor(r,t,n){if(this.name=r,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return If(this,r)}}class ew{constructor(r){this.decoders=r}or(r){return If(this,r)}decode(r){const t=r[0],n=this.decoders[t];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const If=(a,r)=>new ew({...a.decoders||{[a.prefix]:a},...r.decoders||{[r.prefix]:r}});class tw{constructor(r,t,n,o){this.name=r,this.prefix=t,this.baseEncode=n,this.baseDecode=o,this.encoder=new Zb(r,t,n),this.decoder=new Qb(r,t,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const mo=({name:a,prefix:r,encode:t,decode:n})=>new tw(a,r,t,n),Xn=({prefix:a,name:r,alphabet:t})=>{const{encode:n,decode:o}=Jb(t,r);return mo({prefix:a,name:r,encode:n,decode:c=>xf(o(c))})},rw=(a,r,t,n)=>{const o={};for(let O=0;O<r.length;++O)o[r[O]]=O;let c=a.length;for(;a[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let p=0,b=0,y=0;for(let O=0;O<c;++O){const q=o[a[O]];if(q===void 0)throw new SyntaxError(`Non-${n} character`);b=b<<t|q,p+=t,p>=8&&(p-=8,l[y++]=255&b>>p)}if(p>=t||255&b<<8-p)throw new SyntaxError("Unexpected end of data");return l},iw=(a,r,t)=>{const n=r[r.length-1]==="=",o=(1<<t)-1;let c="",l=0,p=0;for(let b=0;b<a.length;++b)for(p=p<<8|a[b],l+=8;l>t;)l-=t,c+=r[o&p>>l];if(l&&(c+=r[o&p<<t-l]),n)for(;c.length*t&7;)c+="=";return c},kt=({name:a,prefix:r,bitsPerChar:t,alphabet:n})=>mo({prefix:r,name:a,encode(o){return iw(o,n,t)},decode(o){return rw(o,n,t,a)}}),nw=mo({prefix:"\0",name:"identity",encode:a=>Xb(a),decode:a=>Yb(a)});var sw=Object.freeze({__proto__:null,identity:nw});const ow=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var aw=Object.freeze({__proto__:null,base2:ow});const cw=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var uw=Object.freeze({__proto__:null,base8:cw});const hw=Xn({prefix:"9",name:"base10",alphabet:"0123456789"});var lw=Object.freeze({__proto__:null,base10:hw});const fw=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pw=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var dw=Object.freeze({__proto__:null,base16:fw,base16upper:pw});const gw=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),yw=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),vw=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_w=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),mw=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),bw=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ww=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ew=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xw=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Iw=Object.freeze({__proto__:null,base32:gw,base32upper:yw,base32pad:vw,base32padupper:_w,base32hex:mw,base32hexupper:bw,base32hexpad:ww,base32hexpadupper:Ew,base32z:xw});const Sw=Xn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Pw=Xn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ow=Object.freeze({__proto__:null,base36:Sw,base36upper:Pw});const Aw=Xn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Cw=Xn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Tw=Object.freeze({__proto__:null,base58btc:Aw,base58flickr:Cw});const Rw=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$w=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Nw=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Dw=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Fw=Object.freeze({__proto__:null,base64:Rw,base64pad:$w,base64url:Nw,base64urlpad:Dw});const Sf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),jw=Sf.reduce((a,r,t)=>(a[t]=r,a),[]),Lw=Sf.reduce((a,r,t)=>(a[r.codePointAt(0)]=t,a),[]);function Mw(a){return a.reduce((r,t)=>(r+=jw[t],r),"")}function qw(a){const r=[];for(const t of a){const n=Lw[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);r.push(n)}return new Uint8Array(r)}const zw=mo({prefix:"🚀",name:"base256emoji",encode:Mw,decode:qw});var Uw=Object.freeze({__proto__:null,base256emoji:zw}),Bw=Pf,pl=128,Hw=127,kw=~Hw,Vw=Math.pow(2,31);function Pf(a,r,t){r=r||[],t=t||0;for(var n=t;a>=Vw;)r[t++]=a&255|pl,a/=128;for(;a&kw;)r[t++]=a&255|pl,a>>>=7;return r[t]=a|0,Pf.bytes=t-n+1,r}var Kw=wc,Gw=128,dl=127;function wc(a,n){var t=0,n=n||0,o=0,c=n,l,p=a.length;do{if(c>=p)throw wc.bytes=0,new RangeError("Could not decode varint");l=a[c++],t+=o<28?(l&dl)<<o:(l&dl)*Math.pow(2,o),o+=7}while(l>=Gw);return wc.bytes=c-n,t}var Ww=Math.pow(2,7),Jw=Math.pow(2,14),Yw=Math.pow(2,21),Xw=Math.pow(2,28),Zw=Math.pow(2,35),Qw=Math.pow(2,42),eE=Math.pow(2,49),tE=Math.pow(2,56),rE=Math.pow(2,63),iE=function(a){return a<Ww?1:a<Jw?2:a<Yw?3:a<Xw?4:a<Zw?5:a<Qw?6:a<eE?7:a<tE?8:a<rE?9:10},nE={encode:Bw,decode:Kw,encodingLength:iE},Of=nE;const gl=(a,r,t=0)=>(Of.encode(a,r,t),r),yl=a=>Of.encodingLength(a),Ec=(a,r)=>{const t=r.byteLength,n=yl(a),o=n+yl(t),c=new Uint8Array(o+t);return gl(a,c,0),gl(t,c,n),c.set(r,o),new sE(a,t,r,c)};class sE{constructor(r,t,n,o){this.code=r,this.size=t,this.digest=n,this.bytes=o}}const Af=({name:a,code:r,encode:t})=>new oE(a,r,t);class oE{constructor(r,t,n){this.name=r,this.code=t,this.encode=n}digest(r){if(r instanceof Uint8Array){const t=this.encode(r);return t instanceof Uint8Array?Ec(this.code,t):t.then(n=>Ec(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Cf=a=>async r=>new Uint8Array(await crypto.subtle.digest(a,r)),aE=Af({name:"sha2-256",code:18,encode:Cf("SHA-256")}),cE=Af({name:"sha2-512",code:19,encode:Cf("SHA-512")});var uE=Object.freeze({__proto__:null,sha256:aE,sha512:cE});const Tf=0,hE="identity",Rf=xf,lE=a=>Ec(Tf,Rf(a)),fE={code:Tf,name:hE,encode:Rf,digest:lE};var pE=Object.freeze({__proto__:null,identity:fE});new TextEncoder,new TextDecoder;const vl={...sw,...aw,...uw,...lw,...dw,...Iw,...Ow,...Tw,...Fw,...Uw};({...uE,...pE});function $f(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function dE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?$f(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Nf(a,r,t,n){return{name:a,prefix:r,encoder:{name:a,prefix:r,encode:t},decoder:{decode:n}}}const _l=Nf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),Za=Nf("ascii","a",a=>{let r="a";for(let t=0;t<a.length;t++)r+=String.fromCharCode(a[t]);return r},a=>{a=a.substring(1);const r=dE(a.length);for(let t=0;t<a.length;t++)r[t]=a.charCodeAt(t);return r}),gE={utf8:_l,"utf-8":_l,hex:vl.base16,latin1:Za,ascii:Za,binary:Za,...vl};function yE(a,r="utf8"){const t=gE[r];if(!t)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?$f(globalThis.Buffer.from(a,"utf-8")):t.decoder.decode(`${t.prefix}${a}`)}const Df="wc",vE=2,jc="core",mi=`${Df}@2:${jc}:`,_E={name:jc,logger:"error"},mE={database:":memory:"},bE="crypto",ml="client_ed25519_seed",wE=se.ONE_DAY,EE="keychain",xE="0.3",IE="messages",SE="0.3",PE=se.SIX_HOURS,OE="publisher",Ff="irn",AE="error",jf="wss://relay.walletconnect.com",bl="wss://relay.walletconnect.org",CE="relayer",vt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},TE="_subscription",Ln={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},RE=se.ONE_SECOND/2,$E="2.9.0",NE=1e4,DE="0.3",FE="WALLETCONNECT_CLIENT_ID",kr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},jE="subscription",LE="0.3",ME=se.FIVE_SECONDS*1e3,qE="pairing",zE="0.3",Mn={wc_pairingDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:se.ONE_DAY,prompt:!1,tag:0},res:{ttl:se.ONE_DAY,prompt:!1,tag:0}}},Hr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},UE="history",BE="0.3",HE="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},kE="0.3",Qa="verify-api",wl="https://verify.walletconnect.com";class VE{constructor(r,t){this.core=r,this.logger=t,this.keychain=new Map,this.name=EE,this.version=xE,this.initialized=!1,this.storagePrefix=mi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:c}=Q("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=Te.generateChildLogger(t,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,Ql(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?ef(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class KE{constructor(r,t,n){this.core=r,this.logger=t,this.name=bE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=sl(o);return df(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=S_();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),l=sl(c),p=ac();return await rb(p,o,wE,l)},this.generateSharedKey=(o,c,l)=>{this.isInitialized();const p=this.getPrivateKey(o),b=P_(p,c);return this.setSymKey(b,l)},this.setSymKey=async(o,c)=>{this.isInitialized();const l=c||O_(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,l)=>{this.isInitialized();const p=A_(l),b=Gn(c);if(zh(p)){const C=p.senderPublicKey,z=p.receiverPublicKey;o=await this.generateSharedKey(C,z)}const y=this.getSymKey(o),{type:O,senderPublicKey:q}=p;return C_({type:O,symKey:y,message:b,senderPublicKey:q})},this.decode=async(o,c,l)=>{this.isInitialized();const p=T_(c,l);if(zh(p)){const O=p.receiverPublicKey,q=p.senderPublicKey;o=await this.generateSharedKey(O,q)}const b=this.getSymKey(o),y=R_({symKey:b,encoded:c});return Tc(y)},this.getPayloadType=o=>{const c=Uh(o);return $_(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Uh(o);return c.senderPublicKey?fo(c.senderPublicKey,N_):void 0},this.core=r,this.logger=Te.generateChildLogger(t,this.name),this.keychain=n||new VE(this.core,this.logger)}get context(){return Te.getLoggerContext(this.logger)}async setPrivateKey(r,t){return await this.keychain.set(r,t),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(ml)}catch{r=ac(),await this.keychain.set(ml,r)}return yE(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class GE extends $m{constructor(r,t){super(r,t),this.logger=r,this.core=t,this.messages=new Map,this.name=IE,this.version=SE,this.initialized=!1,this.storagePrefix=mi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const c=hn(o);let l=this.messages.get(n);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=o,this.messages.set(n,l),await this.persist()),c},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const c=this.get(n),l=hn(o);return typeof c[l]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Te.generateChildLogger(r,this.name),this.core=t}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,Ql(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?ef(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class WE extends Nm{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.events=new Or.EventEmitter,this.name=OE,this.queue=new Map,this.publishTimeout=se.toMiliseconds(se.TEN_SECONDS),this.queueTimeout=se.toMiliseconds(se.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,c)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:c}});try{const l=(c==null?void 0:c.ttl)||PE,p=cc(c),b=(c==null?void 0:c.prompt)||!1,y=(c==null?void 0:c.tag)||0,O=(c==null?void 0:c.id)||Nc().toString(),q={topic:n,message:o,opts:{ttl:l,relay:p,prompt:b,tag:y,id:O}},C=setTimeout(()=>this.queue.set(O,q),this.queueTimeout);try{await await co(this.rpcPublish(n,o,l,p,b,y,O),this.publishTimeout),clearTimeout(C),this.relayer.events.emit(vt.publish,q)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:c}})}catch(l){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(l),l}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=r,this.logger=Te.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Te.getLoggerContext(this.logger)}rpcPublish(r,t,n,o,c,l,p){var b,y,O,q;const C={method:so(o.protocol).publish,params:{topic:r,message:t,ttl:n,prompt:c,tag:l},id:p};return _i((b=C.params)==null?void 0:b.prompt)&&((y=C.params)==null||delete y.prompt),_i((O=C.params)==null?void 0:O.tag)&&((q=C.params)==null||delete q.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:C}),this.relayer.request(C)}onPublish(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:t,message:n,opts:o}=r;await this.publish(t,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(fn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(vt.connection_stalled);return}this.checkQueue()}),this.relayer.on(vt.message_ack,r=>{this.onPublish(r.id.toString())})}}class JE{constructor(){this.map=new Map,this.set=(r,t)=>{const n=this.get(r);this.exists(r,t)||this.map.set(r,[...n,t])},this.get=r=>this.map.get(r)||[],this.exists=(r,t)=>this.get(r).includes(t),this.delete=(r,t)=>{if(typeof t>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,t))return;const o=n.filter(c=>c!==t);if(!o.length){this.map.delete(r);return}this.map.set(r,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var YE=Object.defineProperty,XE=Object.defineProperties,ZE=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,QE=Object.prototype.hasOwnProperty,ex=Object.prototype.propertyIsEnumerable,xl=(a,r,t)=>r in a?YE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,qn=(a,r)=>{for(var t in r||(r={}))QE.call(r,t)&&xl(a,t,r[t]);if(El)for(var t of El(r))ex.call(r,t)&&xl(a,t,r[t]);return a},ec=(a,r)=>XE(a,ZE(r));class tx extends jm{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.subscriptions=new Map,this.topicMap=new JE,this.events=new Or.EventEmitter,this.name=jE,this.version=LE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=mi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const c=cc(o),l={topic:n,relay:c};this.pending.set(n,l);const p=await this.rpcSubscribe(n,c);return this.onSubscribe(p,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),p}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,c)=>{const l=new se.Watch;l.start(this.pendingSubscriptionWatchLabel);const p=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),o(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=ME&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=Te.generateChildLogger(t,this.name),this.clientId=""}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,t){let n=!1;try{n=this.getSubscription(r).topic===t}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,t){const n=this.topicMap.get(r);await Promise.all(n.map(async o=>await this.unsubscribeById(r,o,t)))}async unsubscribeById(r,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}});try{const o=cc(n);await this.rpcUnsubscribe(r,t,o);const c=er("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(r,t){const n={method:so(t.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await co(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(vt.connection_stalled)}return hn(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const t=r[0].relay,n={method:so(t.protocol).batchSubscribe,params:{topics:r.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await co(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(vt.connection_stalled)}}rpcUnsubscribe(r,t,n){const o={method:so(n.protocol).unsubscribe,params:{topic:r,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(r,t){this.setSubscription(r,ec(qn({},t),{id:r})),this.pending.delete(t.topic)}onBatchSubscribe(r){r.length&&r.forEach(t=>{this.setSubscription(t.id,qn({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(r,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,r)&&this.deleteSubscription(t,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,t){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:t}),this.addSubscription(r,t))}addSubscription(r,t){this.subscriptions.set(r,qn({},t)),this.topicMap.set(t.topic,r),this.events.emit(kr.created,t)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const t=this.subscriptions.get(r);if(!t){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}deleteSubscription(r,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:t});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(kr.deleted,ec(qn({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(kr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<r;t++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(kr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const t=await this.rpcBatchSubscribe(r);ln(t)&&this.onBatchSubscribe(t.map((n,o)=>ec(qn({},r[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(t=>{r.push(t)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(fn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(vt.connect,async()=>{await this.onConnect()}),this.relayer.on(vt.disconnect,()=>{this.onDisconnect()}),this.events.on(kr.created,async r=>{const t=kr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()}),this.events.on(kr.deleted,async r=>{const t=kr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),r())},this.pollingInterval)})}}var rx=Object.defineProperty,Il=Object.getOwnPropertySymbols,ix=Object.prototype.hasOwnProperty,nx=Object.prototype.propertyIsEnumerable,Sl=(a,r,t)=>r in a?rx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,sx=(a,r)=>{for(var t in r||(r={}))ix.call(r,t)&&Sl(a,t,r[t]);if(Il)for(var t of Il(r))nx.call(r,t)&&Sl(a,t,r[t]);return a};class ox extends Dm{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new Or.EventEmitter,this.name=CE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?Te.generateChildLogger(r.logger,this.name):Te.pino(Te.getDefaultLoggerOptions({level:r.logger||AE})),this.messages=new GE(this.logger,r.core),this.subscriber=new tx(this,this.logger),this.publisher=new WE(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||jf,this.projectId=r.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${bl}...`),await this.restartTransport(bl)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},NE)}get context(){return Te.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,t,n){this.isInitialized(),await this.publisher.publish(r,t,n),await this.recordMessageEvent({topic:r,message:t,publishedAt:Date.now()})}async subscribe(r,t){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";return o||(await Promise.all([new Promise(c=>{this.subscriber.once(kr.created,l=>{l.topic===r&&c()})}),new Promise(async c=>{o=await this.subscriber.subscribe(r,t),c()})]),o)}async unsubscribe(r,t){this.isInitialized(),await this.subscriber.unsubscribe(r,t)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(vt.transport_closed))}async transportOpen(r){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=r||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(kr.resubscribed,()=>{t()})}),await Promise.race([new Promise(async(t,n)=>{await co(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>n(o)).then(()=>t()).finally(()=>this.removeListener(vt.transport_closed,this.rejectTransportOpen))}),new Promise(t=>this.once(vt.transport_closed,this.rejectTransportOpen))])])}catch(t){this.logger.error(t);const n=t;if(!this.isConnectionStalled(n.message))throw t;this.events.emit(vt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(r){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=r||this.relayUrl,this.connected&&await Promise.all([new Promise(t=>{this.provider.once(Ln.disconnect,()=>{t()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(r){return this.staleConnectionErrors.some(t=>r.includes(t))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new bi(new kb(D_({sdkVersion:$E,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:t,message:n}=r;await this.messages.set(t,n)}async shouldIgnoreMessageEvent(r){const{topic:t,message:n}=r;return await this.subscriber.isSubscribed(t)?this.messages.has(t,n):!0}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),Fc(r)){if(!r.method.endsWith(TE))return;const t=r.params,{topic:n,message:o,publishedAt:c}=t.data,l={topic:n,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(sx({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(r),await this.onMessageEvent(l)}else _o(r)&&this.events.emit(vt.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(vt.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const t=Dc(r.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(Ln.payload,r=>this.onProviderPayload(r)),this.provider.on(Ln.connect,()=>{this.events.emit(vt.connect)}),this.provider.on(Ln.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Ln.error,r=>{this.logger.error(r),this.events.emit(vt.error,r)})}registerEventListeners(){this.events.on(vt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(vt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},se.toMiliseconds(RE))}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(r=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var ax=Object.defineProperty,Pl=Object.getOwnPropertySymbols,cx=Object.prototype.hasOwnProperty,ux=Object.prototype.propertyIsEnumerable,Ol=(a,r,t)=>r in a?ax(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Al=(a,r)=>{for(var t in r||(r={}))cx.call(r,t)&&Ol(a,t,r[t]);if(Pl)for(var t of Pl(r))ux.call(r,t)&&Ol(a,t,r[t]);return a};class bo extends Fm{constructor(r,t,n,o=mi,c=void 0){super(r,t,n,o),this.core=r,this.logger=t,this.name=n,this.map=new Map,this.version=DE,this.cached=[],this.initialized=!1,this.storagePrefix=mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!_i(l)?this.map.set(this.getKey(l),l):x_(l)?this.map.set(l.id,l):I_(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,p)=>{this.isInitialized(),this.map.has(l)?await this.update(l,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:p}),this.map.set(l,p),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(p=>Object.keys(l).every(b=>Kb(p[b],l[b]))):this.values),this.update=async(l,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:p});const b=Al(Al({},this.getData(l)),p);this.map.set(l,b),await this.persist()},this.delete=async(l,p)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:p}),this.map.delete(l),await this.persist())},this.logger=Te.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const t=this.map.get(r);if(!t){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class hx{constructor(r,t){this.core=r,this.logger=t,this.name=qE,this.version=zE,this.events=new Cc,this.initialized=!1,this.storagePrefix=mi,this.ignoredPayloadTypes=[Yl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=ac(),o=await this.core.crypto.setSymKey(n),c=Dr(se.FIVE_MINUTES),l={protocol:Ff},p={topic:o,expiry:c,relay:l,active:!1},b=F_({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:l});return await this.pairings.set(o,p),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:b}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:c,relay:l}=j_(n.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const p=Dr(se.FIVE_MINUTES),b={topic:o,relay:l,expiry:p,active:!1};return await this.pairings.set(o,b),await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:l}),this.core.expirer.set(o,p),n.activatePairing&&await this.activate({topic:o}),b},this.activate=async({topic:n})=>{this.isInitialized();const o=Dr(se.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:p,reject:b}=an();this.events.once(Dt("pairing_ping",c),({error:y})=>{y?b(y):p()}),await l()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",er("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,c)=>{const l=yo(o,c),p=await this.core.crypto.encode(n,l),b=Mn[o].req;return this.core.history.set(n,l),this.core.relayer.publish(n,p,b),l.id},this.sendResult=async(n,o,c)=>{const l=Dc(n,c),p=await this.core.crypto.encode(o,l),b=await this.core.history.get(o,n),y=Mn[b.request.method].res;await this.core.relayer.publish(o,p,y),await this.core.history.resolve(l)},this.sendError=async(n,o,c)=>{const l=vo(n,c),p=await this.core.crypto.encode(o,l),b=await this.core.history.get(o,n),y=Mn[b.request.method]?Mn[b.request.method].res:Mn.unregistered_method.res;await this.core.relayer.publish(o,p,y),await this.core.history.resolve(l)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,er("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>vi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:c}=n,l=c.method;if(this.pairings.keys.includes(o))switch(l){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:c}=n,l=(await this.core.history.get(o,c.id)).request.method;if(this.pairings.keys.includes(o))switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(n,o)=>{const{id:c}=o;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit("pairing_ping",{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onPairingPingResponse=(n,o)=>{const{id:c}=o;setTimeout(()=>{si(o)?this.events.emit(Dt("pairing_ping",c),{}):Fr(o)&&this.events.emit(Dt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:c,method:l}=o;try{if(this.registeredMethods.includes(l))return;const p=er("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,n,p),this.logger.error(p)}catch(p){await this.sendError(c,n,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(er("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ar(n)){const{message:o}=Q("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(o)}if(!L_(n.uri)){const{message:o}=Q("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(o)}},this.isValidPing=async n=>{if(!ar(n)){const{message:c}=Q("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!ar(n)){const{message:c}=Q("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!cn(n,!1)){const{message:o}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(vi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=Q("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=r,this.logger=Te.generateChildLogger(t,this.name),this.pairings=new bo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Te.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(vt.message,async r=>{const{topic:t,message:n}=r;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(t,n);Fc(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):_o(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async r=>{const{topic:t}=Xl(r.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class lx extends Rm{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.records=new Map,this.events=new Or.EventEmitter,this.name=UE,this.version=BE,this.cached=[],this.initialized=!1,this.storagePrefix=mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:c}),this.records.has(o.id))return;const l={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:c,expiry:Dr(se.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(Hr.created,l)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=Fr(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Hr.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===n){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(Hr.deleted,c)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Te.generateChildLogger(t,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:yo(t.request.method,t.request.params,t.id),chainId:t.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const t=this.records.get(r);if(!t){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Hr.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Hr.created,r=>{const t=Hr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(Hr.updated,r=>{const t=Hr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(Hr.deleted,r=>{const t=Hr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.core.heartbeat.on(fn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{se.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class fx extends Lm{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.expirations=new Map,this.events=new Or.EventEmitter,this.name=HE,this.version=kE,this.cached=[],this.initialized=!1,this.storagePrefix=mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const c=this.formatTarget(n),l={target:c,expiry:o};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Sr.created,{target:c,expiration:l})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Sr.deleted,{target:o,expiration:c})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Te.generateChildLogger(t,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return M_(r);if(typeof r=="number")return q_(r);const{message:t}=Q("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(t)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const t=this.expirations.get(r);if(!t){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}checkExpiry(r,t){const{expiry:n}=t;se.toMiliseconds(n)-Date.now()<=0&&this.expire(r,t)}expire(r,t){this.expirations.delete(r),this.events.emit(Sr.expired,{target:r,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,t)=>this.checkExpiry(t,r))}registerEventListeners(){this.core.heartbeat.on(fn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,r=>{const t=Sr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Sr.expired,r=>{const t=Sr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Sr.deleted,r=>{const t=Sr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class px extends Mm{constructor(r,t){super(r,t),this.projectId=r,this.logger=t,this.name=Qa,this.initialized=!1,this.init=async n=>{z_()||!Zl()||(this.verifyUrl=(n==null?void 0:n.verifyUrl)||wl,await this.createIframe())},this.register=async n=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const c=this.startAbortTimer(se.FIVE_SECONDS),l=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?(o=await l.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,o)=>{if(document.getElementById(Qa))return n();const c=document.createElement("iframe");c.setAttribute("id",Qa),c.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),c.style.display="none",c.addEventListener("load",()=>{this.initialized=!0,n()}),c.addEventListener("error",l=>{o(l)}),document.body.append(c),this.iframe=c}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),se.toMiliseconds(se.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=Te.generateChildLogger(t,this.name),this.verifyUrl=wl,this.abortController=new AbortController,this.isDevEnv=U_()&&{}.IS_VITEST}get context(){return Te.getLoggerContext(this.logger)}startAbortTimer(r){return setTimeout(()=>this.abortController.abort(),se.toMiliseconds(r))}}var dx=Object.defineProperty,Cl=Object.getOwnPropertySymbols,gx=Object.prototype.hasOwnProperty,yx=Object.prototype.propertyIsEnumerable,Tl=(a,r,t)=>r in a?dx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Rl=(a,r)=>{for(var t in r||(r={}))gx.call(r,t)&&Tl(a,t,r[t]);if(Cl)for(var t of Cl(r))yx.call(r,t)&&Tl(a,t,r[t]);return a};class Lc extends Tm{constructor(r){super(r),this.protocol=Df,this.version=vE,this.name=jc,this.events=new Or.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||jf;const t=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Te.pino(Te.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||_E.logger}));this.logger=Te.generateChildLogger(t,this.name),this.heartbeat=new fn.HeartBeat,this.crypto=new KE(this,this.logger,r==null?void 0:r.keychain),this.history=new lx(this,this.logger),this.expirer=new fx(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new D1(Rl(Rl({},mE),r==null?void 0:r.storageOptions)),this.relayer=new ox({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new hx(this,this.logger),this.verify=new px(this.projectId||"",this.logger)}static async init(r){const t=new Lc(r);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(FE,n),t}get context(){return Te.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const vx=Lc,Lf="wc",Mf=2,qf="client",Mc=`${Lf}@${Mf}:${qf}:`,tc={name:qf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},_x="WALLETCONNECT_DEEPLINK_CHOICE",mx="proposal",zf="Proposal expired",bx="session",ro=se.SEVEN_DAYS,wx="engine",zn={wc_sessionPropose:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1115}}},rc={min:se.FIVE_MINUTES,max:se.SEVEN_DAYS},Ex="request",xx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Ix=Object.defineProperty,Sx=Object.defineProperties,Px=Object.getOwnPropertyDescriptors,$l=Object.getOwnPropertySymbols,Ox=Object.prototype.hasOwnProperty,Ax=Object.prototype.propertyIsEnumerable,Nl=(a,r,t)=>r in a?Ix(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Ir=(a,r)=>{for(var t in r||(r={}))Ox.call(r,t)&&Nl(a,t,r[t]);if($l)for(var t of $l(r))Ax.call(r,t)&&Nl(a,t,r[t]);return a},ic=(a,r)=>Sx(a,Px(r));class Cx extends zm{constructor(r){super(r),this.name=wx,this.events=new Cc,this.initialized=!1,this.ignoredPayloadTypes=[Yl],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(zn)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized();const n=ic(Ir({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:p,relays:b}=n;let y=o,O,q=!1;if(y&&(q=this.client.core.pairing.pairings.get(y).active),!y||!q){const{topic:pe,uri:he}=await this.client.core.pairing.create();y=pe,O=he}const C=await this.client.core.crypto.generateKeyPair(),z=Ir({requiredNamespaces:c,optionalNamespaces:l,relays:b??[{protocol:Ff}],proposer:{publicKey:C,metadata:this.client.metadata}},p&&{sessionProperties:p}),{reject:F,resolve:K,done:ie}=an(se.FIVE_MINUTES,zf);if(this.events.once(Dt("session_connect"),async({error:pe,session:he})=>{if(pe)F(pe);else if(he){he.self.publicKey=C;const le=ic(Ir({},he),{requiredNamespaces:he.requiredNamespaces,optionalNamespaces:he.optionalNamespaces});await this.client.session.set(he.topic,le),await this.setExpiry(he.topic,he.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:he.peer.metadata}),K(le)}}),!y){const{message:pe}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(pe)}const Ee=await this.sendRequest(y,"wc_sessionPropose",z),ge=Dr(se.FIVE_MINUTES);return await this.setProposal(Ee,Ir({id:Ee,expiry:ge},z)),{uri:O,approval:ie}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:n,relayProtocol:o,namespaces:c,sessionProperties:l}=t,p=this.client.proposal.get(n);let{pairingTopic:b,proposer:y,requiredNamespaces:O,optionalNamespaces:q}=p;b=b||"",oo(O)||(O=H_(c,"approve()"));const C=await this.client.core.crypto.generateKeyPair(),z=y.publicKey,F=await this.client.core.crypto.generateSharedKey(C,z);b&&n&&(await this.client.core.pairing.updateMetadata({topic:b,metadata:y.metadata}),await this.sendResult(n,b,{relay:{protocol:o??"irn"},responderPublicKey:C}),await this.client.proposal.delete(n,er("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:b}));const K=Ir({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:O,optionalNamespaces:q,pairingTopic:b,controller:{publicKey:C,metadata:this.client.metadata},expiry:Dr(ro)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(F),await this.sendRequest(F,"wc_sessionSettle",K);const ie=ic(Ir({},K),{topic:F,pairingTopic:b,acknowledged:!1,self:K.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:C});return await this.client.session.set(F,ie),await this.setExpiry(F,Dr(ro)),{topic:F,acknowledged:()=>new Promise(Ee=>setTimeout(()=>Ee(this.client.session.get(F)),500))}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:n,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,o),await this.client.proposal.delete(n,er("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:n,namespaces:o}=t,c=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:o}),{done:l,resolve:p,reject:b}=an();return this.events.once(Dt("session_update",c),({error:y})=>{y?b(y):p()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:l}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:n}=t,o=await this.sendRequest(n,"wc_sessionExtend",{}),{done:c,resolve:l,reject:p}=an();return this.events.once(Dt("session_extend",o),({error:b})=>{b?p(b):l()}),await this.setExpiry(n,Dr(ro)),{acknowledged:c}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:n,request:o,topic:c,expiry:l}=t,p=await this.sendRequest(c,"wc_sessionRequest",{request:o,chainId:n},l),{done:b,resolve:y,reject:O}=an(l);this.events.once(Dt("session_request",p),({error:C,result:z})=>{C?O(C):y(z)}),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:n,id:p});const q=await this.client.core.storage.getItem(_x);return k_({id:p,topic:c,wcDeepLink:q}),await b()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:o}=t,{id:c}=o;si(o)?await this.sendResult(c,n,o.result):Fr(o)&&await this.sendError(c,n,o.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:n}=t;if(this.client.session.keys.includes(n)){const o=await this.sendRequest(n,"wc_sessionPing",{}),{done:c,resolve:l,reject:p}=an();this.events.once(Dt("session_ping",o),({error:b})=>{b?p(b):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:n,event:o,chainId:c}=t;await this.sendRequest(n,"wc_sessionEvent",{event:o,chainId:c})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n)){const o=Nc().toString();let c;const l=p=>{(p==null?void 0:p.id.toString())===o&&(this.client.core.relayer.events.removeListener(vt.message_ack,l),c())};await Promise.all([new Promise(p=>{c=p,this.client.core.relayer.on(vt.message_ack,l)}),this.sendRequest(n,"wc_sessionDelete",er("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(n)}else await this.client.core.pairing.disconnect({topic:n})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(n=>V_(n,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var l,p;return((l=c.peerMetadata)==null?void 0:l.url)&&((p=c.peerMetadata)==null?void 0:p.url)===t.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(t,n)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,er("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),n||this.client.core.expirer.del(t)},this.deleteProposal=async(t,n)=>{await Promise.all([this.client.proposal.delete(t,er("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),o?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,n)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:n}),this.client.core.expirer.set(t,n)},this.setProposal=async(t,n)=>{await this.client.proposal.set(t,n),this.client.core.expirer.set(t,n.expiry)},this.setPendingSessionRequest=async t=>{const n=zn.wc_sessionRequest.req.ttl,{id:o,topic:c,params:l}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:l}),n&&this.client.core.expirer.set(o,Dr(n))},this.sendRequest=async(t,n,o,c,l)=>{const p=yo(n,o);if(Zl()&&xx.includes(n)){const O=hn(JSON.stringify(p));await this.client.core.verify.register({attestationId:O})}const b=await this.client.core.crypto.encode(t,p),y=zn[n].req;return c&&(y.ttl=c),l&&(y.id=l),this.client.core.history.set(t,p),this.client.core.relayer.publish(t,b,y),p.id},this.sendResult=async(t,n,o)=>{const c=Dc(t,o),l=await this.client.core.crypto.encode(n,c),p=await this.client.core.history.get(n,t),b=zn[p.request.method].res;this.client.core.relayer.publish(n,l,b),await this.client.core.history.resolve(c)},this.sendError=async(t,n,o)=>{const c=vo(t,o),l=await this.client.core.crypto.encode(n,c),p=await this.client.core.history.get(n,t),b=zn[p.request.method].res;this.client.core.relayer.publish(n,l,b),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],n=[];this.client.session.getAll().forEach(o=>{vi(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{vi(o.expiry)&&n.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=t=>{const{topic:n,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:n,payload:o}=t,c=(await this.client.core.history.get(n,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:n}=t,{message:o}=Q("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,n)=>{const{params:o,id:c}=n;try{this.isValidConnect(Ir({},n.params));const l=Dr(se.FIVE_MINUTES),p=Ir({id:c,pairingTopic:t,expiry:l},o);await this.setProposal(c,p);const b=hn(JSON.stringify(n)),y=await this.getVerifyContext(b,p.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:p,verifyContext:y})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,n)=>{const{id:o}=n;if(si(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const p=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const b=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const y=await this.client.core.crypto.generateSharedKey(p,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const O=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:O}),await this.client.core.pairing.activate({topic:t})}else Fr(n)&&(await this.client.proposal.delete(o,er("USER_DISCONNECTED")),this.events.emit(Dt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(t,n)=>{const{id:o,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:p,expiry:b,namespaces:y,requiredNamespaces:O,optionalNamespaces:q,sessionProperties:C,pairingTopic:z}=n.params,F=Ir({topic:t,relay:l,expiry:b,namespaces:y,acknowledged:!0,pairingTopic:z,requiredNamespaces:O,optionalNamespaces:q,controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},C&&{sessionProperties:C});await this.sendResult(n.id,t,!0),this.events.emit(Dt("session_connect"),{session:F}),this.cleanupDuplicatePairings(F)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,n)=>{const{id:o}=n;si(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Dt("session_approve",o),{})):Fr(n)&&(await this.client.session.delete(t,er("USER_DISCONNECTED")),this.events.emit(Dt("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(t,n)=>{const{params:o,id:c}=n;try{this.isValidUpdate(Ir({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult(c,t,!0),this.client.events.emit("session_update",{id:c,topic:t,params:o})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionUpdateResponse=(t,n)=>{const{id:o}=n;si(n)?this.events.emit(Dt("session_update",o),{}):Fr(n)&&this.events.emit(Dt("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(t,n)=>{const{id:o}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Dr(ro)),await this.sendResult(o,t,!0),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,n)=>{const{id:o}=n;si(n)?this.events.emit(Dt("session_extend",o),{}):Fr(n)&&this.events.emit(Dt("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(t,n)=>{const{id:o}=n;try{this.isValidPing({topic:t}),await this.sendResult(o,t,!0),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,n)=>{const{id:o}=n;setTimeout(()=>{si(n)?this.events.emit(Dt("session_ping",o),{}):Fr(n)&&this.events.emit(Dt("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(t,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(vt.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult(o,t,!0)]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,n)=>{const{id:o,params:c}=n;try{this.isValidRequest(Ir({topic:t},c)),await this.setPendingSessionRequest({id:o,topic:t,params:c});const l=hn(JSON.stringify(n)),p=this.client.session.get(t),b=await this.getVerifyContext(l,p.peer.metadata);this.client.events.emit("session_request",{id:o,topic:t,params:c,verifyContext:b})}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,n)=>{const{id:o}=n;si(n)?this.events.emit(Dt("session_request",o),{result:n.result}):Fr(n)&&this.events.emit(Dt("session_request",o),{error:n.error})},this.onSessionEventRequest=async(t,n)=>{const{id:o,params:c}=n;try{this.isValidEmit(Ir({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c})}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.isValidConnect=async t=>{if(!ar(t)){const{message:b}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(b)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:p}=t;if(_i(n)||await this.isValidPairingTopic(n),!K_(p,!0)){const{message:b}=Q("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(b)}!_i(o)&&oo(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!_i(c)&&oo(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),_i(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,n)=>{const o=G_(t,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!ar(t))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:o,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(n);const p=this.client.proposal.get(n),b=Va(o,"approve()");if(b)throw new Error(b.message);const y=Bh(p.requiredNamespaces,o,"approve()");if(y)throw new Error(y.message);if(!cn(c,!0)){const{message:O}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(O)}_i(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!ar(t)){const{message:c}=Q("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:n,reason:o}=t;if(await this.isValidProposalId(n),!W_(o)){const{message:c}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!ar(t)){const{message:y}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(y)}const{relay:n,controller:o,namespaces:c,expiry:l}=t;if(!J_(n)){const{message:y}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const p=Y_(o,"onSessionSettleRequest()");if(p)throw new Error(p.message);const b=Va(c,"onSessionSettleRequest()");if(b)throw new Error(b.message);if(vi(l)){const{message:y}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async t=>{if(!ar(t)){const{message:b}=Q("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(b)}const{topic:n,namespaces:o}=t;await this.isValidSessionTopic(n);const c=this.client.session.get(n),l=Va(o,"update()");if(l)throw new Error(l.message);const p=Bh(c.requiredNamespaces,o,"update()");if(p)throw new Error(p.message)},this.isValidExtend=async t=>{if(!ar(t)){const{message:o}=Q("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:n}=t;await this.isValidSessionTopic(n)},this.isValidRequest=async t=>{if(!ar(t)){const{message:b}=Q("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(b)}const{topic:n,request:o,chainId:c,expiry:l}=t;await this.isValidSessionTopic(n);const{namespaces:p}=this.client.session.get(n);if(!Hh(p,c)){const{message:b}=Q("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(b)}if(!X_(o)){const{message:b}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(b)}if(!Z_(p,c,o.method)){const{message:b}=Q("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(b)}if(l&&!Q_(l,rc)){const{message:b}=Q("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${rc.min} and ${rc.max}`);throw new Error(b)}},this.isValidRespond=async t=>{if(!ar(t)){const{message:c}=Q("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:n,response:o}=t;if(await this.isValidSessionTopic(n),!e1(o)){const{message:c}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!ar(t)){const{message:o}=Q("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async t=>{if(!ar(t)){const{message:p}=Q("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(p)}const{topic:n,event:o,chainId:c}=t;await this.isValidSessionTopic(n);const{namespaces:l}=this.client.session.get(n);if(!Hh(l,c)){const{message:p}=Q("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(p)}if(!t1(o)){const{message:p}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}if(!r1(l,c,o.name)){const{message:p}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}},this.isValidDisconnect=async t=>{if(!ar(t)){const{message:o}=Q("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(t,n)=>{const o={verified:{verifyUrl:n.verifyUrl||"",validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:n.verifyUrl});c&&(o.verified.origin=c,o.verified.validation=c===n.url?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,n)=>{Object.values(t).forEach(o=>{if(!cn(o,!1)){const{message:c}=Q("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.client.core.relayer.on(vt.message,async r=>{const{topic:t,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(t,n);Fc(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):_o(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async r=>{const{topic:t,id:n}=Xl(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Q("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(r){if(!cn(r,!1)){const{message:t}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:t}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(t)}if(vi(this.client.core.pairing.pairings.get(r).expiry)){const{message:t}=Q("EXPIRED",`pairing topic: ${r}`);throw new Error(t)}}async isValidSessionTopic(r){if(!cn(r,!1)){const{message:t}=Q("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(t)}if(!this.client.session.keys.includes(r)){const{message:t}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(t)}if(vi(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:t}=Q("EXPIRED",`session topic: ${r}`);throw new Error(t)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(cn(r,!1)){const{message:t}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(t)}else{const{message:t}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(t)}}async isValidProposalId(r){if(!i1(r)){const{message:t}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(t)}if(!this.client.proposal.keys.includes(r)){const{message:t}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(t)}if(vi(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:t}=Q("EXPIRED",`proposal id: ${r}`);throw new Error(t)}}}class Tx extends bo{constructor(r,t){super(r,t,mx,Mc),this.core=r,this.logger=t}}class Rx extends bo{constructor(r,t){super(r,t,bx,Mc),this.core=r,this.logger=t}}class $x extends bo{constructor(r,t){super(r,t,Ex,Mc,n=>n.id),this.core=r,this.logger=t}}let Nx=class Uf extends qm{constructor(r){super(r),this.protocol=Lf,this.version=Mf,this.name=tc.name,this.events=new Or.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(r==null?void 0:r.name)||tc.name,this.metadata=(r==null?void 0:r.metadata)||B_();const t=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Te.pino(Te.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||tc.logger}));this.core=(r==null?void 0:r.core)||new vx(r),this.logger=Te.generateChildLogger(t,this.name),this.session=new Rx(this.core,this.logger),this.proposal=new Tx(this.core,this.logger),this.pendingRequest=new $x(this.core,this.logger),this.engine=new Cx(this)}static async init(r){const t=new Uf(r);return await t.initialize(),t}get context(){return Te.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var xc={exports:{}};(function(a,r){var t=typeof self<"u"?self:cr,n=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(l){var p={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function b(_){return _&&DataView.prototype.isPrototypeOf(_)}if(p.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],O=ArrayBuffer.isView||function(_){return _&&y.indexOf(Object.prototype.toString.call(_))>-1};function q(_){if(typeof _!="string"&&(_=String(_)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(_))throw new TypeError("Invalid character in header field name");return _.toLowerCase()}function C(_){return typeof _!="string"&&(_=String(_)),_}function z(_){var x={next:function(){var X=_.shift();return{done:X===void 0,value:X}}};return p.iterable&&(x[Symbol.iterator]=function(){return x}),x}function F(_){this.map={},_ instanceof F?_.forEach(function(x,X){this.append(X,x)},this):Array.isArray(_)?_.forEach(function(x){this.append(x[0],x[1])},this):_&&Object.getOwnPropertyNames(_).forEach(function(x){this.append(x,_[x])},this)}F.prototype.append=function(_,x){_=q(_),x=C(x);var X=this.map[_];this.map[_]=X?X+", "+x:x},F.prototype.delete=function(_){delete this.map[q(_)]},F.prototype.get=function(_){return _=q(_),this.has(_)?this.map[_]:null},F.prototype.has=function(_){return this.map.hasOwnProperty(q(_))},F.prototype.set=function(_,x){this.map[q(_)]=C(x)},F.prototype.forEach=function(_,x){for(var X in this.map)this.map.hasOwnProperty(X)&&_.call(x,this.map[X],X,this)},F.prototype.keys=function(){var _=[];return this.forEach(function(x,X){_.push(X)}),z(_)},F.prototype.values=function(){var _=[];return this.forEach(function(x){_.push(x)}),z(_)},F.prototype.entries=function(){var _=[];return this.forEach(function(x,X){_.push([X,x])}),z(_)},p.iterable&&(F.prototype[Symbol.iterator]=F.prototype.entries);function K(_){if(_.bodyUsed)return Promise.reject(new TypeError("Already read"));_.bodyUsed=!0}function ie(_){return new Promise(function(x,X){_.onload=function(){x(_.result)},_.onerror=function(){X(_.error)}})}function Ee(_){var x=new FileReader,X=ie(x);return x.readAsArrayBuffer(_),X}function ge(_){var x=new FileReader,X=ie(x);return x.readAsText(_),X}function pe(_){for(var x=new Uint8Array(_),X=new Array(x.length),ce=0;ce<x.length;ce++)X[ce]=String.fromCharCode(x[ce]);return X.join("")}function he(_){if(_.slice)return _.slice(0);var x=new Uint8Array(_.byteLength);return x.set(new Uint8Array(_)),x.buffer}function le(){return this.bodyUsed=!1,this._initBody=function(_){this._bodyInit=_,_?typeof _=="string"?this._bodyText=_:p.blob&&Blob.prototype.isPrototypeOf(_)?this._bodyBlob=_:p.formData&&FormData.prototype.isPrototypeOf(_)?this._bodyFormData=_:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)?this._bodyText=_.toString():p.arrayBuffer&&p.blob&&b(_)?(this._bodyArrayBuffer=he(_.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(_)||O(_))?this._bodyArrayBuffer=he(_):this._bodyText=_=Object.prototype.toString.call(_):this._bodyText="",this.headers.get("content-type")||(typeof _=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var _=K(this);if(_)return _;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?K(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Ee)}),this.text=function(){var _=K(this);if(_)return _;if(this._bodyBlob)return ge(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(pe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(ye)}),this.json=function(){return this.text().then(JSON.parse)},this}var N=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function U(_){var x=_.toUpperCase();return N.indexOf(x)>-1?x:_}function W(_,x){x=x||{};var X=x.body;if(_ instanceof W){if(_.bodyUsed)throw new TypeError("Already read");this.url=_.url,this.credentials=_.credentials,x.headers||(this.headers=new F(_.headers)),this.method=_.method,this.mode=_.mode,this.signal=_.signal,!X&&_._bodyInit!=null&&(X=_._bodyInit,_.bodyUsed=!0)}else this.url=String(_);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new F(x.headers)),this.method=U(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ye(_){var x=new FormData;return _.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),V=ce.shift().replace(/\+/g," "),B=ce.join("=").replace(/\+/g," ");x.append(decodeURIComponent(V),decodeURIComponent(B))}}),x}function re(_){var x=new F,X=_.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var V=ce.split(":"),B=V.shift().trim();if(B){var k=V.join(":").trim();x.append(B,k)}}),x}le.call(W.prototype);function ue(_,x){x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in x?x.statusText:"OK",this.headers=new F(x.headers),this.url=x.url||"",this._initBody(_)}le.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new F(this.headers),url:this.url})},ue.error=function(){var _=new ue(null,{status:0,statusText:""});return _.type="error",_};var Re=[301,302,303,307,308];ue.redirect=function(_,x){if(Re.indexOf(x)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:x,headers:{location:_}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(x,X){this.message=x,this.name=X;var ce=Error(x);this.stack=ce.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function ze(_,x){return new Promise(function(X,ce){var V=new W(_,x);if(V.signal&&V.signal.aborted)return ce(new l.DOMException("Aborted","AbortError"));var B=new XMLHttpRequest;function k(){B.abort()}B.onload=function(){var G={status:B.status,statusText:B.statusText,headers:re(B.getAllResponseHeaders()||"")};G.url="responseURL"in B?B.responseURL:G.headers.get("X-Request-URL");var Je="response"in B?B.response:B.responseText;X(new ue(Je,G))},B.onerror=function(){ce(new TypeError("Network request failed"))},B.ontimeout=function(){ce(new TypeError("Network request failed"))},B.onabort=function(){ce(new l.DOMException("Aborted","AbortError"))},B.open(V.method,V.url,!0),V.credentials==="include"?B.withCredentials=!0:V.credentials==="omit"&&(B.withCredentials=!1),"responseType"in B&&p.blob&&(B.responseType="blob"),V.headers.forEach(function(G,Je){B.setRequestHeader(Je,G)}),V.signal&&(V.signal.addEventListener("abort",k),B.onreadystatechange=function(){B.readyState===4&&V.signal.removeEventListener("abort",k)}),B.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return ze.polyfill=!0,c.fetch||(c.fetch=ze,c.Headers=F,c.Request=W,c.Response=ue),l.Headers=F,l.Request=W,l.Response=ue,l.fetch=ze,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;r=o.fetch,r.default=o.fetch,r.fetch=o.fetch,r.Headers=o.Headers,r.Request=o.Request,r.Response=o.Response,a.exports=r})(xc,xc.exports);var Dx=xc.exports;const Dl=Jl(Dx),Fx={Accept:"application/json","Content-Type":"application/json"},jx="POST",Fl={headers:Fx,method:jx},jl=10;class qi{constructor(r,t=!1){if(this.url=r,this.disableProviderPing=t,this.events=new Or.EventEmitter,this.isAvailable=!1,this.registering=!1,!ul(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,t){this.isAvailable||await this.register();try{const n=Gn(r),c=await(await Dl(this.url,Object.assign(Object.assign({},Fl),{body:n}))).json();this.onPayload({data:c})}catch(n){this.onError(r.id,n)}}async register(r=this.url){if(!ul(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const t=Gn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Dl(r,Object.assign(Object.assign({},Fl),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?Tc(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),o=n.message||n.toString(),c=vo(r,o);this.events.emit("payload",c)}parseError(r,t=this.url){return vf(r,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>jl&&this.events.setMaxListeners(jl)}}const Ll="error",Lx="wss://relay.walletconnect.com",Mx="wc",qx="universal_provider",Ml=`${Mx}@2:${qx}:`,zx="https://rpc.walletconnect.com/v1",wi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Un=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ic={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,r){(function(){var t,n="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",p="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",y=500,O="__lodash_placeholder__",q=1,C=2,z=4,F=1,K=2,ie=1,Ee=2,ge=4,pe=8,he=16,le=32,N=64,U=128,W=256,ye=512,re=30,ue="...",Re=800,ze=16,_=1,x=2,X=3,ce=1/0,V=9007199254740991,B=17976931348623157e292,k=0/0,G=4294967295,Je=G-1,He=G>>>1,jr=[["ary",U],["bind",ie],["bindKey",Ee],["curry",pe],["curryRight",he],["flip",ye],["partial",le],["partialRight",N],["rearg",W]],xe="[object Arguments]",It="[object Array]",$="[object AsyncFunction]",R="[object Boolean]",A="[object Date]",h="[object DOMException]",E="[object Error]",ee="[object Function]",fe="[object GeneratorFunction]",be="[object Map]",$e="[object Number]",De="[object Null]",Pe="[object Object]",St="[object Promise]",_t="[object Proxy]",st="[object RegExp]",je="[object Set]",Xe="[object String]",Ze="[object Symbol]",ot="[object Undefined]",Ue="[object WeakMap]",Qe="[object WeakSet]",Ne="[object ArrayBuffer]",ke="[object DataView]",ut="[object Float32Array]",Me="[object Float64Array]",Pt="[object Int8Array]",Ft="[object Int16Array]",Ut="[object Int32Array]",Bt="[object Uint8Array]",Mt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",tr="[object Uint32Array]",Lr=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,oi=/&(?:amp|lt|gt|quot|#39);/g,Ei=/[&<>"']/g,ht=RegExp(oi.source),rt=RegExp(Ei.source),lt=/<%-([\s\S]+?)%>/g,ft=/<%([\s\S]+?)%>/g,at=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ot=/^\w*$/,At=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pt=/[\\^$.*+?()[\]{}|]/g,Ct=RegExp(pt.source),dt=/^\s+/,mt=/\s/,gt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Rt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,wo=/[()=,{}\[\]\/\s]/,Eo=/\\(\\)?/g,xo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,gr=/\w*$/,Io=/^[-+]0x[0-9a-f]+$/i,So=/^0b[01]+$/i,Po=/^\[object .+?Constructor\]$/,Oo=/^0o[0-7]+$/i,Ao=/^(?:0|[1-9]\d*)$/,Kr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,zi=/($^)/,Co=/['\n\r\u2028\u2029\\]/g,Ui="\\ud800-\\udfff",To="\\u0300-\\u036f",Ro="\\ufe20-\\ufe2f",Bi="\\u20d0-\\u20ff",Zn=To+Ro+Bi,Qn="\\u2700-\\u27bf",Ar="a-z\\xdf-\\xf6\\xf8-\\xff",$o="\\xac\\xb1\\xd7\\xf7",No="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Do="\\u2000-\\u206f",Fo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",es="A-Z\\xc0-\\xd6\\xd8-\\xde",ts="\\ufe0e\\ufe0f",xi=$o+No+Do+Fo,pn="['’]",Ii="["+Ui+"]",dn="["+xi+"]",Si="["+Zn+"]",rs="\\d+",jo="["+Qn+"]",is="["+Ar+"]",ns="[^"+Ui+xi+rs+Qn+Ar+es+"]",Hi="\\ud83c[\\udffb-\\udfff]",Lo="(?:"+Si+"|"+Hi+")",ss="[^"+Ui+"]",ki="(?:\\ud83c[\\udde6-\\uddff]){2}",ai="[\\ud800-\\udbff][\\udc00-\\udfff]",ur="["+es+"]",os="\\u200d",as="(?:"+is+"|"+ns+")",Mr="(?:"+ur+"|"+ns+")",cs="(?:"+pn+"(?:d|ll|m|re|s|t|ve))?",us="(?:"+pn+"(?:D|LL|M|RE|S|T|VE))?",hs=Lo+"?",ls="["+ts+"]?",Mo="(?:"+os+"(?:"+[ss,ki,ai].join("|")+")"+ls+hs+")*",Gr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",fs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ps=ls+hs+Mo,Vi="(?:"+[jo,ki,ai].join("|")+")"+ps,qo="(?:"+[ss+Si+"?",Si,ki,ai,Ii].join("|")+")",gn=RegExp(pn,"g"),zo=RegExp(Si,"g"),Ki=RegExp(Hi+"(?="+Hi+")|"+qo+ps,"g"),ds=RegExp([ur+"?"+is+"+"+cs+"(?="+[dn,ur,"$"].join("|")+")",Mr+"+"+us+"(?="+[dn,ur+as,"$"].join("|")+")",ur+"?"+as+"+"+cs,ur+"+"+us,fs,Gr,rs,Vi].join("|"),"g"),gs=RegExp("["+os+Ui+Zn+ts+"]"),Pi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ys=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Uo=-1,Ve={};Ve[ut]=Ve[Me]=Ve[Pt]=Ve[Ft]=Ve[Ut]=Ve[Bt]=Ve[Mt]=Ve[Gt]=Ve[tr]=!0,Ve[xe]=Ve[It]=Ve[Ne]=Ve[R]=Ve[ke]=Ve[A]=Ve[E]=Ve[ee]=Ve[be]=Ve[$e]=Ve[Pe]=Ve[st]=Ve[je]=Ve[Xe]=Ve[Ue]=!1;var Be={};Be[xe]=Be[It]=Be[Ne]=Be[ke]=Be[R]=Be[A]=Be[ut]=Be[Me]=Be[Pt]=Be[Ft]=Be[Ut]=Be[be]=Be[$e]=Be[Pe]=Be[st]=Be[je]=Be[Xe]=Be[Ze]=Be[Bt]=Be[Mt]=Be[Gt]=Be[tr]=!0,Be[E]=Be[ee]=Be[Ue]=!1;var v={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},M={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ke=parseFloat,ve=parseInt,et=typeof Un=="object"&&Un&&Un.Object===Object&&Un,$t=typeof self=="object"&&self&&self.Object===Object&&self,Ae=et||$t||Function("return this")(),Ge=r&&!r.nodeType&&r,bt=Ge&&!0&&a&&!a.nodeType&&a,rr=bt&&bt.exports===Ge,Nt=rr&&et.process,tt=function(){try{var S=bt&&bt.require&&bt.require("util").types;return S||Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Jt=tt&&tt.isArrayBuffer,Cr=tt&&tt.isDate,yr=tt&&tt.isMap,qr=tt&&tt.isRegExp,yn=tt&&tt.isSet,Oi=tt&&tt.isTypedArray;function qt(S,D,T){switch(T.length){case 0:return S.call(D);case 1:return S.call(D,T[0]);case 2:return S.call(D,T[0],T[1]);case 3:return S.call(D,T[0],T[1],T[2])}return S.apply(D,T)}function kf(S,D,T,Z){for(var de=-1,Fe=S==null?0:S.length;++de<Fe;){var jt=S[de];D(Z,jt,T(jt),S)}return Z}function vr(S,D){for(var T=-1,Z=S==null?0:S.length;++T<Z&&D(S[T],T,S)!==!1;);return S}function Vf(S,D){for(var T=S==null?0:S.length;T--&&D(S[T],T,S)!==!1;);return S}function Uc(S,D){for(var T=-1,Z=S==null?0:S.length;++T<Z;)if(!D(S[T],T,S))return!1;return!0}function ci(S,D){for(var T=-1,Z=S==null?0:S.length,de=0,Fe=[];++T<Z;){var jt=S[T];D(jt,T,S)&&(Fe[de++]=jt)}return Fe}function vs(S,D){var T=S==null?0:S.length;return!!T&&Gi(S,D,0)>-1}function Bo(S,D,T){for(var Z=-1,de=S==null?0:S.length;++Z<de;)if(T(D,S[Z]))return!0;return!1}function nt(S,D){for(var T=-1,Z=S==null?0:S.length,de=Array(Z);++T<Z;)de[T]=D(S[T],T,S);return de}function ui(S,D){for(var T=-1,Z=D.length,de=S.length;++T<Z;)S[de+T]=D[T];return S}function Ho(S,D,T,Z){var de=-1,Fe=S==null?0:S.length;for(Z&&Fe&&(T=S[++de]);++de<Fe;)T=D(T,S[de],de,S);return T}function Kf(S,D,T,Z){var de=S==null?0:S.length;for(Z&&de&&(T=S[--de]);de--;)T=D(T,S[de],de,S);return T}function ko(S,D){for(var T=-1,Z=S==null?0:S.length;++T<Z;)if(D(S[T],T,S))return!0;return!1}var Gf=Vo("length");function Wf(S){return S.split("")}function Jf(S){return S.match(Rt)||[]}function Bc(S,D,T){var Z;return T(S,function(de,Fe,jt){if(D(de,Fe,jt))return Z=Fe,!1}),Z}function _s(S,D,T,Z){for(var de=S.length,Fe=T+(Z?1:-1);Z?Fe--:++Fe<de;)if(D(S[Fe],Fe,S))return Fe;return-1}function Gi(S,D,T){return D===D?ap(S,D,T):_s(S,Hc,T)}function Yf(S,D,T,Z){for(var de=T-1,Fe=S.length;++de<Fe;)if(Z(S[de],D))return de;return-1}function Hc(S){return S!==S}function kc(S,D){var T=S==null?0:S.length;return T?Go(S,D)/T:k}function Vo(S){return function(D){return D==null?t:D[S]}}function Ko(S){return function(D){return S==null?t:S[D]}}function Vc(S,D,T,Z,de){return de(S,function(Fe,jt,We){T=Z?(Z=!1,Fe):D(T,Fe,jt,We)}),T}function Xf(S,D){var T=S.length;for(S.sort(D);T--;)S[T]=S[T].value;return S}function Go(S,D){for(var T,Z=-1,de=S.length;++Z<de;){var Fe=D(S[Z]);Fe!==t&&(T=T===t?Fe:T+Fe)}return T}function Wo(S,D){for(var T=-1,Z=Array(S);++T<S;)Z[T]=D(T);return Z}function Zf(S,D){return nt(D,function(T){return[T,S[T]]})}function Kc(S){return S&&S.slice(0,Yc(S)+1).replace(dt,"")}function hr(S){return function(D){return S(D)}}function Jo(S,D){return nt(D,function(T){return S[T]})}function vn(S,D){return S.has(D)}function Gc(S,D){for(var T=-1,Z=S.length;++T<Z&&Gi(D,S[T],0)>-1;);return T}function Wc(S,D){for(var T=S.length;T--&&Gi(D,S[T],0)>-1;);return T}function Qf(S,D){for(var T=S.length,Z=0;T--;)S[T]===D&&++Z;return Z}var ep=Ko(v),tp=Ko(I);function rp(S){return"\\"+Y[S]}function ip(S,D){return S==null?t:S[D]}function Wi(S){return gs.test(S)}function np(S){return Pi.test(S)}function sp(S){for(var D,T=[];!(D=S.next()).done;)T.push(D.value);return T}function Yo(S){var D=-1,T=Array(S.size);return S.forEach(function(Z,de){T[++D]=[de,Z]}),T}function Jc(S,D){return function(T){return S(D(T))}}function hi(S,D){for(var T=-1,Z=S.length,de=0,Fe=[];++T<Z;){var jt=S[T];(jt===D||jt===O)&&(S[T]=O,Fe[de++]=T)}return Fe}function ms(S){var D=-1,T=Array(S.size);return S.forEach(function(Z){T[++D]=Z}),T}function op(S){var D=-1,T=Array(S.size);return S.forEach(function(Z){T[++D]=[Z,Z]}),T}function ap(S,D,T){for(var Z=T-1,de=S.length;++Z<de;)if(S[Z]===D)return Z;return-1}function cp(S,D,T){for(var Z=T+1;Z--;)if(S[Z]===D)return Z;return Z}function Ji(S){return Wi(S)?hp(S):Gf(S)}function Tr(S){return Wi(S)?lp(S):Wf(S)}function Yc(S){for(var D=S.length;D--&&mt.test(S.charAt(D)););return D}var up=Ko(M);function hp(S){for(var D=Ki.lastIndex=0;Ki.test(S);)++D;return D}function lp(S){return S.match(Ki)||[]}function fp(S){return S.match(ds)||[]}var pp=function S(D){D=D==null?Ae:Yi.defaults(Ae.Object(),D,Yi.pick(Ae,ys));var T=D.Array,Z=D.Date,de=D.Error,Fe=D.Function,jt=D.Math,We=D.Object,Xo=D.RegExp,dp=D.String,_r=D.TypeError,bs=T.prototype,gp=Fe.prototype,Xi=We.prototype,ws=D["__core-js_shared__"],Es=gp.toString,qe=Xi.hasOwnProperty,yp=0,Xc=function(){var e=/[^.]+$/.exec(ws&&ws.keys&&ws.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),xs=Xi.toString,vp=Es.call(We),_p=Ae._,mp=Xo("^"+Es.call(qe).replace(pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Is=rr?D.Buffer:t,li=D.Symbol,Ss=D.Uint8Array,Zc=Is?Is.allocUnsafe:t,Ps=Jc(We.getPrototypeOf,We),Qc=We.create,eu=Xi.propertyIsEnumerable,Os=bs.splice,tu=li?li.isConcatSpreadable:t,_n=li?li.iterator:t,Ai=li?li.toStringTag:t,As=function(){try{var e=Ni(We,"defineProperty");return e({},"",{}),e}catch{}}(),bp=D.clearTimeout!==Ae.clearTimeout&&D.clearTimeout,wp=Z&&Z.now!==Ae.Date.now&&Z.now,Ep=D.setTimeout!==Ae.setTimeout&&D.setTimeout,Cs=jt.ceil,Ts=jt.floor,Zo=We.getOwnPropertySymbols,xp=Is?Is.isBuffer:t,ru=D.isFinite,Ip=bs.join,Sp=Jc(We.keys,We),Lt=jt.max,Vt=jt.min,Pp=Z.now,Op=D.parseInt,iu=jt.random,Ap=bs.reverse,Qo=Ni(D,"DataView"),mn=Ni(D,"Map"),ea=Ni(D,"Promise"),Zi=Ni(D,"Set"),bn=Ni(D,"WeakMap"),wn=Ni(We,"create"),Rs=bn&&new bn,Qi={},Cp=Di(Qo),Tp=Di(mn),Rp=Di(ea),$p=Di(Zi),Np=Di(bn),$s=li?li.prototype:t,En=$s?$s.valueOf:t,nu=$s?$s.toString:t;function d(e){if(yt(e)&&!_e(e)&&!(e instanceof Oe)){if(e instanceof mr)return e;if(qe.call(e,"__wrapped__"))return sh(e)}return new mr(e)}var en=function(){function e(){}return function(i){if(!ct(i))return{};if(Qc)return Qc(i);e.prototype=i;var s=new e;return e.prototype=t,s}}();function Ns(){}function mr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}d.templateSettings={escape:lt,evaluate:ft,interpolate:at,variable:"",imports:{_:d}},d.prototype=Ns.prototype,d.prototype.constructor=d,mr.prototype=en(Ns.prototype),mr.prototype.constructor=mr;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function Dp(){var e=new Oe(this.__wrapped__);return e.__actions__=ir(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ir(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ir(this.__views__),e}function Fp(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function jp(){var e=this.__wrapped__.value(),i=this.__dir__,s=_e(e),u=i<0,f=s?e.length:0,g=Wd(0,f,this.__views__),m=g.start,w=g.end,P=w-m,j=u?w:m-1,L=this.__iteratees__,H=L.length,J=0,te=Vt(P,this.__takeCount__);if(!s||!u&&f==P&&te==P)return Au(e,this.__actions__);var oe=[];e:for(;P--&&J<te;){j+=i;for(var we=-1,ae=e[j];++we<H;){var Se=L[we],Ce=Se.iteratee,pr=Se.type,Zt=Ce(ae);if(pr==x)ae=Zt;else if(!Zt){if(pr==_)continue e;break e}}oe[J++]=ae}return oe}Oe.prototype=en(Ns.prototype),Oe.prototype.constructor=Oe;function Ci(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function Lp(){this.__data__=wn?wn(null):{},this.size=0}function Mp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function qp(e){var i=this.__data__;if(wn){var s=i[e];return s===b?t:s}return qe.call(i,e)?i[e]:t}function zp(e){var i=this.__data__;return wn?i[e]!==t:qe.call(i,e)}function Up(e,i){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=wn&&i===t?b:i,this}Ci.prototype.clear=Lp,Ci.prototype.delete=Mp,Ci.prototype.get=qp,Ci.prototype.has=zp,Ci.prototype.set=Up;function Wr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function Bp(){this.__data__=[],this.size=0}function Hp(e){var i=this.__data__,s=Ds(i,e);if(s<0)return!1;var u=i.length-1;return s==u?i.pop():Os.call(i,s,1),--this.size,!0}function kp(e){var i=this.__data__,s=Ds(i,e);return s<0?t:i[s][1]}function Vp(e){return Ds(this.__data__,e)>-1}function Kp(e,i){var s=this.__data__,u=Ds(s,e);return u<0?(++this.size,s.push([e,i])):s[u][1]=i,this}Wr.prototype.clear=Bp,Wr.prototype.delete=Hp,Wr.prototype.get=kp,Wr.prototype.has=Vp,Wr.prototype.set=Kp;function Jr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function Gp(){this.size=0,this.__data__={hash:new Ci,map:new(mn||Wr),string:new Ci}}function Wp(e){var i=Ks(this,e).delete(e);return this.size-=i?1:0,i}function Jp(e){return Ks(this,e).get(e)}function Yp(e){return Ks(this,e).has(e)}function Xp(e,i){var s=Ks(this,e),u=s.size;return s.set(e,i),this.size+=s.size==u?0:1,this}Jr.prototype.clear=Gp,Jr.prototype.delete=Wp,Jr.prototype.get=Jp,Jr.prototype.has=Yp,Jr.prototype.set=Xp;function Ti(e){var i=-1,s=e==null?0:e.length;for(this.__data__=new Jr;++i<s;)this.add(e[i])}function Zp(e){return this.__data__.set(e,b),this}function Qp(e){return this.__data__.has(e)}Ti.prototype.add=Ti.prototype.push=Zp,Ti.prototype.has=Qp;function Rr(e){var i=this.__data__=new Wr(e);this.size=i.size}function ed(){this.__data__=new Wr,this.size=0}function td(e){var i=this.__data__,s=i.delete(e);return this.size=i.size,s}function rd(e){return this.__data__.get(e)}function id(e){return this.__data__.has(e)}function nd(e,i){var s=this.__data__;if(s instanceof Wr){var u=s.__data__;if(!mn||u.length<o-1)return u.push([e,i]),this.size=++s.size,this;s=this.__data__=new Jr(u)}return s.set(e,i),this.size=s.size,this}Rr.prototype.clear=ed,Rr.prototype.delete=td,Rr.prototype.get=rd,Rr.prototype.has=id,Rr.prototype.set=nd;function su(e,i){var s=_e(e),u=!s&&Fi(e),f=!s&&!u&&yi(e),g=!s&&!u&&!f&&sn(e),m=s||u||f||g,w=m?Wo(e.length,dp):[],P=w.length;for(var j in e)(i||qe.call(e,j))&&!(m&&(j=="length"||f&&(j=="offset"||j=="parent")||g&&(j=="buffer"||j=="byteLength"||j=="byteOffset")||Qr(j,P)))&&w.push(j);return w}function ou(e){var i=e.length;return i?e[la(0,i-1)]:t}function sd(e,i){return Gs(ir(e),Ri(i,0,e.length))}function od(e){return Gs(ir(e))}function ta(e,i,s){(s!==t&&!$r(e[i],s)||s===t&&!(i in e))&&Yr(e,i,s)}function xn(e,i,s){var u=e[i];(!(qe.call(e,i)&&$r(u,s))||s===t&&!(i in e))&&Yr(e,i,s)}function Ds(e,i){for(var s=e.length;s--;)if($r(e[s][0],i))return s;return-1}function ad(e,i,s,u){return fi(e,function(f,g,m){i(u,f,s(f),m)}),u}function au(e,i){return e&&Ur(i,zt(i),e)}function cd(e,i){return e&&Ur(i,sr(i),e)}function Yr(e,i,s){i=="__proto__"&&As?As(e,i,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[i]=s}function ra(e,i){for(var s=-1,u=i.length,f=T(u),g=e==null;++s<u;)f[s]=g?t:ja(e,i[s]);return f}function Ri(e,i,s){return e===e&&(s!==t&&(e=e<=s?e:s),i!==t&&(e=e>=i?e:i)),e}function br(e,i,s,u,f,g){var m,w=i&q,P=i&C,j=i&z;if(s&&(m=f?s(e,u,f,g):s(e)),m!==t)return m;if(!ct(e))return e;var L=_e(e);if(L){if(m=Yd(e),!w)return ir(e,m)}else{var H=Kt(e),J=H==ee||H==fe;if(yi(e))return Ru(e,w);if(H==Pe||H==xe||J&&!f){if(m=P||J?{}:Yu(e),!w)return P?qd(e,cd(m,e)):Md(e,au(m,e))}else{if(!Be[H])return f?e:{};m=Xd(e,H,w)}}g||(g=new Rr);var te=g.get(e);if(te)return te;g.set(e,m),Sh(e)?e.forEach(function(ae){m.add(br(ae,i,s,ae,e,g))}):xh(e)&&e.forEach(function(ae,Se){m.set(Se,br(ae,i,s,Se,e,g))});var oe=j?P?Ea:wa:P?sr:zt,we=L?t:oe(e);return vr(we||e,function(ae,Se){we&&(Se=ae,ae=e[Se]),xn(m,Se,br(ae,i,s,Se,e,g))}),m}function ud(e){var i=zt(e);return function(s){return cu(s,e,i)}}function cu(e,i,s){var u=s.length;if(e==null)return!u;for(e=We(e);u--;){var f=s[u],g=i[f],m=e[f];if(m===t&&!(f in e)||!g(m))return!1}return!0}function uu(e,i,s){if(typeof e!="function")throw new _r(l);return Tn(function(){e.apply(t,s)},i)}function In(e,i,s,u){var f=-1,g=vs,m=!0,w=e.length,P=[],j=i.length;if(!w)return P;s&&(i=nt(i,hr(s))),u?(g=Bo,m=!1):i.length>=o&&(g=vn,m=!1,i=new Ti(i));e:for(;++f<w;){var L=e[f],H=s==null?L:s(L);if(L=u||L!==0?L:0,m&&H===H){for(var J=j;J--;)if(i[J]===H)continue e;P.push(L)}else g(i,H,u)||P.push(L)}return P}var fi=ju(zr),hu=ju(na,!0);function hd(e,i){var s=!0;return fi(e,function(u,f,g){return s=!!i(u,f,g),s}),s}function Fs(e,i,s){for(var u=-1,f=e.length;++u<f;){var g=e[u],m=i(g);if(m!=null&&(w===t?m===m&&!fr(m):s(m,w)))var w=m,P=g}return P}function ld(e,i,s,u){var f=e.length;for(s=me(s),s<0&&(s=-s>f?0:f+s),u=u===t||u>f?f:me(u),u<0&&(u+=f),u=s>u?0:Oh(u);s<u;)e[s++]=i;return e}function lu(e,i){var s=[];return fi(e,function(u,f,g){i(u,f,g)&&s.push(u)}),s}function Ht(e,i,s,u,f){var g=-1,m=e.length;for(s||(s=Qd),f||(f=[]);++g<m;){var w=e[g];i>0&&s(w)?i>1?Ht(w,i-1,s,u,f):ui(f,w):u||(f[f.length]=w)}return f}var ia=Lu(),fu=Lu(!0);function zr(e,i){return e&&ia(e,i,zt)}function na(e,i){return e&&fu(e,i,zt)}function js(e,i){return ci(i,function(s){return ei(e[s])})}function $i(e,i){i=di(i,e);for(var s=0,u=i.length;e!=null&&s<u;)e=e[Br(i[s++])];return s&&s==u?e:t}function pu(e,i,s){var u=i(e);return _e(e)?u:ui(u,s(e))}function Yt(e){return e==null?e===t?ot:De:Ai&&Ai in We(e)?Gd(e):og(e)}function sa(e,i){return e>i}function fd(e,i){return e!=null&&qe.call(e,i)}function pd(e,i){return e!=null&&i in We(e)}function dd(e,i,s){return e>=Vt(i,s)&&e<Lt(i,s)}function oa(e,i,s){for(var u=s?Bo:vs,f=e[0].length,g=e.length,m=g,w=T(g),P=1/0,j=[];m--;){var L=e[m];m&&i&&(L=nt(L,hr(i))),P=Vt(L.length,P),w[m]=!s&&(i||f>=120&&L.length>=120)?new Ti(m&&L):t}L=e[0];var H=-1,J=w[0];e:for(;++H<f&&j.length<P;){var te=L[H],oe=i?i(te):te;if(te=s||te!==0?te:0,!(J?vn(J,oe):u(j,oe,s))){for(m=g;--m;){var we=w[m];if(!(we?vn(we,oe):u(e[m],oe,s)))continue e}J&&J.push(oe),j.push(te)}}return j}function gd(e,i,s,u){return zr(e,function(f,g,m){i(u,s(f),g,m)}),u}function Sn(e,i,s){i=di(i,e),e=eh(e,i);var u=e==null?e:e[Br(Er(i))];return u==null?t:qt(u,e,s)}function du(e){return yt(e)&&Yt(e)==xe}function yd(e){return yt(e)&&Yt(e)==Ne}function vd(e){return yt(e)&&Yt(e)==A}function Pn(e,i,s,u,f){return e===i?!0:e==null||i==null||!yt(e)&&!yt(i)?e!==e&&i!==i:_d(e,i,s,u,Pn,f)}function _d(e,i,s,u,f,g){var m=_e(e),w=_e(i),P=m?It:Kt(e),j=w?It:Kt(i);P=P==xe?Pe:P,j=j==xe?Pe:j;var L=P==Pe,H=j==Pe,J=P==j;if(J&&yi(e)){if(!yi(i))return!1;m=!0,L=!1}if(J&&!L)return g||(g=new Rr),m||sn(e)?Gu(e,i,s,u,f,g):Vd(e,i,P,s,u,f,g);if(!(s&F)){var te=L&&qe.call(e,"__wrapped__"),oe=H&&qe.call(i,"__wrapped__");if(te||oe){var we=te?e.value():e,ae=oe?i.value():i;return g||(g=new Rr),f(we,ae,s,u,g)}}return J?(g||(g=new Rr),Kd(e,i,s,u,f,g)):!1}function md(e){return yt(e)&&Kt(e)==be}function aa(e,i,s,u){var f=s.length,g=f,m=!u;if(e==null)return!g;for(e=We(e);f--;){var w=s[f];if(m&&w[2]?w[1]!==e[w[0]]:!(w[0]in e))return!1}for(;++f<g;){w=s[f];var P=w[0],j=e[P],L=w[1];if(m&&w[2]){if(j===t&&!(P in e))return!1}else{var H=new Rr;if(u)var J=u(j,L,P,e,i,H);if(!(J===t?Pn(L,j,F|K,u,H):J))return!1}}return!0}function gu(e){if(!ct(e)||tg(e))return!1;var i=ei(e)?mp:Po;return i.test(Di(e))}function bd(e){return yt(e)&&Yt(e)==st}function wd(e){return yt(e)&&Kt(e)==je}function Ed(e){return yt(e)&&Qs(e.length)&&!!Ve[Yt(e)]}function yu(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?_e(e)?mu(e[0],e[1]):_u(e):Mh(e)}function ca(e){if(!Cn(e))return Sp(e);var i=[];for(var s in We(e))qe.call(e,s)&&s!="constructor"&&i.push(s);return i}function xd(e){if(!ct(e))return sg(e);var i=Cn(e),s=[];for(var u in e)u=="constructor"&&(i||!qe.call(e,u))||s.push(u);return s}function ua(e,i){return e<i}function vu(e,i){var s=-1,u=nr(e)?T(e.length):[];return fi(e,function(f,g,m){u[++s]=i(f,g,m)}),u}function _u(e){var i=Ia(e);return i.length==1&&i[0][2]?Zu(i[0][0],i[0][1]):function(s){return s===e||aa(s,e,i)}}function mu(e,i){return Pa(e)&&Xu(i)?Zu(Br(e),i):function(s){var u=ja(s,e);return u===t&&u===i?La(s,e):Pn(i,u,F|K)}}function Ls(e,i,s,u,f){e!==i&&ia(i,function(g,m){if(f||(f=new Rr),ct(g))Id(e,i,m,s,Ls,u,f);else{var w=u?u(Aa(e,m),g,m+"",e,i,f):t;w===t&&(w=g),ta(e,m,w)}},sr)}function Id(e,i,s,u,f,g,m){var w=Aa(e,s),P=Aa(i,s),j=m.get(P);if(j){ta(e,s,j);return}var L=g?g(w,P,s+"",e,i,m):t,H=L===t;if(H){var J=_e(P),te=!J&&yi(P),oe=!J&&!te&&sn(P);L=P,J||te||oe?_e(w)?L=w:wt(w)?L=ir(w):te?(H=!1,L=Ru(P,!0)):oe?(H=!1,L=$u(P,!0)):L=[]:Rn(P)||Fi(P)?(L=w,Fi(w)?L=Ah(w):(!ct(w)||ei(w))&&(L=Yu(P))):H=!1}H&&(m.set(P,L),f(L,P,u,g,m),m.delete(P)),ta(e,s,L)}function bu(e,i){var s=e.length;if(s)return i+=i<0?s:0,Qr(i,s)?e[i]:t}function wu(e,i,s){i.length?i=nt(i,function(g){return _e(g)?function(m){return $i(m,g.length===1?g[0]:g)}:g}):i=[or];var u=-1;i=nt(i,hr(ne()));var f=vu(e,function(g,m,w){var P=nt(i,function(j){return j(g)});return{criteria:P,index:++u,value:g}});return Xf(f,function(g,m){return Ld(g,m,s)})}function Sd(e,i){return Eu(e,i,function(s,u){return La(e,u)})}function Eu(e,i,s){for(var u=-1,f=i.length,g={};++u<f;){var m=i[u],w=$i(e,m);s(w,m)&&On(g,di(m,e),w)}return g}function Pd(e){return function(i){return $i(i,e)}}function ha(e,i,s,u){var f=u?Yf:Gi,g=-1,m=i.length,w=e;for(e===i&&(i=ir(i)),s&&(w=nt(e,hr(s)));++g<m;)for(var P=0,j=i[g],L=s?s(j):j;(P=f(w,L,P,u))>-1;)w!==e&&Os.call(w,P,1),Os.call(e,P,1);return e}function xu(e,i){for(var s=e?i.length:0,u=s-1;s--;){var f=i[s];if(s==u||f!==g){var g=f;Qr(f)?Os.call(e,f,1):da(e,f)}}return e}function la(e,i){return e+Ts(iu()*(i-e+1))}function Od(e,i,s,u){for(var f=-1,g=Lt(Cs((i-e)/(s||1)),0),m=T(g);g--;)m[u?g:++f]=e,e+=s;return m}function fa(e,i){var s="";if(!e||i<1||i>V)return s;do i%2&&(s+=e),i=Ts(i/2),i&&(e+=e);while(i);return s}function Ie(e,i){return Ca(Qu(e,i,or),e+"")}function Ad(e){return ou(on(e))}function Cd(e,i){var s=on(e);return Gs(s,Ri(i,0,s.length))}function On(e,i,s,u){if(!ct(e))return e;i=di(i,e);for(var f=-1,g=i.length,m=g-1,w=e;w!=null&&++f<g;){var P=Br(i[f]),j=s;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(f!=m){var L=w[P];j=u?u(L,P,w):t,j===t&&(j=ct(L)?L:Qr(i[f+1])?[]:{})}xn(w,P,j),w=w[P]}return e}var Iu=Rs?function(e,i){return Rs.set(e,i),e}:or,Td=As?function(e,i){return As(e,"toString",{configurable:!0,enumerable:!1,value:qa(i),writable:!0})}:or;function Rd(e){return Gs(on(e))}function wr(e,i,s){var u=-1,f=e.length;i<0&&(i=-i>f?0:f+i),s=s>f?f:s,s<0&&(s+=f),f=i>s?0:s-i>>>0,i>>>=0;for(var g=T(f);++u<f;)g[u]=e[u+i];return g}function $d(e,i){var s;return fi(e,function(u,f,g){return s=i(u,f,g),!s}),!!s}function Ms(e,i,s){var u=0,f=e==null?u:e.length;if(typeof i=="number"&&i===i&&f<=He){for(;u<f;){var g=u+f>>>1,m=e[g];m!==null&&!fr(m)&&(s?m<=i:m<i)?u=g+1:f=g}return f}return pa(e,i,or,s)}function pa(e,i,s,u){var f=0,g=e==null?0:e.length;if(g===0)return 0;i=s(i);for(var m=i!==i,w=i===null,P=fr(i),j=i===t;f<g;){var L=Ts((f+g)/2),H=s(e[L]),J=H!==t,te=H===null,oe=H===H,we=fr(H);if(m)var ae=u||oe;else j?ae=oe&&(u||J):w?ae=oe&&J&&(u||!te):P?ae=oe&&J&&!te&&(u||!we):te||we?ae=!1:ae=u?H<=i:H<i;ae?f=L+1:g=L}return Vt(g,Je)}function Su(e,i){for(var s=-1,u=e.length,f=0,g=[];++s<u;){var m=e[s],w=i?i(m):m;if(!s||!$r(w,P)){var P=w;g[f++]=m===0?0:m}}return g}function Pu(e){return typeof e=="number"?e:fr(e)?k:+e}function lr(e){if(typeof e=="string")return e;if(_e(e))return nt(e,lr)+"";if(fr(e))return nu?nu.call(e):"";var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function pi(e,i,s){var u=-1,f=vs,g=e.length,m=!0,w=[],P=w;if(s)m=!1,f=Bo;else if(g>=o){var j=i?null:Hd(e);if(j)return ms(j);m=!1,f=vn,P=new Ti}else P=i?[]:w;e:for(;++u<g;){var L=e[u],H=i?i(L):L;if(L=s||L!==0?L:0,m&&H===H){for(var J=P.length;J--;)if(P[J]===H)continue e;i&&P.push(H),w.push(L)}else f(P,H,s)||(P!==w&&P.push(H),w.push(L))}return w}function da(e,i){return i=di(i,e),e=eh(e,i),e==null||delete e[Br(Er(i))]}function Ou(e,i,s,u){return On(e,i,s($i(e,i)),u)}function qs(e,i,s,u){for(var f=e.length,g=u?f:-1;(u?g--:++g<f)&&i(e[g],g,e););return s?wr(e,u?0:g,u?g+1:f):wr(e,u?g+1:0,u?f:g)}function Au(e,i){var s=e;return s instanceof Oe&&(s=s.value()),Ho(i,function(u,f){return f.func.apply(f.thisArg,ui([u],f.args))},s)}function ga(e,i,s){var u=e.length;if(u<2)return u?pi(e[0]):[];for(var f=-1,g=T(u);++f<u;)for(var m=e[f],w=-1;++w<u;)w!=f&&(g[f]=In(g[f]||m,e[w],i,s));return pi(Ht(g,1),i,s)}function Cu(e,i,s){for(var u=-1,f=e.length,g=i.length,m={};++u<f;){var w=u<g?i[u]:t;s(m,e[u],w)}return m}function ya(e){return wt(e)?e:[]}function va(e){return typeof e=="function"?e:or}function di(e,i){return _e(e)?e:Pa(e,i)?[e]:nh(Le(e))}var Nd=Ie;function gi(e,i,s){var u=e.length;return s=s===t?u:s,!i&&s>=u?e:wr(e,i,s)}var Tu=bp||function(e){return Ae.clearTimeout(e)};function Ru(e,i){if(i)return e.slice();var s=e.length,u=Zc?Zc(s):new e.constructor(s);return e.copy(u),u}function _a(e){var i=new e.constructor(e.byteLength);return new Ss(i).set(new Ss(e)),i}function Dd(e,i){var s=i?_a(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Fd(e){var i=new e.constructor(e.source,gr.exec(e));return i.lastIndex=e.lastIndex,i}function jd(e){return En?We(En.call(e)):{}}function $u(e,i){var s=i?_a(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Nu(e,i){if(e!==i){var s=e!==t,u=e===null,f=e===e,g=fr(e),m=i!==t,w=i===null,P=i===i,j=fr(i);if(!w&&!j&&!g&&e>i||g&&m&&P&&!w&&!j||u&&m&&P||!s&&P||!f)return 1;if(!u&&!g&&!j&&e<i||j&&s&&f&&!u&&!g||w&&s&&f||!m&&f||!P)return-1}return 0}function Ld(e,i,s){for(var u=-1,f=e.criteria,g=i.criteria,m=f.length,w=s.length;++u<m;){var P=Nu(f[u],g[u]);if(P){if(u>=w)return P;var j=s[u];return P*(j=="desc"?-1:1)}}return e.index-i.index}function Du(e,i,s,u){for(var f=-1,g=e.length,m=s.length,w=-1,P=i.length,j=Lt(g-m,0),L=T(P+j),H=!u;++w<P;)L[w]=i[w];for(;++f<m;)(H||f<g)&&(L[s[f]]=e[f]);for(;j--;)L[w++]=e[f++];return L}function Fu(e,i,s,u){for(var f=-1,g=e.length,m=-1,w=s.length,P=-1,j=i.length,L=Lt(g-w,0),H=T(L+j),J=!u;++f<L;)H[f]=e[f];for(var te=f;++P<j;)H[te+P]=i[P];for(;++m<w;)(J||f<g)&&(H[te+s[m]]=e[f++]);return H}function ir(e,i){var s=-1,u=e.length;for(i||(i=T(u));++s<u;)i[s]=e[s];return i}function Ur(e,i,s,u){var f=!s;s||(s={});for(var g=-1,m=i.length;++g<m;){var w=i[g],P=u?u(s[w],e[w],w,s,e):t;P===t&&(P=e[w]),f?Yr(s,w,P):xn(s,w,P)}return s}function Md(e,i){return Ur(e,Sa(e),i)}function qd(e,i){return Ur(e,Wu(e),i)}function zs(e,i){return function(s,u){var f=_e(s)?kf:ad,g=i?i():{};return f(s,e,ne(u,2),g)}}function tn(e){return Ie(function(i,s){var u=-1,f=s.length,g=f>1?s[f-1]:t,m=f>2?s[2]:t;for(g=e.length>3&&typeof g=="function"?(f--,g):t,m&&Xt(s[0],s[1],m)&&(g=f<3?t:g,f=1),i=We(i);++u<f;){var w=s[u];w&&e(i,w,u,g)}return i})}function ju(e,i){return function(s,u){if(s==null)return s;if(!nr(s))return e(s,u);for(var f=s.length,g=i?f:-1,m=We(s);(i?g--:++g<f)&&u(m[g],g,m)!==!1;);return s}}function Lu(e){return function(i,s,u){for(var f=-1,g=We(i),m=u(i),w=m.length;w--;){var P=m[e?w:++f];if(s(g[P],P,g)===!1)break}return i}}function zd(e,i,s){var u=i&ie,f=An(e);function g(){var m=this&&this!==Ae&&this instanceof g?f:e;return m.apply(u?s:this,arguments)}return g}function Mu(e){return function(i){i=Le(i);var s=Wi(i)?Tr(i):t,u=s?s[0]:i.charAt(0),f=s?gi(s,1).join(""):i.slice(1);return u[e]()+f}}function rn(e){return function(i){return Ho(jh(Fh(i).replace(gn,"")),e,"")}}function An(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var s=en(e.prototype),u=e.apply(s,i);return ct(u)?u:s}}function Ud(e,i,s){var u=An(e);function f(){for(var g=arguments.length,m=T(g),w=g,P=nn(f);w--;)m[w]=arguments[w];var j=g<3&&m[0]!==P&&m[g-1]!==P?[]:hi(m,P);if(g-=j.length,g<s)return Hu(e,i,Us,f.placeholder,t,m,j,t,t,s-g);var L=this&&this!==Ae&&this instanceof f?u:e;return qt(L,this,m)}return f}function qu(e){return function(i,s,u){var f=We(i);if(!nr(i)){var g=ne(s,3);i=zt(i),s=function(w){return g(f[w],w,f)}}var m=e(i,s,u);return m>-1?f[g?i[m]:m]:t}}function zu(e){return Zr(function(i){var s=i.length,u=s,f=mr.prototype.thru;for(e&&i.reverse();u--;){var g=i[u];if(typeof g!="function")throw new _r(l);if(f&&!m&&Vs(g)=="wrapper")var m=new mr([],!0)}for(u=m?u:s;++u<s;){g=i[u];var w=Vs(g),P=w=="wrapper"?xa(g):t;P&&Oa(P[0])&&P[1]==(U|pe|le|W)&&!P[4].length&&P[9]==1?m=m[Vs(P[0])].apply(m,P[3]):m=g.length==1&&Oa(g)?m[w]():m.thru(g)}return function(){var j=arguments,L=j[0];if(m&&j.length==1&&_e(L))return m.plant(L).value();for(var H=0,J=s?i[H].apply(this,j):L;++H<s;)J=i[H].call(this,J);return J}})}function Us(e,i,s,u,f,g,m,w,P,j){var L=i&U,H=i&ie,J=i&Ee,te=i&(pe|he),oe=i&ye,we=J?t:An(e);function ae(){for(var Se=arguments.length,Ce=T(Se),pr=Se;pr--;)Ce[pr]=arguments[pr];if(te)var Zt=nn(ae),dr=Qf(Ce,Zt);if(u&&(Ce=Du(Ce,u,f,te)),g&&(Ce=Fu(Ce,g,m,te)),Se-=dr,te&&Se<j){var Et=hi(Ce,Zt);return Hu(e,i,Us,ae.placeholder,s,Ce,Et,w,P,j-Se)}var Nr=H?s:this,ri=J?Nr[e]:e;return Se=Ce.length,w?Ce=ag(Ce,w):oe&&Se>1&&Ce.reverse(),L&&P<Se&&(Ce.length=P),this&&this!==Ae&&this instanceof ae&&(ri=we||An(ri)),ri.apply(Nr,Ce)}return ae}function Uu(e,i){return function(s,u){return gd(s,e,i(u),{})}}function Bs(e,i){return function(s,u){var f;if(s===t&&u===t)return i;if(s!==t&&(f=s),u!==t){if(f===t)return u;typeof s=="string"||typeof u=="string"?(s=lr(s),u=lr(u)):(s=Pu(s),u=Pu(u)),f=e(s,u)}return f}}function ma(e){return Zr(function(i){return i=nt(i,hr(ne())),Ie(function(s){var u=this;return e(i,function(f){return qt(f,u,s)})})})}function Hs(e,i){i=i===t?" ":lr(i);var s=i.length;if(s<2)return s?fa(i,e):i;var u=fa(i,Cs(e/Ji(i)));return Wi(i)?gi(Tr(u),0,e).join(""):u.slice(0,e)}function Bd(e,i,s,u){var f=i&ie,g=An(e);function m(){for(var w=-1,P=arguments.length,j=-1,L=u.length,H=T(L+P),J=this&&this!==Ae&&this instanceof m?g:e;++j<L;)H[j]=u[j];for(;P--;)H[j++]=arguments[++w];return qt(J,f?s:this,H)}return m}function Bu(e){return function(i,s,u){return u&&typeof u!="number"&&Xt(i,s,u)&&(s=u=t),i=ti(i),s===t?(s=i,i=0):s=ti(s),u=u===t?i<s?1:-1:ti(u),Od(i,s,u,e)}}function ks(e){return function(i,s){return typeof i=="string"&&typeof s=="string"||(i=xr(i),s=xr(s)),e(i,s)}}function Hu(e,i,s,u,f,g,m,w,P,j){var L=i&pe,H=L?m:t,J=L?t:m,te=L?g:t,oe=L?t:g;i|=L?le:N,i&=~(L?N:le),i&ge||(i&=~(ie|Ee));var we=[e,i,f,te,H,oe,J,w,P,j],ae=s.apply(t,we);return Oa(e)&&th(ae,we),ae.placeholder=u,rh(ae,e,i)}function ba(e){var i=jt[e];return function(s,u){if(s=xr(s),u=u==null?0:Vt(me(u),292),u&&ru(s)){var f=(Le(s)+"e").split("e"),g=i(f[0]+"e"+(+f[1]+u));return f=(Le(g)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return i(s)}}var Hd=Zi&&1/ms(new Zi([,-0]))[1]==ce?function(e){return new Zi(e)}:Ba;function ku(e){return function(i){var s=Kt(i);return s==be?Yo(i):s==je?op(i):Zf(i,e(i))}}function Xr(e,i,s,u,f,g,m,w){var P=i&Ee;if(!P&&typeof e!="function")throw new _r(l);var j=u?u.length:0;if(j||(i&=~(le|N),u=f=t),m=m===t?m:Lt(me(m),0),w=w===t?w:me(w),j-=f?f.length:0,i&N){var L=u,H=f;u=f=t}var J=P?t:xa(e),te=[e,i,s,u,f,L,H,g,m,w];if(J&&ng(te,J),e=te[0],i=te[1],s=te[2],u=te[3],f=te[4],w=te[9]=te[9]===t?P?0:e.length:Lt(te[9]-j,0),!w&&i&(pe|he)&&(i&=~(pe|he)),!i||i==ie)var oe=zd(e,i,s);else i==pe||i==he?oe=Ud(e,i,w):(i==le||i==(ie|le))&&!f.length?oe=Bd(e,i,s,u):oe=Us.apply(t,te);var we=J?Iu:th;return rh(we(oe,te),e,i)}function Vu(e,i,s,u){return e===t||$r(e,Xi[s])&&!qe.call(u,s)?i:e}function Ku(e,i,s,u,f,g){return ct(e)&&ct(i)&&(g.set(i,e),Ls(e,i,t,Ku,g),g.delete(i)),e}function kd(e){return Rn(e)?t:e}function Gu(e,i,s,u,f,g){var m=s&F,w=e.length,P=i.length;if(w!=P&&!(m&&P>w))return!1;var j=g.get(e),L=g.get(i);if(j&&L)return j==i&&L==e;var H=-1,J=!0,te=s&K?new Ti:t;for(g.set(e,i),g.set(i,e);++H<w;){var oe=e[H],we=i[H];if(u)var ae=m?u(we,oe,H,i,e,g):u(oe,we,H,e,i,g);if(ae!==t){if(ae)continue;J=!1;break}if(te){if(!ko(i,function(Se,Ce){if(!vn(te,Ce)&&(oe===Se||f(oe,Se,s,u,g)))return te.push(Ce)})){J=!1;break}}else if(!(oe===we||f(oe,we,s,u,g))){J=!1;break}}return g.delete(e),g.delete(i),J}function Vd(e,i,s,u,f,g,m){switch(s){case ke:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ne:return!(e.byteLength!=i.byteLength||!g(new Ss(e),new Ss(i)));case R:case A:case $e:return $r(+e,+i);case E:return e.name==i.name&&e.message==i.message;case st:case Xe:return e==i+"";case be:var w=Yo;case je:var P=u&F;if(w||(w=ms),e.size!=i.size&&!P)return!1;var j=m.get(e);if(j)return j==i;u|=K,m.set(e,i);var L=Gu(w(e),w(i),u,f,g,m);return m.delete(e),L;case Ze:if(En)return En.call(e)==En.call(i)}return!1}function Kd(e,i,s,u,f,g){var m=s&F,w=wa(e),P=w.length,j=wa(i),L=j.length;if(P!=L&&!m)return!1;for(var H=P;H--;){var J=w[H];if(!(m?J in i:qe.call(i,J)))return!1}var te=g.get(e),oe=g.get(i);if(te&&oe)return te==i&&oe==e;var we=!0;g.set(e,i),g.set(i,e);for(var ae=m;++H<P;){J=w[H];var Se=e[J],Ce=i[J];if(u)var pr=m?u(Ce,Se,J,i,e,g):u(Se,Ce,J,e,i,g);if(!(pr===t?Se===Ce||f(Se,Ce,s,u,g):pr)){we=!1;break}ae||(ae=J=="constructor")}if(we&&!ae){var Zt=e.constructor,dr=i.constructor;Zt!=dr&&"constructor"in e&&"constructor"in i&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof dr=="function"&&dr instanceof dr)&&(we=!1)}return g.delete(e),g.delete(i),we}function Zr(e){return Ca(Qu(e,t,ch),e+"")}function wa(e){return pu(e,zt,Sa)}function Ea(e){return pu(e,sr,Wu)}var xa=Rs?function(e){return Rs.get(e)}:Ba;function Vs(e){for(var i=e.name+"",s=Qi[i],u=qe.call(Qi,i)?s.length:0;u--;){var f=s[u],g=f.func;if(g==null||g==e)return f.name}return i}function nn(e){var i=qe.call(d,"placeholder")?d:e;return i.placeholder}function ne(){var e=d.iteratee||za;return e=e===za?yu:e,arguments.length?e(arguments[0],arguments[1]):e}function Ks(e,i){var s=e.__data__;return eg(i)?s[typeof i=="string"?"string":"hash"]:s.map}function Ia(e){for(var i=zt(e),s=i.length;s--;){var u=i[s],f=e[u];i[s]=[u,f,Xu(f)]}return i}function Ni(e,i){var s=ip(e,i);return gu(s)?s:t}function Gd(e){var i=qe.call(e,Ai),s=e[Ai];try{e[Ai]=t;var u=!0}catch{}var f=xs.call(e);return u&&(i?e[Ai]=s:delete e[Ai]),f}var Sa=Zo?function(e){return e==null?[]:(e=We(e),ci(Zo(e),function(i){return eu.call(e,i)}))}:Ha,Wu=Zo?function(e){for(var i=[];e;)ui(i,Sa(e)),e=Ps(e);return i}:Ha,Kt=Yt;(Qo&&Kt(new Qo(new ArrayBuffer(1)))!=ke||mn&&Kt(new mn)!=be||ea&&Kt(ea.resolve())!=St||Zi&&Kt(new Zi)!=je||bn&&Kt(new bn)!=Ue)&&(Kt=function(e){var i=Yt(e),s=i==Pe?e.constructor:t,u=s?Di(s):"";if(u)switch(u){case Cp:return ke;case Tp:return be;case Rp:return St;case $p:return je;case Np:return Ue}return i});function Wd(e,i,s){for(var u=-1,f=s.length;++u<f;){var g=s[u],m=g.size;switch(g.type){case"drop":e+=m;break;case"dropRight":i-=m;break;case"take":i=Vt(i,e+m);break;case"takeRight":e=Lt(e,i-m);break}}return{start:e,end:i}}function Jd(e){var i=e.match(Ye);return i?i[1].split(Tt):[]}function Ju(e,i,s){i=di(i,e);for(var u=-1,f=i.length,g=!1;++u<f;){var m=Br(i[u]);if(!(g=e!=null&&s(e,m)))break;e=e[m]}return g||++u!=f?g:(f=e==null?0:e.length,!!f&&Qs(f)&&Qr(m,f)&&(_e(e)||Fi(e)))}function Yd(e){var i=e.length,s=new e.constructor(i);return i&&typeof e[0]=="string"&&qe.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Yu(e){return typeof e.constructor=="function"&&!Cn(e)?en(Ps(e)):{}}function Xd(e,i,s){var u=e.constructor;switch(i){case Ne:return _a(e);case R:case A:return new u(+e);case ke:return Dd(e,s);case ut:case Me:case Pt:case Ft:case Ut:case Bt:case Mt:case Gt:case tr:return $u(e,s);case be:return new u;case $e:case Xe:return new u(e);case st:return Fd(e);case je:return new u;case Ze:return jd(e)}}function Zd(e,i){var s=i.length;if(!s)return e;var u=s-1;return i[u]=(s>1?"& ":"")+i[u],i=i.join(s>2?", ":" "),e.replace(gt,`{
/* [wrapped with `+i+`] */
`)}function Qd(e){return _e(e)||Fi(e)||!!(tu&&e&&e[tu])}function Qr(e,i){var s=typeof e;return i=i??V,!!i&&(s=="number"||s!="symbol"&&Ao.test(e))&&e>-1&&e%1==0&&e<i}function Xt(e,i,s){if(!ct(s))return!1;var u=typeof i;return(u=="number"?nr(s)&&Qr(i,s.length):u=="string"&&i in s)?$r(s[i],e):!1}function Pa(e,i){if(_e(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||fr(e)?!0:Ot.test(e)||!it.test(e)||i!=null&&e in We(i)}function eg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Oa(e){var i=Vs(e),s=d[i];if(typeof s!="function"||!(i in Oe.prototype))return!1;if(e===s)return!0;var u=xa(s);return!!u&&e===u[0]}function tg(e){return!!Xc&&Xc in e}var rg=ws?ei:ka;function Cn(e){var i=e&&e.constructor,s=typeof i=="function"&&i.prototype||Xi;return e===s}function Xu(e){return e===e&&!ct(e)}function Zu(e,i){return function(s){return s==null?!1:s[e]===i&&(i!==t||e in We(s))}}function ig(e){var i=Xs(e,function(u){return s.size===y&&s.clear(),u}),s=i.cache;return i}function ng(e,i){var s=e[1],u=i[1],f=s|u,g=f<(ie|Ee|U),m=u==U&&s==pe||u==U&&s==W&&e[7].length<=i[8]||u==(U|W)&&i[7].length<=i[8]&&s==pe;if(!(g||m))return e;u&ie&&(e[2]=i[2],f|=s&ie?0:ge);var w=i[3];if(w){var P=e[3];e[3]=P?Du(P,w,i[4]):w,e[4]=P?hi(e[3],O):i[4]}return w=i[5],w&&(P=e[5],e[5]=P?Fu(P,w,i[6]):w,e[6]=P?hi(e[5],O):i[6]),w=i[7],w&&(e[7]=w),u&U&&(e[8]=e[8]==null?i[8]:Vt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function sg(e){var i=[];if(e!=null)for(var s in We(e))i.push(s);return i}function og(e){return xs.call(e)}function Qu(e,i,s){return i=Lt(i===t?e.length-1:i,0),function(){for(var u=arguments,f=-1,g=Lt(u.length-i,0),m=T(g);++f<g;)m[f]=u[i+f];f=-1;for(var w=T(i+1);++f<i;)w[f]=u[f];return w[i]=s(m),qt(e,this,w)}}function eh(e,i){return i.length<2?e:$i(e,wr(i,0,-1))}function ag(e,i){for(var s=e.length,u=Vt(i.length,s),f=ir(e);u--;){var g=i[u];e[u]=Qr(g,s)?f[g]:t}return e}function Aa(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var th=ih(Iu),Tn=Ep||function(e,i){return Ae.setTimeout(e,i)},Ca=ih(Td);function rh(e,i,s){var u=i+"";return Ca(e,Zd(u,cg(Jd(u),s)))}function ih(e){var i=0,s=0;return function(){var u=Pp(),f=ze-(u-s);if(s=u,f>0){if(++i>=Re)return arguments[0]}else i=0;return e.apply(t,arguments)}}function Gs(e,i){var s=-1,u=e.length,f=u-1;for(i=i===t?u:i;++s<i;){var g=la(s,f),m=e[g];e[g]=e[s],e[s]=m}return e.length=i,e}var nh=ig(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(At,function(s,u,f,g){i.push(f?g.replace(Eo,"$1"):u||s)}),i});function Br(e){if(typeof e=="string"||fr(e))return e;var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function Di(e){if(e!=null){try{return Es.call(e)}catch{}try{return e+""}catch{}}return""}function cg(e,i){return vr(jr,function(s){var u="_."+s[0];i&s[1]&&!vs(e,u)&&e.push(u)}),e.sort()}function sh(e){if(e instanceof Oe)return e.clone();var i=new mr(e.__wrapped__,e.__chain__);return i.__actions__=ir(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function ug(e,i,s){(s?Xt(e,i,s):i===t)?i=1:i=Lt(me(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var f=0,g=0,m=T(Cs(u/i));f<u;)m[g++]=wr(e,f,f+=i);return m}function hg(e){for(var i=-1,s=e==null?0:e.length,u=0,f=[];++i<s;){var g=e[i];g&&(f[u++]=g)}return f}function lg(){var e=arguments.length;if(!e)return[];for(var i=T(e-1),s=arguments[0],u=e;u--;)i[u-1]=arguments[u];return ui(_e(s)?ir(s):[s],Ht(i,1))}var fg=Ie(function(e,i){return wt(e)?In(e,Ht(i,1,wt,!0)):[]}),pg=Ie(function(e,i){var s=Er(i);return wt(s)&&(s=t),wt(e)?In(e,Ht(i,1,wt,!0),ne(s,2)):[]}),dg=Ie(function(e,i){var s=Er(i);return wt(s)&&(s=t),wt(e)?In(e,Ht(i,1,wt,!0),t,s):[]});function gg(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===t?1:me(i),wr(e,i<0?0:i,u)):[]}function yg(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===t?1:me(i),i=u-i,wr(e,0,i<0?0:i)):[]}function vg(e,i){return e&&e.length?qs(e,ne(i,3),!0,!0):[]}function _g(e,i){return e&&e.length?qs(e,ne(i,3),!0):[]}function mg(e,i,s,u){var f=e==null?0:e.length;return f?(s&&typeof s!="number"&&Xt(e,i,s)&&(s=0,u=f),ld(e,i,s,u)):[]}function oh(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var f=s==null?0:me(s);return f<0&&(f=Lt(u+f,0)),_s(e,ne(i,3),f)}function ah(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return s!==t&&(f=me(s),f=s<0?Lt(u+f,0):Vt(f,u-1)),_s(e,ne(i,3),f,!0)}function ch(e){var i=e==null?0:e.length;return i?Ht(e,1):[]}function bg(e){var i=e==null?0:e.length;return i?Ht(e,ce):[]}function wg(e,i){var s=e==null?0:e.length;return s?(i=i===t?1:me(i),Ht(e,i)):[]}function Eg(e){for(var i=-1,s=e==null?0:e.length,u={};++i<s;){var f=e[i];u[f[0]]=f[1]}return u}function uh(e){return e&&e.length?e[0]:t}function xg(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var f=s==null?0:me(s);return f<0&&(f=Lt(u+f,0)),Gi(e,i,f)}function Ig(e){var i=e==null?0:e.length;return i?wr(e,0,-1):[]}var Sg=Ie(function(e){var i=nt(e,ya);return i.length&&i[0]===e[0]?oa(i):[]}),Pg=Ie(function(e){var i=Er(e),s=nt(e,ya);return i===Er(s)?i=t:s.pop(),s.length&&s[0]===e[0]?oa(s,ne(i,2)):[]}),Og=Ie(function(e){var i=Er(e),s=nt(e,ya);return i=typeof i=="function"?i:t,i&&s.pop(),s.length&&s[0]===e[0]?oa(s,t,i):[]});function Ag(e,i){return e==null?"":Ip.call(e,i)}function Er(e){var i=e==null?0:e.length;return i?e[i-1]:t}function Cg(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var f=u;return s!==t&&(f=me(s),f=f<0?Lt(u+f,0):Vt(f,u-1)),i===i?cp(e,i,f):_s(e,Hc,f,!0)}function Tg(e,i){return e&&e.length?bu(e,me(i)):t}var Rg=Ie(hh);function hh(e,i){return e&&e.length&&i&&i.length?ha(e,i):e}function $g(e,i,s){return e&&e.length&&i&&i.length?ha(e,i,ne(s,2)):e}function Ng(e,i,s){return e&&e.length&&i&&i.length?ha(e,i,t,s):e}var Dg=Zr(function(e,i){var s=e==null?0:e.length,u=ra(e,i);return xu(e,nt(i,function(f){return Qr(f,s)?+f:f}).sort(Nu)),u});function Fg(e,i){var s=[];if(!(e&&e.length))return s;var u=-1,f=[],g=e.length;for(i=ne(i,3);++u<g;){var m=e[u];i(m,u,e)&&(s.push(m),f.push(u))}return xu(e,f),s}function Ta(e){return e==null?e:Ap.call(e)}function jg(e,i,s){var u=e==null?0:e.length;return u?(s&&typeof s!="number"&&Xt(e,i,s)?(i=0,s=u):(i=i==null?0:me(i),s=s===t?u:me(s)),wr(e,i,s)):[]}function Lg(e,i){return Ms(e,i)}function Mg(e,i,s){return pa(e,i,ne(s,2))}function qg(e,i){var s=e==null?0:e.length;if(s){var u=Ms(e,i);if(u<s&&$r(e[u],i))return u}return-1}function zg(e,i){return Ms(e,i,!0)}function Ug(e,i,s){return pa(e,i,ne(s,2),!0)}function Bg(e,i){var s=e==null?0:e.length;if(s){var u=Ms(e,i,!0)-1;if($r(e[u],i))return u}return-1}function Hg(e){return e&&e.length?Su(e):[]}function kg(e,i){return e&&e.length?Su(e,ne(i,2)):[]}function Vg(e){var i=e==null?0:e.length;return i?wr(e,1,i):[]}function Kg(e,i,s){return e&&e.length?(i=s||i===t?1:me(i),wr(e,0,i<0?0:i)):[]}function Gg(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===t?1:me(i),i=u-i,wr(e,i<0?0:i,u)):[]}function Wg(e,i){return e&&e.length?qs(e,ne(i,3),!1,!0):[]}function Jg(e,i){return e&&e.length?qs(e,ne(i,3)):[]}var Yg=Ie(function(e){return pi(Ht(e,1,wt,!0))}),Xg=Ie(function(e){var i=Er(e);return wt(i)&&(i=t),pi(Ht(e,1,wt,!0),ne(i,2))}),Zg=Ie(function(e){var i=Er(e);return i=typeof i=="function"?i:t,pi(Ht(e,1,wt,!0),t,i)});function Qg(e){return e&&e.length?pi(e):[]}function ey(e,i){return e&&e.length?pi(e,ne(i,2)):[]}function ty(e,i){return i=typeof i=="function"?i:t,e&&e.length?pi(e,t,i):[]}function Ra(e){if(!(e&&e.length))return[];var i=0;return e=ci(e,function(s){if(wt(s))return i=Lt(s.length,i),!0}),Wo(i,function(s){return nt(e,Vo(s))})}function lh(e,i){if(!(e&&e.length))return[];var s=Ra(e);return i==null?s:nt(s,function(u){return qt(i,t,u)})}var ry=Ie(function(e,i){return wt(e)?In(e,i):[]}),iy=Ie(function(e){return ga(ci(e,wt))}),ny=Ie(function(e){var i=Er(e);return wt(i)&&(i=t),ga(ci(e,wt),ne(i,2))}),sy=Ie(function(e){var i=Er(e);return i=typeof i=="function"?i:t,ga(ci(e,wt),t,i)}),oy=Ie(Ra);function ay(e,i){return Cu(e||[],i||[],xn)}function cy(e,i){return Cu(e||[],i||[],On)}var uy=Ie(function(e){var i=e.length,s=i>1?e[i-1]:t;return s=typeof s=="function"?(e.pop(),s):t,lh(e,s)});function fh(e){var i=d(e);return i.__chain__=!0,i}function hy(e,i){return i(e),e}function Ws(e,i){return i(e)}var ly=Zr(function(e){var i=e.length,s=i?e[0]:0,u=this.__wrapped__,f=function(g){return ra(g,e)};return i>1||this.__actions__.length||!(u instanceof Oe)||!Qr(s)?this.thru(f):(u=u.slice(s,+s+(i?1:0)),u.__actions__.push({func:Ws,args:[f],thisArg:t}),new mr(u,this.__chain__).thru(function(g){return i&&!g.length&&g.push(t),g}))});function fy(){return fh(this)}function py(){return new mr(this.value(),this.__chain__)}function dy(){this.__values__===t&&(this.__values__=Ph(this.value()));var e=this.__index__>=this.__values__.length,i=e?t:this.__values__[this.__index__++];return{done:e,value:i}}function gy(){return this}function yy(e){for(var i,s=this;s instanceof Ns;){var u=sh(s);u.__index__=0,u.__values__=t,i?f.__wrapped__=u:i=u;var f=u;s=s.__wrapped__}return f.__wrapped__=e,i}function vy(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:Ws,args:[Ta],thisArg:t}),new mr(i,this.__chain__)}return this.thru(Ta)}function _y(){return Au(this.__wrapped__,this.__actions__)}var my=zs(function(e,i,s){qe.call(e,s)?++e[s]:Yr(e,s,1)});function by(e,i,s){var u=_e(e)?Uc:hd;return s&&Xt(e,i,s)&&(i=t),u(e,ne(i,3))}function wy(e,i){var s=_e(e)?ci:lu;return s(e,ne(i,3))}var Ey=qu(oh),xy=qu(ah);function Iy(e,i){return Ht(Js(e,i),1)}function Sy(e,i){return Ht(Js(e,i),ce)}function Py(e,i,s){return s=s===t?1:me(s),Ht(Js(e,i),s)}function ph(e,i){var s=_e(e)?vr:fi;return s(e,ne(i,3))}function dh(e,i){var s=_e(e)?Vf:hu;return s(e,ne(i,3))}var Oy=zs(function(e,i,s){qe.call(e,s)?e[s].push(i):Yr(e,s,[i])});function Ay(e,i,s,u){e=nr(e)?e:on(e),s=s&&!u?me(s):0;var f=e.length;return s<0&&(s=Lt(f+s,0)),eo(e)?s<=f&&e.indexOf(i,s)>-1:!!f&&Gi(e,i,s)>-1}var Cy=Ie(function(e,i,s){var u=-1,f=typeof i=="function",g=nr(e)?T(e.length):[];return fi(e,function(m){g[++u]=f?qt(i,m,s):Sn(m,i,s)}),g}),Ty=zs(function(e,i,s){Yr(e,s,i)});function Js(e,i){var s=_e(e)?nt:vu;return s(e,ne(i,3))}function Ry(e,i,s,u){return e==null?[]:(_e(i)||(i=i==null?[]:[i]),s=u?t:s,_e(s)||(s=s==null?[]:[s]),wu(e,i,s))}var $y=zs(function(e,i,s){e[s?0:1].push(i)},function(){return[[],[]]});function Ny(e,i,s){var u=_e(e)?Ho:Vc,f=arguments.length<3;return u(e,ne(i,4),s,f,fi)}function Dy(e,i,s){var u=_e(e)?Kf:Vc,f=arguments.length<3;return u(e,ne(i,4),s,f,hu)}function Fy(e,i){var s=_e(e)?ci:lu;return s(e,Zs(ne(i,3)))}function jy(e){var i=_e(e)?ou:Ad;return i(e)}function Ly(e,i,s){(s?Xt(e,i,s):i===t)?i=1:i=me(i);var u=_e(e)?sd:Cd;return u(e,i)}function My(e){var i=_e(e)?od:Rd;return i(e)}function qy(e){if(e==null)return 0;if(nr(e))return eo(e)?Ji(e):e.length;var i=Kt(e);return i==be||i==je?e.size:ca(e).length}function zy(e,i,s){var u=_e(e)?ko:$d;return s&&Xt(e,i,s)&&(i=t),u(e,ne(i,3))}var Uy=Ie(function(e,i){if(e==null)return[];var s=i.length;return s>1&&Xt(e,i[0],i[1])?i=[]:s>2&&Xt(i[0],i[1],i[2])&&(i=[i[0]]),wu(e,Ht(i,1),[])}),Ys=wp||function(){return Ae.Date.now()};function By(e,i){if(typeof i!="function")throw new _r(l);return e=me(e),function(){if(--e<1)return i.apply(this,arguments)}}function gh(e,i,s){return i=s?t:i,i=e&&i==null?e.length:i,Xr(e,U,t,t,t,t,i)}function yh(e,i){var s;if(typeof i!="function")throw new _r(l);return e=me(e),function(){return--e>0&&(s=i.apply(this,arguments)),e<=1&&(i=t),s}}var $a=Ie(function(e,i,s){var u=ie;if(s.length){var f=hi(s,nn($a));u|=le}return Xr(e,u,i,s,f)}),vh=Ie(function(e,i,s){var u=ie|Ee;if(s.length){var f=hi(s,nn(vh));u|=le}return Xr(i,u,e,s,f)});function _h(e,i,s){i=s?t:i;var u=Xr(e,pe,t,t,t,t,t,i);return u.placeholder=_h.placeholder,u}function mh(e,i,s){i=s?t:i;var u=Xr(e,he,t,t,t,t,t,i);return u.placeholder=mh.placeholder,u}function bh(e,i,s){var u,f,g,m,w,P,j=0,L=!1,H=!1,J=!0;if(typeof e!="function")throw new _r(l);i=xr(i)||0,ct(s)&&(L=!!s.leading,H="maxWait"in s,g=H?Lt(xr(s.maxWait)||0,i):g,J="trailing"in s?!!s.trailing:J);function te(Et){var Nr=u,ri=f;return u=f=t,j=Et,m=e.apply(ri,Nr),m}function oe(Et){return j=Et,w=Tn(Se,i),L?te(Et):m}function we(Et){var Nr=Et-P,ri=Et-j,qh=i-Nr;return H?Vt(qh,g-ri):qh}function ae(Et){var Nr=Et-P,ri=Et-j;return P===t||Nr>=i||Nr<0||H&&ri>=g}function Se(){var Et=Ys();if(ae(Et))return Ce(Et);w=Tn(Se,we(Et))}function Ce(Et){return w=t,J&&u?te(Et):(u=f=t,m)}function pr(){w!==t&&Tu(w),j=0,u=P=f=w=t}function Zt(){return w===t?m:Ce(Ys())}function dr(){var Et=Ys(),Nr=ae(Et);if(u=arguments,f=this,P=Et,Nr){if(w===t)return oe(P);if(H)return Tu(w),w=Tn(Se,i),te(P)}return w===t&&(w=Tn(Se,i)),m}return dr.cancel=pr,dr.flush=Zt,dr}var Hy=Ie(function(e,i){return uu(e,1,i)}),ky=Ie(function(e,i,s){return uu(e,xr(i)||0,s)});function Vy(e){return Xr(e,ye)}function Xs(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new _r(l);var s=function(){var u=arguments,f=i?i.apply(this,u):u[0],g=s.cache;if(g.has(f))return g.get(f);var m=e.apply(this,u);return s.cache=g.set(f,m)||g,m};return s.cache=new(Xs.Cache||Jr),s}Xs.Cache=Jr;function Zs(e){if(typeof e!="function")throw new _r(l);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Ky(e){return yh(2,e)}var Gy=Nd(function(e,i){i=i.length==1&&_e(i[0])?nt(i[0],hr(ne())):nt(Ht(i,1),hr(ne()));var s=i.length;return Ie(function(u){for(var f=-1,g=Vt(u.length,s);++f<g;)u[f]=i[f].call(this,u[f]);return qt(e,this,u)})}),Na=Ie(function(e,i){var s=hi(i,nn(Na));return Xr(e,le,t,i,s)}),wh=Ie(function(e,i){var s=hi(i,nn(wh));return Xr(e,N,t,i,s)}),Wy=Zr(function(e,i){return Xr(e,W,t,t,t,i)});function Jy(e,i){if(typeof e!="function")throw new _r(l);return i=i===t?i:me(i),Ie(e,i)}function Yy(e,i){if(typeof e!="function")throw new _r(l);return i=i==null?0:Lt(me(i),0),Ie(function(s){var u=s[i],f=gi(s,0,i);return u&&ui(f,u),qt(e,this,f)})}function Xy(e,i,s){var u=!0,f=!0;if(typeof e!="function")throw new _r(l);return ct(s)&&(u="leading"in s?!!s.leading:u,f="trailing"in s?!!s.trailing:f),bh(e,i,{leading:u,maxWait:i,trailing:f})}function Zy(e){return gh(e,1)}function Qy(e,i){return Na(va(i),e)}function e0(){if(!arguments.length)return[];var e=arguments[0];return _e(e)?e:[e]}function t0(e){return br(e,z)}function r0(e,i){return i=typeof i=="function"?i:t,br(e,z,i)}function i0(e){return br(e,q|z)}function n0(e,i){return i=typeof i=="function"?i:t,br(e,q|z,i)}function s0(e,i){return i==null||cu(e,i,zt(i))}function $r(e,i){return e===i||e!==e&&i!==i}var o0=ks(sa),a0=ks(function(e,i){return e>=i}),Fi=du(function(){return arguments}())?du:function(e){return yt(e)&&qe.call(e,"callee")&&!eu.call(e,"callee")},_e=T.isArray,c0=Jt?hr(Jt):yd;function nr(e){return e!=null&&Qs(e.length)&&!ei(e)}function wt(e){return yt(e)&&nr(e)}function u0(e){return e===!0||e===!1||yt(e)&&Yt(e)==R}var yi=xp||ka,h0=Cr?hr(Cr):vd;function l0(e){return yt(e)&&e.nodeType===1&&!Rn(e)}function f0(e){if(e==null)return!0;if(nr(e)&&(_e(e)||typeof e=="string"||typeof e.splice=="function"||yi(e)||sn(e)||Fi(e)))return!e.length;var i=Kt(e);if(i==be||i==je)return!e.size;if(Cn(e))return!ca(e).length;for(var s in e)if(qe.call(e,s))return!1;return!0}function p0(e,i){return Pn(e,i)}function d0(e,i,s){s=typeof s=="function"?s:t;var u=s?s(e,i):t;return u===t?Pn(e,i,t,s):!!u}function Da(e){if(!yt(e))return!1;var i=Yt(e);return i==E||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Rn(e)}function g0(e){return typeof e=="number"&&ru(e)}function ei(e){if(!ct(e))return!1;var i=Yt(e);return i==ee||i==fe||i==$||i==_t}function Eh(e){return typeof e=="number"&&e==me(e)}function Qs(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=V}function ct(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function yt(e){return e!=null&&typeof e=="object"}var xh=yr?hr(yr):md;function y0(e,i){return e===i||aa(e,i,Ia(i))}function v0(e,i,s){return s=typeof s=="function"?s:t,aa(e,i,Ia(i),s)}function _0(e){return Ih(e)&&e!=+e}function m0(e){if(rg(e))throw new de(c);return gu(e)}function b0(e){return e===null}function w0(e){return e==null}function Ih(e){return typeof e=="number"||yt(e)&&Yt(e)==$e}function Rn(e){if(!yt(e)||Yt(e)!=Pe)return!1;var i=Ps(e);if(i===null)return!0;var s=qe.call(i,"constructor")&&i.constructor;return typeof s=="function"&&s instanceof s&&Es.call(s)==vp}var Fa=qr?hr(qr):bd;function E0(e){return Eh(e)&&e>=-V&&e<=V}var Sh=yn?hr(yn):wd;function eo(e){return typeof e=="string"||!_e(e)&&yt(e)&&Yt(e)==Xe}function fr(e){return typeof e=="symbol"||yt(e)&&Yt(e)==Ze}var sn=Oi?hr(Oi):Ed;function x0(e){return e===t}function I0(e){return yt(e)&&Kt(e)==Ue}function S0(e){return yt(e)&&Yt(e)==Qe}var P0=ks(ua),O0=ks(function(e,i){return e<=i});function Ph(e){if(!e)return[];if(nr(e))return eo(e)?Tr(e):ir(e);if(_n&&e[_n])return sp(e[_n]());var i=Kt(e),s=i==be?Yo:i==je?ms:on;return s(e)}function ti(e){if(!e)return e===0?e:0;if(e=xr(e),e===ce||e===-ce){var i=e<0?-1:1;return i*B}return e===e?e:0}function me(e){var i=ti(e),s=i%1;return i===i?s?i-s:i:0}function Oh(e){return e?Ri(me(e),0,G):0}function xr(e){if(typeof e=="number")return e;if(fr(e))return k;if(ct(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ct(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Kc(e);var s=So.test(e);return s||Oo.test(e)?ve(e.slice(2),s?2:8):Io.test(e)?k:+e}function Ah(e){return Ur(e,sr(e))}function A0(e){return e?Ri(me(e),-V,V):e===0?e:0}function Le(e){return e==null?"":lr(e)}var C0=tn(function(e,i){if(Cn(i)||nr(i)){Ur(i,zt(i),e);return}for(var s in i)qe.call(i,s)&&xn(e,s,i[s])}),Ch=tn(function(e,i){Ur(i,sr(i),e)}),to=tn(function(e,i,s,u){Ur(i,sr(i),e,u)}),T0=tn(function(e,i,s,u){Ur(i,zt(i),e,u)}),R0=Zr(ra);function $0(e,i){var s=en(e);return i==null?s:au(s,i)}var N0=Ie(function(e,i){e=We(e);var s=-1,u=i.length,f=u>2?i[2]:t;for(f&&Xt(i[0],i[1],f)&&(u=1);++s<u;)for(var g=i[s],m=sr(g),w=-1,P=m.length;++w<P;){var j=m[w],L=e[j];(L===t||$r(L,Xi[j])&&!qe.call(e,j))&&(e[j]=g[j])}return e}),D0=Ie(function(e){return e.push(t,Ku),qt(Th,t,e)});function F0(e,i){return Bc(e,ne(i,3),zr)}function j0(e,i){return Bc(e,ne(i,3),na)}function L0(e,i){return e==null?e:ia(e,ne(i,3),sr)}function M0(e,i){return e==null?e:fu(e,ne(i,3),sr)}function q0(e,i){return e&&zr(e,ne(i,3))}function z0(e,i){return e&&na(e,ne(i,3))}function U0(e){return e==null?[]:js(e,zt(e))}function B0(e){return e==null?[]:js(e,sr(e))}function ja(e,i,s){var u=e==null?t:$i(e,i);return u===t?s:u}function H0(e,i){return e!=null&&Ju(e,i,fd)}function La(e,i){return e!=null&&Ju(e,i,pd)}var k0=Uu(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=xs.call(i)),e[i]=s},qa(or)),V0=Uu(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=xs.call(i)),qe.call(e,i)?e[i].push(s):e[i]=[s]},ne),K0=Ie(Sn);function zt(e){return nr(e)?su(e):ca(e)}function sr(e){return nr(e)?su(e,!0):xd(e)}function G0(e,i){var s={};return i=ne(i,3),zr(e,function(u,f,g){Yr(s,i(u,f,g),u)}),s}function W0(e,i){var s={};return i=ne(i,3),zr(e,function(u,f,g){Yr(s,f,i(u,f,g))}),s}var J0=tn(function(e,i,s){Ls(e,i,s)}),Th=tn(function(e,i,s,u){Ls(e,i,s,u)}),Y0=Zr(function(e,i){var s={};if(e==null)return s;var u=!1;i=nt(i,function(g){return g=di(g,e),u||(u=g.length>1),g}),Ur(e,Ea(e),s),u&&(s=br(s,q|C|z,kd));for(var f=i.length;f--;)da(s,i[f]);return s});function X0(e,i){return Rh(e,Zs(ne(i)))}var Z0=Zr(function(e,i){return e==null?{}:Sd(e,i)});function Rh(e,i){if(e==null)return{};var s=nt(Ea(e),function(u){return[u]});return i=ne(i),Eu(e,s,function(u,f){return i(u,f[0])})}function Q0(e,i,s){i=di(i,e);var u=-1,f=i.length;for(f||(f=1,e=t);++u<f;){var g=e==null?t:e[Br(i[u])];g===t&&(u=f,g=s),e=ei(g)?g.call(e):g}return e}function ev(e,i,s){return e==null?e:On(e,i,s)}function tv(e,i,s,u){return u=typeof u=="function"?u:t,e==null?e:On(e,i,s,u)}var $h=ku(zt),Nh=ku(sr);function rv(e,i,s){var u=_e(e),f=u||yi(e)||sn(e);if(i=ne(i,4),s==null){var g=e&&e.constructor;f?s=u?new g:[]:ct(e)?s=ei(g)?en(Ps(e)):{}:s={}}return(f?vr:zr)(e,function(m,w,P){return i(s,m,w,P)}),s}function iv(e,i){return e==null?!0:da(e,i)}function nv(e,i,s){return e==null?e:Ou(e,i,va(s))}function sv(e,i,s,u){return u=typeof u=="function"?u:t,e==null?e:Ou(e,i,va(s),u)}function on(e){return e==null?[]:Jo(e,zt(e))}function ov(e){return e==null?[]:Jo(e,sr(e))}function av(e,i,s){return s===t&&(s=i,i=t),s!==t&&(s=xr(s),s=s===s?s:0),i!==t&&(i=xr(i),i=i===i?i:0),Ri(xr(e),i,s)}function cv(e,i,s){return i=ti(i),s===t?(s=i,i=0):s=ti(s),e=xr(e),dd(e,i,s)}function uv(e,i,s){if(s&&typeof s!="boolean"&&Xt(e,i,s)&&(i=s=t),s===t&&(typeof i=="boolean"?(s=i,i=t):typeof e=="boolean"&&(s=e,e=t)),e===t&&i===t?(e=0,i=1):(e=ti(e),i===t?(i=e,e=0):i=ti(i)),e>i){var u=e;e=i,i=u}if(s||e%1||i%1){var f=iu();return Vt(e+f*(i-e+Ke("1e-"+((f+"").length-1))),i)}return la(e,i)}var hv=rn(function(e,i,s){return i=i.toLowerCase(),e+(s?Dh(i):i)});function Dh(e){return Ma(Le(e).toLowerCase())}function Fh(e){return e=Le(e),e&&e.replace(Kr,ep).replace(zo,"")}function lv(e,i,s){e=Le(e),i=lr(i);var u=e.length;s=s===t?u:Ri(me(s),0,u);var f=s;return s-=i.length,s>=0&&e.slice(s,f)==i}function fv(e){return e=Le(e),e&&rt.test(e)?e.replace(Ei,tp):e}function pv(e){return e=Le(e),e&&Ct.test(e)?e.replace(pt,"\\$&"):e}var dv=rn(function(e,i,s){return e+(s?"-":"")+i.toLowerCase()}),gv=rn(function(e,i,s){return e+(s?" ":"")+i.toLowerCase()}),yv=Mu("toLowerCase");function vv(e,i,s){e=Le(e),i=me(i);var u=i?Ji(e):0;if(!i||u>=i)return e;var f=(i-u)/2;return Hs(Ts(f),s)+e+Hs(Cs(f),s)}function _v(e,i,s){e=Le(e),i=me(i);var u=i?Ji(e):0;return i&&u<i?e+Hs(i-u,s):e}function mv(e,i,s){e=Le(e),i=me(i);var u=i?Ji(e):0;return i&&u<i?Hs(i-u,s)+e:e}function bv(e,i,s){return s||i==null?i=0:i&&(i=+i),Op(Le(e).replace(dt,""),i||0)}function wv(e,i,s){return(s?Xt(e,i,s):i===t)?i=1:i=me(i),fa(Le(e),i)}function Ev(){var e=arguments,i=Le(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var xv=rn(function(e,i,s){return e+(s?"_":"")+i.toLowerCase()});function Iv(e,i,s){return s&&typeof s!="number"&&Xt(e,i,s)&&(i=s=t),s=s===t?G:s>>>0,s?(e=Le(e),e&&(typeof i=="string"||i!=null&&!Fa(i))&&(i=lr(i),!i&&Wi(e))?gi(Tr(e),0,s):e.split(i,s)):[]}var Sv=rn(function(e,i,s){return e+(s?" ":"")+Ma(i)});function Pv(e,i,s){return e=Le(e),s=s==null?0:Ri(me(s),0,e.length),i=lr(i),e.slice(s,s+i.length)==i}function Ov(e,i,s){var u=d.templateSettings;s&&Xt(e,i,s)&&(i=t),e=Le(e),i=to({},i,u,Vu);var f=to({},i.imports,u.imports,Vu),g=zt(f),m=Jo(f,g),w,P,j=0,L=i.interpolate||zi,H="__p += '",J=Xo((i.escape||zi).source+"|"+L.source+"|"+(L===at?xo:zi).source+"|"+(i.evaluate||zi).source+"|$","g"),te="//# sourceURL="+(qe.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Uo+"]")+`
`;e.replace(J,function(ae,Se,Ce,pr,Zt,dr){return Ce||(Ce=pr),H+=e.slice(j,dr).replace(Co,rp),Se&&(w=!0,H+=`' +
__e(`+Se+`) +
'`),Zt&&(P=!0,H+=`';
`+Zt+`;
__p += '`),Ce&&(H+=`' +
((__t = (`+Ce+`)) == null ? '' : __t) +
'`),j=dr+ae.length,ae}),H+=`';
`;var oe=qe.call(i,"variable")&&i.variable;if(!oe)H=`with (obj) {
`+H+`
}
`;else if(wo.test(oe))throw new de(p);H=(P?H.replace(Lr,""):H).replace(Wt,"$1").replace(Vr,"$1;"),H="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+H+`return __p
}`;var we=Lh(function(){return Fe(g,te+"return "+H).apply(t,m)});if(we.source=H,Da(we))throw we;return we}function Av(e){return Le(e).toLowerCase()}function Cv(e){return Le(e).toUpperCase()}function Tv(e,i,s){if(e=Le(e),e&&(s||i===t))return Kc(e);if(!e||!(i=lr(i)))return e;var u=Tr(e),f=Tr(i),g=Gc(u,f),m=Wc(u,f)+1;return gi(u,g,m).join("")}function Rv(e,i,s){if(e=Le(e),e&&(s||i===t))return e.slice(0,Yc(e)+1);if(!e||!(i=lr(i)))return e;var u=Tr(e),f=Wc(u,Tr(i))+1;return gi(u,0,f).join("")}function $v(e,i,s){if(e=Le(e),e&&(s||i===t))return e.replace(dt,"");if(!e||!(i=lr(i)))return e;var u=Tr(e),f=Gc(u,Tr(i));return gi(u,f).join("")}function Nv(e,i){var s=re,u=ue;if(ct(i)){var f="separator"in i?i.separator:f;s="length"in i?me(i.length):s,u="omission"in i?lr(i.omission):u}e=Le(e);var g=e.length;if(Wi(e)){var m=Tr(e);g=m.length}if(s>=g)return e;var w=s-Ji(u);if(w<1)return u;var P=m?gi(m,0,w).join(""):e.slice(0,w);if(f===t)return P+u;if(m&&(w+=P.length-w),Fa(f)){if(e.slice(w).search(f)){var j,L=P;for(f.global||(f=Xo(f.source,Le(gr.exec(f))+"g")),f.lastIndex=0;j=f.exec(L);)var H=j.index;P=P.slice(0,H===t?w:H)}}else if(e.indexOf(lr(f),w)!=w){var J=P.lastIndexOf(f);J>-1&&(P=P.slice(0,J))}return P+u}function Dv(e){return e=Le(e),e&&ht.test(e)?e.replace(oi,up):e}var Fv=rn(function(e,i,s){return e+(s?" ":"")+i.toUpperCase()}),Ma=Mu("toUpperCase");function jh(e,i,s){return e=Le(e),i=s?t:i,i===t?np(e)?fp(e):Jf(e):e.match(i)||[]}var Lh=Ie(function(e,i){try{return qt(e,t,i)}catch(s){return Da(s)?s:new de(s)}}),jv=Zr(function(e,i){return vr(i,function(s){s=Br(s),Yr(e,s,$a(e[s],e))}),e});function Lv(e){var i=e==null?0:e.length,s=ne();return e=i?nt(e,function(u){if(typeof u[1]!="function")throw new _r(l);return[s(u[0]),u[1]]}):[],Ie(function(u){for(var f=-1;++f<i;){var g=e[f];if(qt(g[0],this,u))return qt(g[1],this,u)}})}function Mv(e){return ud(br(e,q))}function qa(e){return function(){return e}}function qv(e,i){return e==null||e!==e?i:e}var zv=zu(),Uv=zu(!0);function or(e){return e}function za(e){return yu(typeof e=="function"?e:br(e,q))}function Bv(e){return _u(br(e,q))}function Hv(e,i){return mu(e,br(i,q))}var kv=Ie(function(e,i){return function(s){return Sn(s,e,i)}}),Vv=Ie(function(e,i){return function(s){return Sn(e,s,i)}});function Ua(e,i,s){var u=zt(i),f=js(i,u);s==null&&!(ct(i)&&(f.length||!u.length))&&(s=i,i=e,e=this,f=js(i,zt(i)));var g=!(ct(s)&&"chain"in s)||!!s.chain,m=ei(e);return vr(f,function(w){var P=i[w];e[w]=P,m&&(e.prototype[w]=function(){var j=this.__chain__;if(g||j){var L=e(this.__wrapped__),H=L.__actions__=ir(this.__actions__);return H.push({func:P,args:arguments,thisArg:e}),L.__chain__=j,L}return P.apply(e,ui([this.value()],arguments))})}),e}function Kv(){return Ae._===this&&(Ae._=_p),this}function Ba(){}function Gv(e){return e=me(e),Ie(function(i){return bu(i,e)})}var Wv=ma(nt),Jv=ma(Uc),Yv=ma(ko);function Mh(e){return Pa(e)?Vo(Br(e)):Pd(e)}function Xv(e){return function(i){return e==null?t:$i(e,i)}}var Zv=Bu(),Qv=Bu(!0);function Ha(){return[]}function ka(){return!1}function e_(){return{}}function t_(){return""}function r_(){return!0}function i_(e,i){if(e=me(e),e<1||e>V)return[];var s=G,u=Vt(e,G);i=ne(i),e-=G;for(var f=Wo(u,i);++s<e;)i(s);return f}function n_(e){return _e(e)?nt(e,Br):fr(e)?[e]:ir(nh(Le(e)))}function s_(e){var i=++yp;return Le(e)+i}var o_=Bs(function(e,i){return e+i},0),a_=ba("ceil"),c_=Bs(function(e,i){return e/i},1),u_=ba("floor");function h_(e){return e&&e.length?Fs(e,or,sa):t}function l_(e,i){return e&&e.length?Fs(e,ne(i,2),sa):t}function f_(e){return kc(e,or)}function p_(e,i){return kc(e,ne(i,2))}function d_(e){return e&&e.length?Fs(e,or,ua):t}function g_(e,i){return e&&e.length?Fs(e,ne(i,2),ua):t}var y_=Bs(function(e,i){return e*i},1),v_=ba("round"),__=Bs(function(e,i){return e-i},0);function m_(e){return e&&e.length?Go(e,or):0}function b_(e,i){return e&&e.length?Go(e,ne(i,2)):0}return d.after=By,d.ary=gh,d.assign=C0,d.assignIn=Ch,d.assignInWith=to,d.assignWith=T0,d.at=R0,d.before=yh,d.bind=$a,d.bindAll=jv,d.bindKey=vh,d.castArray=e0,d.chain=fh,d.chunk=ug,d.compact=hg,d.concat=lg,d.cond=Lv,d.conforms=Mv,d.constant=qa,d.countBy=my,d.create=$0,d.curry=_h,d.curryRight=mh,d.debounce=bh,d.defaults=N0,d.defaultsDeep=D0,d.defer=Hy,d.delay=ky,d.difference=fg,d.differenceBy=pg,d.differenceWith=dg,d.drop=gg,d.dropRight=yg,d.dropRightWhile=vg,d.dropWhile=_g,d.fill=mg,d.filter=wy,d.flatMap=Iy,d.flatMapDeep=Sy,d.flatMapDepth=Py,d.flatten=ch,d.flattenDeep=bg,d.flattenDepth=wg,d.flip=Vy,d.flow=zv,d.flowRight=Uv,d.fromPairs=Eg,d.functions=U0,d.functionsIn=B0,d.groupBy=Oy,d.initial=Ig,d.intersection=Sg,d.intersectionBy=Pg,d.intersectionWith=Og,d.invert=k0,d.invertBy=V0,d.invokeMap=Cy,d.iteratee=za,d.keyBy=Ty,d.keys=zt,d.keysIn=sr,d.map=Js,d.mapKeys=G0,d.mapValues=W0,d.matches=Bv,d.matchesProperty=Hv,d.memoize=Xs,d.merge=J0,d.mergeWith=Th,d.method=kv,d.methodOf=Vv,d.mixin=Ua,d.negate=Zs,d.nthArg=Gv,d.omit=Y0,d.omitBy=X0,d.once=Ky,d.orderBy=Ry,d.over=Wv,d.overArgs=Gy,d.overEvery=Jv,d.overSome=Yv,d.partial=Na,d.partialRight=wh,d.partition=$y,d.pick=Z0,d.pickBy=Rh,d.property=Mh,d.propertyOf=Xv,d.pull=Rg,d.pullAll=hh,d.pullAllBy=$g,d.pullAllWith=Ng,d.pullAt=Dg,d.range=Zv,d.rangeRight=Qv,d.rearg=Wy,d.reject=Fy,d.remove=Fg,d.rest=Jy,d.reverse=Ta,d.sampleSize=Ly,d.set=ev,d.setWith=tv,d.shuffle=My,d.slice=jg,d.sortBy=Uy,d.sortedUniq=Hg,d.sortedUniqBy=kg,d.split=Iv,d.spread=Yy,d.tail=Vg,d.take=Kg,d.takeRight=Gg,d.takeRightWhile=Wg,d.takeWhile=Jg,d.tap=hy,d.throttle=Xy,d.thru=Ws,d.toArray=Ph,d.toPairs=$h,d.toPairsIn=Nh,d.toPath=n_,d.toPlainObject=Ah,d.transform=rv,d.unary=Zy,d.union=Yg,d.unionBy=Xg,d.unionWith=Zg,d.uniq=Qg,d.uniqBy=ey,d.uniqWith=ty,d.unset=iv,d.unzip=Ra,d.unzipWith=lh,d.update=nv,d.updateWith=sv,d.values=on,d.valuesIn=ov,d.without=ry,d.words=jh,d.wrap=Qy,d.xor=iy,d.xorBy=ny,d.xorWith=sy,d.zip=oy,d.zipObject=ay,d.zipObjectDeep=cy,d.zipWith=uy,d.entries=$h,d.entriesIn=Nh,d.extend=Ch,d.extendWith=to,Ua(d,d),d.add=o_,d.attempt=Lh,d.camelCase=hv,d.capitalize=Dh,d.ceil=a_,d.clamp=av,d.clone=t0,d.cloneDeep=i0,d.cloneDeepWith=n0,d.cloneWith=r0,d.conformsTo=s0,d.deburr=Fh,d.defaultTo=qv,d.divide=c_,d.endsWith=lv,d.eq=$r,d.escape=fv,d.escapeRegExp=pv,d.every=by,d.find=Ey,d.findIndex=oh,d.findKey=F0,d.findLast=xy,d.findLastIndex=ah,d.findLastKey=j0,d.floor=u_,d.forEach=ph,d.forEachRight=dh,d.forIn=L0,d.forInRight=M0,d.forOwn=q0,d.forOwnRight=z0,d.get=ja,d.gt=o0,d.gte=a0,d.has=H0,d.hasIn=La,d.head=uh,d.identity=or,d.includes=Ay,d.indexOf=xg,d.inRange=cv,d.invoke=K0,d.isArguments=Fi,d.isArray=_e,d.isArrayBuffer=c0,d.isArrayLike=nr,d.isArrayLikeObject=wt,d.isBoolean=u0,d.isBuffer=yi,d.isDate=h0,d.isElement=l0,d.isEmpty=f0,d.isEqual=p0,d.isEqualWith=d0,d.isError=Da,d.isFinite=g0,d.isFunction=ei,d.isInteger=Eh,d.isLength=Qs,d.isMap=xh,d.isMatch=y0,d.isMatchWith=v0,d.isNaN=_0,d.isNative=m0,d.isNil=w0,d.isNull=b0,d.isNumber=Ih,d.isObject=ct,d.isObjectLike=yt,d.isPlainObject=Rn,d.isRegExp=Fa,d.isSafeInteger=E0,d.isSet=Sh,d.isString=eo,d.isSymbol=fr,d.isTypedArray=sn,d.isUndefined=x0,d.isWeakMap=I0,d.isWeakSet=S0,d.join=Ag,d.kebabCase=dv,d.last=Er,d.lastIndexOf=Cg,d.lowerCase=gv,d.lowerFirst=yv,d.lt=P0,d.lte=O0,d.max=h_,d.maxBy=l_,d.mean=f_,d.meanBy=p_,d.min=d_,d.minBy=g_,d.stubArray=Ha,d.stubFalse=ka,d.stubObject=e_,d.stubString=t_,d.stubTrue=r_,d.multiply=y_,d.nth=Tg,d.noConflict=Kv,d.noop=Ba,d.now=Ys,d.pad=vv,d.padEnd=_v,d.padStart=mv,d.parseInt=bv,d.random=uv,d.reduce=Ny,d.reduceRight=Dy,d.repeat=wv,d.replace=Ev,d.result=Q0,d.round=v_,d.runInContext=S,d.sample=jy,d.size=qy,d.snakeCase=xv,d.some=zy,d.sortedIndex=Lg,d.sortedIndexBy=Mg,d.sortedIndexOf=qg,d.sortedLastIndex=zg,d.sortedLastIndexBy=Ug,d.sortedLastIndexOf=Bg,d.startCase=Sv,d.startsWith=Pv,d.subtract=__,d.sum=m_,d.sumBy=b_,d.template=Ov,d.times=i_,d.toFinite=ti,d.toInteger=me,d.toLength=Oh,d.toLower=Av,d.toNumber=xr,d.toSafeInteger=A0,d.toString=Le,d.toUpper=Cv,d.trim=Tv,d.trimEnd=Rv,d.trimStart=$v,d.truncate=Nv,d.unescape=Dv,d.uniqueId=s_,d.upperCase=Fv,d.upperFirst=Ma,d.each=ph,d.eachRight=dh,d.first=uh,Ua(d,function(){var e={};return zr(d,function(i,s){qe.call(d.prototype,s)||(e[s]=i)}),e}(),{chain:!1}),d.VERSION=n,vr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),vr(["drop","take"],function(e,i){Oe.prototype[e]=function(s){s=s===t?1:Lt(me(s),0);var u=this.__filtered__&&!i?new Oe(this):this.clone();return u.__filtered__?u.__takeCount__=Vt(s,u.__takeCount__):u.__views__.push({size:Vt(s,G),type:e+(u.__dir__<0?"Right":"")}),u},Oe.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),vr(["filter","map","takeWhile"],function(e,i){var s=i+1,u=s==_||s==X;Oe.prototype[e]=function(f){var g=this.clone();return g.__iteratees__.push({iteratee:ne(f,3),type:s}),g.__filtered__=g.__filtered__||u,g}}),vr(["head","last"],function(e,i){var s="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[s](1).value()[0]}}),vr(["initial","tail"],function(e,i){var s="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[s](1)}}),Oe.prototype.compact=function(){return this.filter(or)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=Ie(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(s){return Sn(s,e,i)})}),Oe.prototype.reject=function(e){return this.filter(Zs(ne(e)))},Oe.prototype.slice=function(e,i){e=me(e);var s=this;return s.__filtered__&&(e>0||i<0)?new Oe(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),i!==t&&(i=me(i),s=i<0?s.dropRight(-i):s.take(i-e)),s)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(G)},zr(Oe.prototype,function(e,i){var s=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),f=d[u?"take"+(i=="last"?"Right":""):i],g=u||/^find/.test(i);f&&(d.prototype[i]=function(){var m=this.__wrapped__,w=u?[1]:arguments,P=m instanceof Oe,j=w[0],L=P||_e(m),H=function(Se){var Ce=f.apply(d,ui([Se],w));return u&&J?Ce[0]:Ce};L&&s&&typeof j=="function"&&j.length!=1&&(P=L=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=g&&!J,we=P&&!te;if(!g&&L){m=we?m:new Oe(this);var ae=e.apply(m,w);return ae.__actions__.push({func:Ws,args:[H],thisArg:t}),new mr(ae,J)}return oe&&we?e.apply(this,w):(ae=this.thru(H),oe?u?ae.value()[0]:ae.value():ae)})}),vr(["pop","push","shift","sort","splice","unshift"],function(e){var i=bs[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var g=this.value();return i.apply(_e(g)?g:[],f)}return this[s](function(m){return i.apply(_e(m)?m:[],f)})}}),zr(Oe.prototype,function(e,i){var s=d[i];if(s){var u=s.name+"";qe.call(Qi,u)||(Qi[u]=[]),Qi[u].push({name:i,func:s})}}),Qi[Us(t,Ee).name]=[{name:"wrapper",func:t}],Oe.prototype.clone=Dp,Oe.prototype.reverse=Fp,Oe.prototype.value=jp,d.prototype.at=ly,d.prototype.chain=fy,d.prototype.commit=py,d.prototype.next=dy,d.prototype.plant=yy,d.prototype.reverse=vy,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=_y,d.prototype.first=d.prototype.head,_n&&(d.prototype[_n]=gy),d},Yi=pp();bt?((bt.exports=Yi)._=Yi,Ge._=Yi):Ae._=Yi}).call(Un)})(Ic,Ic.exports);var Ux=Object.defineProperty,Bx=Object.defineProperties,Hx=Object.getOwnPropertyDescriptors,ql=Object.getOwnPropertySymbols,kx=Object.prototype.hasOwnProperty,Vx=Object.prototype.propertyIsEnumerable,zl=(a,r,t)=>r in a?Ux(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,io=(a,r)=>{for(var t in r||(r={}))kx.call(r,t)&&zl(a,t,r[t]);if(ql)for(var t of ql(r))Vx.call(r,t)&&zl(a,t,r[t]);return a},Kx=(a,r)=>Bx(a,Hx(r));function Pr(a,r,t){let n;const o=Sc(a);return r.rpcMap&&(n=r.rpcMap[o]),n||(n=`${zx}?chainId=eip155:${o}&projectId=${t}`),n}function Sc(a){return a.includes("eip155")?Number(a.split(":")[1]):Number(a)}function Bf(a){return a.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function Gx(a,r){const t=Object.keys(r.namespaces).filter(o=>o.includes(a));if(!t.length)return[];const n=[];return t.forEach(o=>{const c=r.namespaces[o].accounts;n.push(...c)}),n}function Wx(a={},r={}){const t=Ul(a),n=Ul(r);return Ic.exports.merge(t,n)}function Ul(a){var r,t,n,o;const c={};if(!oo(a))return c;for(const[l,p]of Object.entries(a)){const b=tf(l)?[l]:p.chains,y=p.methods||[],O=p.events||[],q=p.rpcMap||{},C=ao(l);c[C]=Kx(io(io({},c[C]),p),{chains:Ka(b,(r=c[C])==null?void 0:r.chains),methods:Ka(y,(t=c[C])==null?void 0:t.methods),events:Ka(O,(n=c[C])==null?void 0:n.events),rpcMap:io(io({},q),(o=c[C])==null?void 0:o.rpcMap)})}return c}function Jx(a){return a.includes(":")?a.split(":")[2]:a}function Yx(a){const r={};for(const[t,n]of Object.entries(a)){const o=n.methods||[],c=n.events||[],l=n.accounts||[],p=tf(t)?[t]:n.chains?n.chains:Bf(n.accounts);r[t]={chains:p,methods:o,events:c,accounts:l}}return r}const Hf={},xt=a=>Hf[a],nc=(a,r)=>{Hf[a]=r};class Xx{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||Pr(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(wi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Pr(r,this.namespace);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class Zx{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=xt("events"),this.client=xt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,t){const n=Sc(r);if(!this.httpProviders[n]){const o=t||Pr(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,o)}this.chainId=n,this.events.emit(wi.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,t){const n=t||Pr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const o=Sc(t);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}async handleSwitchChain(r){var t,n;let o=r.request.params?(t=r.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class Qx{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(!this.httpProviders[r]){const n=t||Pr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(wi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Pr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class eI{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||Pr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(wi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Pr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class tI{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(wi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t);r[t]=this.createHttpProvider(t,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}getCardanoRPCUrl(r){const t=this.namespace.rpcMap;if(t)return t[r]}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||this.getCardanoRPCUrl(r);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class rI{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(!this.httpProviders[r]){const n=t||Pr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(wi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Pr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class iI{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(!this.httpProviders[r]){const n=t||Pr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(wi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Pr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}var nI=Object.defineProperty,sI=Object.defineProperties,oI=Object.getOwnPropertyDescriptors,Bl=Object.getOwnPropertySymbols,aI=Object.prototype.hasOwnProperty,cI=Object.prototype.propertyIsEnumerable,Hl=(a,r,t)=>r in a?nI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,no=(a,r)=>{for(var t in r||(r={}))aI.call(r,t)&&Hl(a,t,r[t]);if(Bl)for(var t of Bl(r))cI.call(r,t)&&Hl(a,t,r[t]);return a},sc=(a,r)=>sI(a,oI(r));class qc{constructor(r){this.events=new Cc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Te.pino(Te.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Ll})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const t=new qc(r);return await t.initialize(),t}async request(r,t){const[n,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:no({},r),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(r,t,n){this.request(r,n).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:er("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}removeListener(r,t){this.events.removeListener(r,t)}off(r,t){this.events.off(r,t)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=Yx(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==zf)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,t){try{if(!this.session)return;const[n,o]=this.validateChain(r);this.getProvider(n).setDefaultChain(o,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(ln(t)){for(const n of t)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Nx.init({logger:this.providerOpts.logger||Ll,relayUrl:this.providerOpts.relayUrl||Lx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(t=>ao(t)))];nc("client",this.client),nc("events",this.events),nc("disableProviderPing",this.disableProviderPing),r.forEach(t=>{if(!this.session)return;const n=Gx(t,this.session),o=Bf(n),c=Wx(this.namespaces,this.optionalNamespaces),l=sc(no({},c[t]),{accounts:n,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new Zx({namespace:l});break;case"solana":this.rpcProviders[t]=new Qx({namespace:l});break;case"cosmos":this.rpcProviders[t]=new eI({namespace:l});break;case"polkadot":this.rpcProviders[t]=new Xx({namespace:l});break;case"cip34":this.rpcProviders[t]=new tI({namespace:l});break;case"elrond":this.rpcProviders[t]=new rI({namespace:l});break;case"multiversx":this.rpcProviders[t]=new iI({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:t}=r,{event:n}=t;if(n.name==="accountsChanged"){const o=n.data;o&&ln(o)&&this.events.emit("accountsChanged",o.map(Jx))}else n.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:t})=>{var n;const{namespaces:o}=t,c=(n=this.client)==null?void 0:n.session.get(r);this.session=sc(no({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:t})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",sc(no({},er("USER_DISCONNECTED")),{data:r.topic}))}),this.on(wi.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var t;this.getProvider(r).updateNamespace((t=this.session)==null?void 0:t.namespaces[r])})}setNamespaces(r){const{namespaces:t,optionalNamespaces:n,sessionProperties:o}=r;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",n)}validateChain(r){const[t,n]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(l=>ao(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const o=ao(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,t=!1){var n;if(!this.namespaces)return;const[o,c]=this.validateChain(r);t||this.getProvider(o).setDefaultChain(c),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,t){this.client.core.storage.setItem(`${Ml}/${r}`,t)}async getFromStore(r){return await this.client.core.storage.getItem(`${Ml}/${r}`)}}const uI=qc,hI="wc",lI="ethereum_provider",fI=`${hI}@2:${lI}:`,pI="https://rpc.walletconnect.com/v1/",Pc=["eth_sendTransaction","personal_sign"],dI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Oc=["chainChanged","accountsChanged"],gI=["message","disconnect","connect"];var yI=Object.defineProperty,vI=Object.defineProperties,_I=Object.getOwnPropertyDescriptors,kl=Object.getOwnPropertySymbols,mI=Object.prototype.hasOwnProperty,bI=Object.prototype.propertyIsEnumerable,Vl=(a,r,t)=>r in a?yI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Bn=(a,r)=>{for(var t in r||(r={}))mI.call(r,t)&&Vl(a,t,r[t]);if(kl)for(var t of kl(r))bI.call(r,t)&&Vl(a,t,r[t]);return a},Kl=(a,r)=>vI(a,_I(r));function lo(a){return Number(a[0].split(":")[1])}function oc(a){return`0x${a.toString(16)}`}function wI(a){const{chains:r,optionalChains:t,methods:n,optionalMethods:o,events:c,optionalEvents:l,rpcMap:p}=a;if(!ln(r))throw new Error("Invalid chains");const b={chains:r,methods:n||Pc,events:c||Oc,rpcMap:Bn({},r.length?{[lo(r)]:p[lo(r)]}:{})},y=c==null?void 0:c.filter(z=>!Oc.includes(z)),O=n==null?void 0:n.filter(z=>!Pc.includes(z));if(!t&&!l&&!o&&!(y!=null&&y.length)&&!(O!=null&&O.length))return{required:r.length?b:void 0};const q=(y==null?void 0:y.length)&&(O==null?void 0:O.length)||!t,C={chains:[...new Set(q?b.chains.concat(t||[]):t)],methods:[...new Set(b.methods.concat(o!=null&&o.length?o:dI))],events:[...new Set(b.events.concat(l||gI))],rpcMap:p};return{required:r.length?b:void 0,optional:t.length?C:void 0}}class zc{constructor(){this.events=new Or.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=fI,this.on=(r,t)=>(this.events.on(r,t),this),this.once=(r,t)=>(this.events.once(r,t),this),this.removeListener=(r,t)=>(this.events.removeListener(r,t),this),this.off=(r,t)=>(this.events.off(r,t),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const t=new zc;return await t.initialize(r),t}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,t){this.signer.sendAsync(r,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:t,optional:n}=wI(this.rpc);try{const o=await new Promise(async(l,p)=>{var b;this.rpc.showQrModal&&((b=this.modal)==null||b.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),p(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Kl(Bn({namespaces:Bn({},t&&{[this.namespace]:t})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(y=>{l(y)}).catch(y=>{p(new Error(y.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const c=n1(o.namespaces,[this.namespace]);this.setAccounts(c),this.events.emit("connect",{chainId:oc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:t}=r,{event:n}=t;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const t=parseInt(r);this.chainId=t,this.events.emit("chainChanged",oc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",Kl(Bn({},er("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var t,n;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const t=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",oc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const t=this.parseChainId(r);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(r){const[t,n,o]=r.split(":");return{chainId:`${t}:${n}`,address:o}}setAccounts(r){this.accounts=r.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var t,n;const o=(t=r==null?void 0:r.chains)!=null?t:[],c=(n=r==null?void 0:r.optionalChains)!=null?n:[],l=o.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const p=o.length?(r==null?void 0:r.methods)||Pc:[],b=o.length?(r==null?void 0:r.events)||Oc:[],y=(r==null?void 0:r.optionalMethods)||[],O=(r==null?void 0:r.optionalEvents)||[],q=(r==null?void 0:r.rpcMap)||this.buildRpcMap(l,r.projectId),C=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(z=>this.formatChainId(z)),optionalChains:c.map(z=>this.formatChainId(z)),methods:p,events:b,optionalMethods:y,optionalEvents:O,rpcMap:q,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:C,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,t){const n={};return r.forEach(o=>{n[o]=this.getRpcUrl(o,t)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?lo(this.rpc.chains):lo(this.rpc.optionalChains),this.signer=await uI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:n}=await s1(()=>import("./index-4358ca33.js").then(o=>o.a),["assets/index-4358ca33.js","assets/index-038e7f6c.js","assets/index-ee6c4f8f.css","assets/index-cc134824.js"]);t=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Bn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:t,optionalChains:n,rpcMap:o}=r;t&&ln(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),n&&ln(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(r,t){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${pI}?chainId=eip155:${r}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(t=>this.parseAccount(t))}}const $I=zc;export{$I as EthereumProvider,gI as OPTIONAL_EVENTS,dI as OPTIONAL_METHODS,Oc as REQUIRED_EVENTS,Pc as REQUIRED_METHODS,zc as default};
